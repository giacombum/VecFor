<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
	 
	 <meta name="description" content="Vector algebra class for Fortran poor people">
    
    <meta name="author" content="Chris MacMackin" >
    <link rel="icon" href="../favicon.png">

    <title>vecfor.F90 &ndash; VecFor</title>

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">
    

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    
    <script src="../js/jquery-2.1.3.min.js"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>

    
    <script src="../tipuesearch/tipuesearch_content.js"></script>
    <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">
    <script src="../tipuesearch/tipuesearch_set.js"></script>
    <script src="../tipuesearch/tipuesearch.js"></script>
    

  </head>

  <body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">VecFor </a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
				
                
            <li><a href="../lists/files.html">Source Files</a></li>
				
				
            <li><a href="../lists/modules.html">Modules</a></li>
				
				
            <li><a href="../lists/procedures.html">Procedures</a></li>
				
								
            <li><a href="../lists/types.html">Derived Types</a></li>
				
				
            <li><a href="../lists/programs.html">Programs</a></li>
				
          </ul>
        
        <form action="../search.html" class="navbar-form navbar-right" role="search">
        <div class="form-group">
          <input type="text" class="form-control" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
        </div>
<!--
        <button type="submit" class="btn btn-default">Submit</button>
-->
        </form>
        
        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">
    
  
  <div class="row">
    <h1>vecfor.F90
    <small>Source File</small>
    
    </h1>
	 
<div class="row">
<div class="col-lg-12">
<div class="well well-sm">
  <ul class="list-inline" style="margin-bottom:0px;display:inline">
     
     
     
     
    
    
    <li><i class="fa fa-code"></i><a href="../src/vecfor.F90"> Source File</a></li>
     
  </ul>
  <ol class="breadcrumb in-well text-right">
  
     <li class="active">vecfor.F90</li>
  </ol>
</div>
</div>
</div>
    
  </div>
  <div class="row">
    <div class="col-lg-3">
    
  
  
  
  
  
  
  
  <div class="panel panel-primary">
    <div class="panel-heading text-left"><h3 class="panel-title">Modules</h3></div>
    <div class="list-group">
      
      <a class="list-group-item" href="../module/vecfor.html">VecFor</a>
      
    </div>
  </div>
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  <div class="panel panel-primary">
    <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
    <div class="list-group">
      <a class="list-group-item" href="../sourcefile/vecfor.f90.html#src">vecfor.F90</a>
    </div>
  </div>
  
  <hr>
  
  <div class="panel panel-default">
    <div class="panel-heading text-left"><h3 class="panel-title">All Source Files</h3></div>
    <div class="list-group">
      
      <a class="list-group-item" href="../sourcefile/kinds.f90.html">kinds.f90</a>
      
      <a class="list-group-item" href="../sourcefile/simple.f90.html">simple.f90</a>
      
      <a class="list-group-item" href="../sourcefile/vecfor.f90.html">vecfor.F90</a>
      
    </div>
  </div>
  
  
    </div>
    <div class="col-lg-9" id='text'>
    <p>Module definition of class Vector.</p>
    <br>
    <section>
    <h2><span class="anchor" id="src"></span>Source Code</h2>
    <div class="highlight"><pre><span class="c">!&lt; Module definition of class Vector.</span>
<span class="k">module </span><span class="n">VecFor</span>
<span class="c">!&lt; Module definition of class Vector.</span>
<span class="c">!&lt;</span>
<span class="c">!&lt; This derived type is useful for manipulating vectors in 3D space. The components of the vectors are reals with</span>
<span class="c">!&lt; parametrized kind as defined by the library module. The components are defined in a three-dimensional cartesian frame of</span>
<span class="c">!&lt; reference.</span>
<span class="c">!&lt; All the vectorial math procedures (cross, dot products, parallel...) assume a three-dimensional cartesian frame of reference.</span>
<span class="c">!&lt; The operators of assignment (`=`), multiplication (`*`), division (`/`), sum (`+`) and subtraction (`-`) have been overloaded.</span>
<span class="c">!&lt; Furthermore the *dot* and *cross* products have been defined.</span>
<span class="c">!&lt; Therefore this module provides a far-complete algebra based on Vector derived type.</span>
<span class="c">!-----------------------------------------------------------------------------------------------------------------------------------</span>
<span class="k">use</span><span class="p">,</span> <span class="k">intrinsic</span><span class="kd">::</span> <span class="n">ISO_FORTRAN_ENV</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">stdout</span> <span class="o">=&gt;</span> <span class="n">OUTPUT_UNIT</span>
<span class="c">!-----------------------------------------------------------------------------------------------------------------------------------</span>

<span class="c">!-----------------------------------------------------------------------------------------------------------------------------------</span>
<span class="k">implicit none</span>
<span class="k">private</span>
<span class="k">public</span> <span class="kd">::</span> <span class="n">ex</span><span class="p">,</span> <span class="n">ey</span><span class="p">,</span> <span class="n">ez</span>
<span class="k">public</span> <span class="kd">::</span> <span class="n">sq_norm</span>
<span class="k">public</span> <span class="kd">::</span> <span class="n">normL2</span>
<span class="k">public</span> <span class="kd">::</span> <span class="n">normalize</span>
<span class="k">public</span> <span class="kd">::</span> <span class="n">face_normal3</span><span class="p">,</span> <span class="n">face_normal4</span>
<span class="c">!-----------------------------------------------------------------------------------------------------------------------------------</span>

<span class="c">!-----------------------------------------------------------------------------------------------------------------------------------</span>
<span class="cp">#ifdef r16p</span>
<span class="kt">integer</span><span class="p">,</span>       <span class="k">parameter</span> <span class="kd">::</span> <span class="n">R16P</span>     <span class="o">=</span> <span class="nb">selected_real_kind</span><span class="p">(</span><span class="mi">33</span><span class="p">,</span><span class="mi">4931</span><span class="p">)</span> <span class="c">!&lt; 33  digits, range \([10^{-4931}, 10^{+4931} - 1]\); 128 bits.</span>
<span class="cp">#else</span>
<span class="kt">integer</span><span class="p">,</span>       <span class="k">parameter</span> <span class="kd">::</span> <span class="n">R16P</span>     <span class="o">=</span> <span class="nb">selected_real_kind</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="mi">307</span><span class="p">)</span>  <span class="c">!&lt; Defined as R8P; 64 bits.</span>
<span class="cp">#endif</span>
<span class="kt">integer</span><span class="p">,</span>       <span class="k">parameter</span> <span class="kd">::</span> <span class="n">R8P</span>      <span class="o">=</span> <span class="nb">selected_real_kind</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="mi">307</span><span class="p">)</span>  <span class="c">!&lt; 15  digits, range \([10^{-307} , 10^{+307}  - 1]\); 64 bits.</span>
<span class="kt">integer</span><span class="p">,</span>       <span class="k">parameter</span> <span class="kd">::</span> <span class="n">R4P</span>      <span class="o">=</span> <span class="nb">selected_real_kind</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">37</span><span class="p">)</span>    <span class="c">!&lt; 6   digits, range \([10^{-37}  , 10^{+37}   - 1]\); 32 bits.</span>
<span class="kt">integer</span><span class="p">,</span>       <span class="k">parameter</span> <span class="kd">::</span> <span class="n">I8P</span>      <span class="o">=</span> <span class="nb">selected_int_kind</span><span class="p">(</span><span class="mi">18</span><span class="p">)</span>       <span class="c">!&lt; Range \([-2^{63},+2^{63} - 1]\), 19 digits plus sign; 64 bits.</span>
<span class="kt">integer</span><span class="p">,</span>       <span class="k">parameter</span> <span class="kd">::</span> <span class="n">I4P</span>      <span class="o">=</span> <span class="nb">selected_int_kind</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span>        <span class="c">!&lt; Range \([-2^{31},+2^{31} - 1]\), 10 digits plus sign; 32 bits.</span>
<span class="kt">integer</span><span class="p">,</span>       <span class="k">parameter</span> <span class="kd">::</span> <span class="n">I2P</span>      <span class="o">=</span> <span class="nb">selected_int_kind</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>        <span class="c">!&lt; Range \([-2^{15},+2^{15} - 1]\), 5  digits plus sign; 16 bits.</span>
<span class="kt">integer</span><span class="p">,</span>       <span class="k">parameter</span> <span class="kd">::</span> <span class="n">I1P</span>      <span class="o">=</span> <span class="nb">selected_int_kind</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>        <span class="c">!&lt; Range \([-2^{7} ,+2^{7}  - 1]\), 3  digits plus sign; 8  bits.</span>
<span class="kt">real</span><span class="p">(</span><span class="n">R8P</span><span class="p">),</span>     <span class="k">parameter</span> <span class="kd">::</span> <span class="n">smallR8P</span> <span class="o">=</span> <span class="nb">tiny</span><span class="p">(</span><span class="mf">1._R8P</span> <span class="p">)</span>               <span class="c">!&lt; Smallest (module) representable value of kind=R8P variable.</span>
<span class="kt">integer</span><span class="p">,</span>       <span class="k">parameter</span> <span class="kd">::</span> <span class="n">DR8P</span>     <span class="o">=</span> <span class="mi">23</span>                          <span class="c">!&lt; Number of digits of output format FR8P.</span>
<span class="kt">character</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span> <span class="k">parameter</span> <span class="kd">::</span> <span class="n">FR8P</span>     <span class="o">=</span> <span class="s1">&#39;(E23.15E3)&#39;</span>                <span class="c">!&lt; Output format for kind=R8P variable.</span>

<span class="k">type</span><span class="p">,</span> <span class="k">public</span> <span class="kd">::</span> <span class="n">Vector</span>
  <span class="c">!&lt; Vector class.</span>
  <span class="kt">real</span><span class="p">(</span><span class="n">R8P</span><span class="p">)</span><span class="kd">::</span> <span class="n">x</span> <span class="o">=</span> <span class="mf">0._R8P</span> <span class="c">!&lt; Cartesian component in x direction.</span>
  <span class="kt">real</span><span class="p">(</span><span class="n">R8P</span><span class="p">)</span><span class="kd">::</span> <span class="n">y</span> <span class="o">=</span> <span class="mf">0._R8P</span> <span class="c">!&lt; Cartesian component in y direction.</span>
  <span class="kt">real</span><span class="p">(</span><span class="n">R8P</span><span class="p">)</span><span class="kd">::</span> <span class="n">z</span> <span class="o">=</span> <span class="mf">0._R8P</span> <span class="c">!&lt; Cartesian component in z direction.</span>
  <span class="k">contains</span>
<span class="k">    procedure</span> <span class="kd">::</span> <span class="n">init</span>            <span class="o">=&gt;</span> <span class="n">init_vector_self</span>  <span class="c">! Procedure for initializing vector components.</span>
    <span class="k">procedure</span> <span class="kd">::</span> <span class="n">set</span>             <span class="o">=&gt;</span> <span class="n">set_vector_self</span>   <span class="c">! Procedure for setting vector components.</span>
    <span class="k">procedure</span> <span class="kd">::</span> <span class="n">iolen</span>           <span class="o">=&gt;</span> <span class="n">iolen_vector_self</span> <span class="c">! Procedure for computing IO length.</span>
    <span class="k">procedure</span> <span class="kd">::</span> <span class="n">load</span>            <span class="o">=&gt;</span> <span class="n">load_vector_self</span>  <span class="c">! Procedure for loading Vector data.</span>
    <span class="k">procedure</span> <span class="kd">::</span> <span class="k">save</span>            <span class="o">=&gt;</span> <span class="n">save_vector_self</span>  <span class="c">! Procedure for saving Vector data.</span>
    <span class="k">procedure</span> <span class="kd">::</span> <span class="k">print</span>           <span class="o">=&gt;</span> <span class="n">print_vector_self</span> <span class="c">! Procedure for printing vector components with a &quot;pretty&quot; format.</span>
    <span class="k">procedure</span> <span class="kd">::</span> <span class="n">sq_norm</span>         <span class="o">=&gt;</span> <span class="n">sq_norm_self</span>      <span class="c">! Procedure for computing the square of the norm of a vector.</span>
    <span class="k">procedure</span> <span class="kd">::</span> <span class="n">normL2</span>          <span class="o">=&gt;</span> <span class="n">normL2_self</span>       <span class="c">! Procedure for computing the norm L2 of a vector.</span>
    <span class="k">procedure</span> <span class="kd">::</span> <span class="n">normalize</span>       <span class="o">=&gt;</span> <span class="n">normalize_self</span>    <span class="c">! Procedure for normalizing a vector.</span>
    <span class="k">procedure</span> <span class="kd">::</span> <span class="n">normalized</span>      <span class="o">=&gt;</span> <span class="n">normalized_self</span>   <span class="c">! Procedure for obtaining a normalized copy of a vector.</span>
    <span class="k">procedure</span> <span class="kd">::</span> <span class="n">face_normal4</span>    <span class="o">=&gt;</span> <span class="n">face_normal4_self</span> <span class="c">! Procedure for calculating the normal of the face defined by 4 points vector.</span>
    <span class="k">procedure</span> <span class="kd">::</span> <span class="n">face_normal3</span>    <span class="o">=&gt;</span> <span class="n">face_normal3_self</span> <span class="c">! Procedure for calculating the normal of the face defined by 3 points vector.</span>
    <span class="k">generic</span> <span class="kd">::</span> <span class="n">operator</span><span class="p">(.</span><span class="n">cross</span><span class="p">.)</span> <span class="o">=&gt;</span> <span class="n">crossproduct</span>      <span class="c">! Procedure for computing the cross product of 2 vectors.</span>
    <span class="k">generic</span> <span class="kd">::</span> <span class="n">operator</span><span class="p">(.</span><span class="n">dot</span><span class="p">.)</span>   <span class="o">=&gt;</span> <span class="n">dotproduct</span>        <span class="c">! Procedure for computing the scalar (dot) product of 2 vectors.</span>
    <span class="k">generic</span> <span class="kd">::</span> <span class="n">operator</span><span class="p">(.</span><span class="n">paral</span><span class="p">.)</span> <span class="o">=&gt;</span> <span class="n">parallel</span>          <span class="c">! Procedure for computing the component of vec1 parallel to vec2.</span>
    <span class="k">generic</span> <span class="kd">::</span> <span class="n">operator</span><span class="p">(.</span><span class="n">ortho</span><span class="p">.)</span> <span class="o">=&gt;</span> <span class="n">orthogonal</span>        <span class="c">! Procedure for computign the component of vec1 orthogonal to vec2.</span>
    <span class="k">procedure</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">vec1</span><span class="p">),</span> <span class="k">private</span> <span class="kd">::</span> <span class="n">crossproduct</span>
    <span class="k">procedure</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">vec1</span><span class="p">),</span> <span class="k">private</span> <span class="kd">::</span> <span class="n">dotproduct</span>
    <span class="k">procedure</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">vec1</span><span class="p">),</span> <span class="k">private</span> <span class="kd">::</span> <span class="n">parallel</span>
    <span class="k">procedure</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">vec1</span><span class="p">),</span> <span class="k">private</span> <span class="kd">::</span> <span class="n">orthogonal</span>
    <span class="c">! operators overloading</span>
    <span class="k">generic</span> <span class="kd">::</span> <span class="n">assignment</span><span class="p">(</span><span class="o">=</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="n">assign_self</span><span class="p">,</span>    <span class="p">&amp;</span>
<span class="cp">#ifdef r16p</span>
                               <span class="n">assign_ScalR16P</span><span class="p">,&amp;</span>
<span class="cp">#endif</span>
                               <span class="n">assign_ScalR8P</span><span class="p">,</span><span class="n">assign_ScalR4P</span><span class="p">,</span><span class="n">assign_ScalI8P</span><span class="p">,</span><span class="n">assign_ScalI4P</span><span class="p">,</span><span class="n">assign_ScalI2P</span><span class="p">,</span><span class="n">assign_ScalI1P</span>
<span class="cp">#ifdef r16p</span>
    <span class="k">procedure</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span> <span class="p">),</span> <span class="k">private</span> <span class="kd">::</span> <span class="n">assign_ScalR16P</span>
<span class="cp">#endif</span>
    <span class="k">procedure</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self1</span><span class="p">),</span> <span class="k">private</span> <span class="kd">::</span> <span class="n">assign_self</span>
    <span class="k">procedure</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span> <span class="p">),</span> <span class="k">private</span> <span class="kd">::</span> <span class="n">assign_ScalR8P</span>
    <span class="k">procedure</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span> <span class="p">),</span> <span class="k">private</span> <span class="kd">::</span> <span class="n">assign_ScalR4P</span>
    <span class="k">procedure</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span> <span class="p">),</span> <span class="k">private</span> <span class="kd">::</span> <span class="n">assign_ScalI8P</span>
    <span class="k">procedure</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span> <span class="p">),</span> <span class="k">private</span> <span class="kd">::</span> <span class="n">assign_ScalI4P</span>
    <span class="k">procedure</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span> <span class="p">),</span> <span class="k">private</span> <span class="kd">::</span> <span class="n">assign_ScalI2P</span>
    <span class="k">procedure</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span> <span class="p">),</span> <span class="k">private</span> <span class="kd">::</span> <span class="n">assign_ScalI1P</span>
    <span class="k">generic</span>                         <span class="kd">::</span> <span class="n">operator</span><span class="p">(</span><span class="o">*</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="n">self_mul_self</span><span class="p">,</span>                                                               <span class="p">&amp;</span>
<span class="cp">#ifdef r16p</span>
                             <span class="n">ScalR16P_mul_self</span><span class="p">,</span><span class="n">self_mul_ScalR16P</span><span class="p">,</span>                                                                  <span class="p">&amp;</span>
<span class="cp">#endif</span>
                             <span class="n">ScalR8P_mul_self</span><span class="p">,</span><span class="n">self_mul_ScalR8P</span><span class="p">,</span><span class="n">ScalR4P_mul_self</span><span class="p">,</span><span class="n">self_mul_ScalR4P</span><span class="p">,</span><span class="n">ScalI8P_mul_self</span><span class="p">,</span><span class="n">self_mul_ScalI8P</span><span class="p">,&amp;</span>
                             <span class="n">ScalI4P_mul_self</span><span class="p">,</span><span class="n">self_mul_ScalI4P</span><span class="p">,</span><span class="n">ScalI2P_mul_self</span><span class="p">,</span><span class="n">self_mul_ScalI2P</span><span class="p">,</span><span class="n">ScalI1P_mul_self</span><span class="p">,</span><span class="n">self_mul_ScalI1P</span>
<span class="cp">#ifdef r16p</span>
    <span class="k">procedure</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span> <span class="p">),</span> <span class="k">private</span> <span class="kd">::</span> <span class="n">ScalR16P_mul_self</span>
    <span class="k">procedure</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span> <span class="p">),</span> <span class="k">private</span> <span class="kd">::</span> <span class="n">self_mul_ScalR16P</span>
<span class="cp">#endif</span>
    <span class="k">procedure</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self1</span><span class="p">),</span> <span class="k">private</span> <span class="kd">::</span> <span class="n">self_mul_self</span>
    <span class="k">procedure</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span> <span class="p">),</span> <span class="k">private</span> <span class="kd">::</span> <span class="n">ScalR8P_mul_self</span>
    <span class="k">procedure</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span> <span class="p">),</span> <span class="k">private</span> <span class="kd">::</span> <span class="n">ScalR4P_mul_self</span>
    <span class="k">procedure</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span> <span class="p">),</span> <span class="k">private</span> <span class="kd">::</span> <span class="n">ScalI8P_mul_self</span>
    <span class="k">procedure</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span> <span class="p">),</span> <span class="k">private</span> <span class="kd">::</span> <span class="n">ScalI4P_mul_self</span>
    <span class="k">procedure</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span> <span class="p">),</span> <span class="k">private</span> <span class="kd">::</span> <span class="n">ScalI2P_mul_self</span>
    <span class="k">procedure</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span> <span class="p">),</span> <span class="k">private</span> <span class="kd">::</span> <span class="n">ScalI1P_mul_self</span>
    <span class="k">procedure</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span> <span class="p">),</span> <span class="k">private</span> <span class="kd">::</span> <span class="n">self_mul_ScalR8P</span>
    <span class="k">procedure</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span> <span class="p">),</span> <span class="k">private</span> <span class="kd">::</span> <span class="n">self_mul_ScalR4P</span>
    <span class="k">procedure</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span> <span class="p">),</span> <span class="k">private</span> <span class="kd">::</span> <span class="n">self_mul_ScalI8P</span>
    <span class="k">procedure</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span> <span class="p">),</span> <span class="k">private</span> <span class="kd">::</span> <span class="n">self_mul_ScalI4P</span>
    <span class="k">procedure</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span> <span class="p">),</span> <span class="k">private</span> <span class="kd">::</span> <span class="n">self_mul_ScalI2P</span>
    <span class="k">procedure</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span> <span class="p">),</span> <span class="k">private</span> <span class="kd">::</span> <span class="n">self_mul_ScalI1P</span>
    <span class="k">generic</span> <span class="kd">::</span> <span class="n">operator</span><span class="p">(</span><span class="o">/</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="n">self_div_self</span><span class="p">,</span>    <span class="p">&amp;</span>
<span class="cp">#ifdef r16p</span>
                             <span class="n">self_div_ScalR16P</span><span class="p">,&amp;</span>
<span class="cp">#endif</span>
                             <span class="n">self_div_ScalR8P</span><span class="p">,</span><span class="n">self_div_ScalR4P</span><span class="p">,</span><span class="n">self_div_ScalI8P</span><span class="p">,</span><span class="n">self_div_ScalI4P</span><span class="p">,</span><span class="n">self_div_ScalI2P</span><span class="p">,</span><span class="n">self_div_ScalI1P</span>
<span class="cp">#ifdef r16p</span>
    <span class="k">procedure</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span> <span class="p">),</span> <span class="k">private</span> <span class="kd">::</span> <span class="n">self_div_ScalR16P</span>
<span class="cp">#endif</span>
    <span class="k">procedure</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self1</span><span class="p">),</span> <span class="k">private</span> <span class="kd">::</span> <span class="n">self_div_self</span>
    <span class="k">procedure</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span> <span class="p">),</span> <span class="k">private</span> <span class="kd">::</span> <span class="n">self_div_ScalR8P</span>
    <span class="k">procedure</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span> <span class="p">),</span> <span class="k">private</span> <span class="kd">::</span> <span class="n">self_div_ScalR4P</span>
    <span class="k">procedure</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span> <span class="p">),</span> <span class="k">private</span> <span class="kd">::</span> <span class="n">self_div_ScalI8P</span>
    <span class="k">procedure</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span> <span class="p">),</span> <span class="k">private</span> <span class="kd">::</span> <span class="n">self_div_ScalI4P</span>
    <span class="k">procedure</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span> <span class="p">),</span> <span class="k">private</span> <span class="kd">::</span> <span class="n">self_div_ScalI2P</span>
    <span class="k">procedure</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span> <span class="p">),</span> <span class="k">private</span> <span class="kd">::</span> <span class="n">self_div_ScalI1P</span>
    <span class="k">generic</span> <span class="kd">::</span> <span class="n">operator</span><span class="p">(</span><span class="o">+</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="n">positive_self</span><span class="p">,</span><span class="n">self_sum_self</span><span class="p">,</span>                                                                         <span class="p">&amp;</span>
<span class="cp">#ifdef r16p</span>
                             <span class="n">ScalR16P_sum_self</span><span class="p">,</span><span class="n">self_sum_ScalR16P</span><span class="p">,</span>                                                                  <span class="p">&amp;</span>
<span class="cp">#endif</span>
                             <span class="n">ScalR8P_sum_self</span><span class="p">,</span><span class="n">self_sum_ScalR8P</span><span class="p">,</span><span class="n">ScalR4P_sum_self</span><span class="p">,</span><span class="n">self_sum_ScalR4P</span><span class="p">,</span><span class="n">ScalI8P_sum_self</span><span class="p">,</span><span class="n">self_sum_ScalI8P</span><span class="p">,&amp;</span>
                             <span class="n">ScalI4P_sum_self</span><span class="p">,</span><span class="n">self_sum_ScalI4P</span><span class="p">,</span><span class="n">ScalI2P_sum_self</span><span class="p">,</span><span class="n">self_sum_ScalI2P</span><span class="p">,</span><span class="n">ScalI1P_sum_self</span><span class="p">,</span><span class="n">self_sum_ScalI1P</span>
<span class="cp">#ifdef r16p</span>
    <span class="k">procedure</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span> <span class="p">),</span> <span class="k">private</span> <span class="kd">::</span> <span class="n">ScalR16P_sum_self</span>
    <span class="k">procedure</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span> <span class="p">),</span> <span class="k">private</span> <span class="kd">::</span> <span class="n">self_sum_ScalR16P</span>
<span class="cp">#endif</span>
    <span class="k">procedure</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span> <span class="p">),</span> <span class="k">private</span> <span class="kd">::</span> <span class="n">positive_self</span>
    <span class="k">procedure</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self1</span><span class="p">),</span> <span class="k">private</span> <span class="kd">::</span> <span class="n">self_sum_self</span>
    <span class="k">procedure</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span> <span class="p">),</span> <span class="k">private</span> <span class="kd">::</span> <span class="n">ScalR8P_sum_self</span>
    <span class="k">procedure</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span> <span class="p">),</span> <span class="k">private</span> <span class="kd">::</span> <span class="n">ScalR4P_sum_self</span>
    <span class="k">procedure</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span> <span class="p">),</span> <span class="k">private</span> <span class="kd">::</span> <span class="n">ScalI8P_sum_self</span>
    <span class="k">procedure</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span> <span class="p">),</span> <span class="k">private</span> <span class="kd">::</span> <span class="n">ScalI4P_sum_self</span>
    <span class="k">procedure</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span> <span class="p">),</span> <span class="k">private</span> <span class="kd">::</span> <span class="n">ScalI2P_sum_self</span>
    <span class="k">procedure</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span> <span class="p">),</span> <span class="k">private</span> <span class="kd">::</span> <span class="n">ScalI1P_sum_self</span>
    <span class="k">procedure</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span> <span class="p">),</span> <span class="k">private</span> <span class="kd">::</span> <span class="n">self_sum_ScalR8P</span>
    <span class="k">procedure</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span> <span class="p">),</span> <span class="k">private</span> <span class="kd">::</span> <span class="n">self_sum_ScalR4P</span>
    <span class="k">procedure</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span> <span class="p">),</span> <span class="k">private</span> <span class="kd">::</span> <span class="n">self_sum_ScalI8P</span>
    <span class="k">procedure</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span> <span class="p">),</span> <span class="k">private</span> <span class="kd">::</span> <span class="n">self_sum_ScalI4P</span>
    <span class="k">procedure</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span> <span class="p">),</span> <span class="k">private</span> <span class="kd">::</span> <span class="n">self_sum_ScalI2P</span>
    <span class="k">procedure</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span> <span class="p">),</span> <span class="k">private</span> <span class="kd">::</span> <span class="n">self_sum_ScalI1P</span>
    <span class="k">generic</span> <span class="kd">::</span> <span class="n">operator</span><span class="p">(</span><span class="o">-</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="n">negative_self</span><span class="p">,</span><span class="n">self_sub_self</span><span class="p">,</span>                                                                         <span class="p">&amp;</span>
<span class="cp">#ifdef r16p</span>
                             <span class="n">ScalR16P_sub_self</span><span class="p">,</span><span class="n">self_sub_ScalR16P</span><span class="p">,</span>                                                                  <span class="p">&amp;</span>
<span class="cp">#endif</span>
                             <span class="n">ScalR8P_sub_self</span><span class="p">,</span><span class="n">self_sub_ScalR8P</span><span class="p">,</span><span class="n">ScalR4P_sub_self</span><span class="p">,</span><span class="n">self_sub_ScalR4P</span><span class="p">,</span><span class="n">ScalI8P_sub_self</span><span class="p">,</span><span class="n">self_sub_ScalI8P</span><span class="p">,&amp;</span>
                             <span class="n">ScalI4P_sub_self</span><span class="p">,</span><span class="n">self_sub_ScalI4P</span><span class="p">,</span><span class="n">ScalI2P_sub_self</span><span class="p">,</span><span class="n">self_sub_ScalI2P</span><span class="p">,</span><span class="n">ScalI1P_sub_self</span><span class="p">,</span><span class="n">self_sub_ScalI1P</span>
<span class="cp">#ifdef r16p</span>
    <span class="k">procedure</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span> <span class="p">),</span> <span class="k">private</span> <span class="kd">::</span> <span class="n">ScalR16P_sub_self</span>
    <span class="k">procedure</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span> <span class="p">),</span> <span class="k">private</span> <span class="kd">::</span> <span class="n">self_sub_ScalR16P</span>
<span class="cp">#endif</span>
    <span class="k">procedure</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span> <span class="p">),</span> <span class="k">private</span> <span class="kd">::</span> <span class="n">negative_self</span>
    <span class="k">procedure</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self1</span><span class="p">),</span> <span class="k">private</span> <span class="kd">::</span> <span class="n">self_sub_self</span>
    <span class="k">procedure</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span> <span class="p">),</span> <span class="k">private</span> <span class="kd">::</span> <span class="n">ScalR8P_sub_self</span>
    <span class="k">procedure</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span> <span class="p">),</span> <span class="k">private</span> <span class="kd">::</span> <span class="n">ScalR4P_sub_self</span>
    <span class="k">procedure</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span> <span class="p">),</span> <span class="k">private</span> <span class="kd">::</span> <span class="n">ScalI8P_sub_self</span>
    <span class="k">procedure</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span> <span class="p">),</span> <span class="k">private</span> <span class="kd">::</span> <span class="n">ScalI4P_sub_self</span>
    <span class="k">procedure</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span> <span class="p">),</span> <span class="k">private</span> <span class="kd">::</span> <span class="n">ScalI2P_sub_self</span>
    <span class="k">procedure</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span> <span class="p">),</span> <span class="k">private</span> <span class="kd">::</span> <span class="n">ScalI1P_sub_self</span>
    <span class="k">procedure</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span> <span class="p">),</span> <span class="k">private</span> <span class="kd">::</span> <span class="n">self_sub_ScalR8P</span>
    <span class="k">procedure</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span> <span class="p">),</span> <span class="k">private</span> <span class="kd">::</span> <span class="n">self_sub_ScalR4P</span>
    <span class="k">procedure</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span> <span class="p">),</span> <span class="k">private</span> <span class="kd">::</span> <span class="n">self_sub_ScalI8P</span>
    <span class="k">procedure</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span> <span class="p">),</span> <span class="k">private</span> <span class="kd">::</span> <span class="n">self_sub_ScalI4P</span>
    <span class="k">procedure</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span> <span class="p">),</span> <span class="k">private</span> <span class="kd">::</span> <span class="n">self_sub_ScalI2P</span>
    <span class="k">procedure</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span> <span class="p">),</span> <span class="k">private</span> <span class="kd">::</span> <span class="n">self_sub_ScalI1P</span>
    <span class="k">generic</span> <span class="kd">::</span> <span class="n">operator</span><span class="p">(</span><span class="o">/=</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="n">self_not_eq_self</span><span class="p">,</span>                                                                              <span class="p">&amp;</span>
<span class="cp">#ifdef r16p</span>
                              <span class="n">R16P_not_eq_self</span><span class="p">,</span><span class="n">self_not_eq_R16P</span><span class="p">,</span>                                                              <span class="p">&amp;</span>
<span class="cp">#endif</span>
                              <span class="n">R8P_not_eq_self</span><span class="p">,</span><span class="n">self_not_eq_R8P</span><span class="p">,</span><span class="n">R4P_not_eq_self</span><span class="p">,</span><span class="n">self_not_eq_R4P</span><span class="p">,</span><span class="n">I8P_not_eq_self</span><span class="p">,</span><span class="n">self_not_eq_I8P</span><span class="p">,&amp;</span>
                              <span class="n">I4P_not_eq_self</span><span class="p">,</span><span class="n">self_not_eq_I4P</span><span class="p">,</span><span class="n">I2P_not_eq_self</span><span class="p">,</span><span class="n">self_not_eq_I2P</span><span class="p">,</span><span class="n">I1P_not_eq_self</span><span class="p">,</span><span class="n">self_not_eq_I1P</span>
    <span class="k">generic</span> <span class="kd">::</span> <span class="n">operator</span><span class="p">(</span><span class="o">&lt;</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="n">self_low_self</span><span class="p">,</span>                                                               <span class="p">&amp;</span>
<span class="cp">#ifdef r16p</span>
                             <span class="n">R16P_low_self</span><span class="p">,</span><span class="n">self_low_R16P</span><span class="p">,</span>                                                  <span class="p">&amp;</span>
<span class="cp">#endif</span>
                             <span class="n">R8P_low_self</span><span class="p">,</span><span class="n">self_low_R8P</span><span class="p">,</span><span class="n">R4P_low_self</span><span class="p">,</span><span class="n">self_low_R4P</span><span class="p">,</span><span class="n">I8P_low_self</span><span class="p">,</span><span class="n">self_low_I8P</span><span class="p">,&amp;</span>
                             <span class="n">I4P_low_self</span><span class="p">,</span><span class="n">self_low_I4P</span><span class="p">,</span><span class="n">I2P_low_self</span><span class="p">,</span><span class="n">self_low_I2P</span><span class="p">,</span><span class="n">I1P_low_self</span><span class="p">,</span><span class="n">self_low_I1P</span>

    <span class="k">generic</span> <span class="kd">::</span> <span class="n">operator</span><span class="p">(</span><span class="o">&lt;=</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="n">self_low_eq_self</span><span class="p">,</span>                                                                              <span class="p">&amp;</span>
<span class="cp">#ifdef r16p</span>
                              <span class="n">R16P_low_eq_self</span><span class="p">,</span><span class="n">self_low_eq_R16P</span><span class="p">,</span>                                                              <span class="p">&amp;</span>
<span class="cp">#endif</span>
                              <span class="n">R8P_low_eq_self</span><span class="p">,</span><span class="n">self_low_eq_R8P</span><span class="p">,</span><span class="n">R4P_low_eq_self</span><span class="p">,</span><span class="n">self_low_eq_R4P</span><span class="p">,</span><span class="n">I8P_low_eq_self</span><span class="p">,</span><span class="n">self_low_eq_I8P</span><span class="p">,&amp;</span>
                              <span class="n">I4P_low_eq_self</span><span class="p">,</span><span class="n">self_low_eq_I4P</span><span class="p">,</span><span class="n">I2P_low_eq_self</span><span class="p">,</span><span class="n">self_low_eq_I2P</span><span class="p">,</span><span class="n">I1P_low_eq_self</span><span class="p">,</span><span class="n">self_low_eq_I1P</span>
    <span class="k">generic</span> <span class="kd">::</span> <span class="n">operator</span><span class="p">(</span><span class="o">==</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="n">self_eq_self</span><span class="p">,</span>                                                          <span class="p">&amp;</span>
<span class="cp">#ifdef r16p</span>
                              <span class="n">R16P_eq_self</span><span class="p">,</span><span class="n">self_eq_R16P</span><span class="p">,</span>                                              <span class="p">&amp;</span>
<span class="cp">#endif</span>
                              <span class="n">R8P_eq_self</span><span class="p">,</span><span class="n">self_eq_R8P</span><span class="p">,</span><span class="n">R4P_eq_self</span><span class="p">,</span><span class="n">self_eq_R4P</span><span class="p">,</span><span class="n">I8P_eq_self</span><span class="p">,</span><span class="n">self_eq_I8P</span><span class="p">,&amp;</span>
                              <span class="n">I4P_eq_self</span><span class="p">,</span><span class="n">self_eq_I4P</span><span class="p">,</span><span class="n">I2P_eq_self</span><span class="p">,</span><span class="n">self_eq_I2P</span><span class="p">,</span><span class="n">I1P_eq_self</span><span class="p">,</span><span class="n">self_eq_I1P</span>
    <span class="k">generic</span><span class="kd">::</span> <span class="n">operator</span><span class="p">(</span><span class="o">&gt;=</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="n">self_great_eq_self</span><span class="p">,</span>                                                                       <span class="p">&amp;</span>
<span class="cp">#ifdef r16p</span>
                              <span class="n">R16P_great_eq_self</span><span class="p">,</span><span class="n">self_great_eq_R16P</span><span class="p">,</span>                                                    <span class="p">&amp;</span>
<span class="cp">#endif</span>
                              <span class="n">R8P_great_eq_self</span><span class="p">,</span><span class="n">self_great_eq_R8P</span><span class="p">,</span><span class="n">R4P_great_eq_self</span><span class="p">,</span><span class="n">self_great_eq_R4P</span><span class="p">,</span><span class="n">I8P_great_eq_self</span><span class="p">,&amp;</span>
                              <span class="n">self_great_eq_I8P</span><span class="p">,</span><span class="n">I4P_great_eq_self</span><span class="p">,</span><span class="n">self_great_eq_I4P</span><span class="p">,</span><span class="n">I2P_great_eq_self</span><span class="p">,</span><span class="n">self_great_eq_I2P</span><span class="p">,&amp;</span>
                              <span class="n">I1P_great_eq_self</span><span class="p">,</span><span class="n">self_great_eq_I1P</span>
    <span class="k">generic</span> <span class="kd">::</span> <span class="n">operator</span><span class="p">(</span><span class="o">&gt;</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="n">self_great_self</span><span class="p">,</span>                                                                         <span class="p">&amp;</span>
<span class="cp">#ifdef r16p</span>
                             <span class="n">R16P_great_self</span><span class="p">,</span><span class="n">self_great_R16P</span><span class="p">,</span>                                                          <span class="p">&amp;</span>
<span class="cp">#endif</span>
                             <span class="n">R8P_great_self</span><span class="p">,</span><span class="n">self_great_R8P</span><span class="p">,</span><span class="n">R4P_great_self</span><span class="p">,</span><span class="n">self_great_R4P</span><span class="p">,</span><span class="n">I8P_great_self</span><span class="p">,</span><span class="n">self_great_I8P</span><span class="p">,&amp;</span>
                             <span class="n">I4P_great_self</span><span class="p">,</span><span class="n">self_great_I4P</span><span class="p">,</span><span class="n">I2P_great_self</span><span class="p">,</span><span class="n">self_great_I2P</span><span class="p">,</span><span class="n">I1P_great_self</span><span class="p">,</span><span class="n">self_great_I1P</span>
<span class="cp">#ifdef r16p</span>
    <span class="k">procedure</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span> <span class="p">),</span> <span class="k">private</span> <span class="kd">::</span> <span class="n">R16P_not_eq_self</span>
    <span class="k">procedure</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span> <span class="p">),</span> <span class="k">private</span> <span class="kd">::</span> <span class="n">self_not_eq_R16P</span>
    <span class="k">procedure</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span> <span class="p">),</span> <span class="k">private</span> <span class="kd">::</span> <span class="n">R16P_low_self</span>
    <span class="k">procedure</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span> <span class="p">),</span> <span class="k">private</span> <span class="kd">::</span> <span class="n">self_low_R16P</span>
    <span class="k">procedure</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span> <span class="p">),</span> <span class="k">private</span> <span class="kd">::</span> <span class="n">R16P_low_eq_self</span>
    <span class="k">procedure</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span> <span class="p">),</span> <span class="k">private</span> <span class="kd">::</span> <span class="n">self_low_eq_R16P</span>
    <span class="k">procedure</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span> <span class="p">),</span> <span class="k">private</span> <span class="kd">::</span> <span class="n">R16P_eq_self</span>
    <span class="k">procedure</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span> <span class="p">),</span> <span class="k">private</span> <span class="kd">::</span> <span class="n">self_eq_R16P</span>
    <span class="k">procedure</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span> <span class="p">),</span> <span class="k">private</span> <span class="kd">::</span> <span class="n">R16P_great_eq_self</span>
    <span class="k">procedure</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span> <span class="p">),</span> <span class="k">private</span> <span class="kd">::</span> <span class="n">self_great_eq_R16P</span>
    <span class="k">procedure</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span> <span class="p">),</span> <span class="k">private</span> <span class="kd">::</span> <span class="n">R16P_great_self</span>
    <span class="k">procedure</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span> <span class="p">),</span> <span class="k">private</span> <span class="kd">::</span> <span class="n">self_great_R16P</span>
<span class="cp">#endif</span>
    <span class="k">procedure</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self1</span><span class="p">),</span> <span class="k">private</span> <span class="kd">::</span> <span class="n">self_not_eq_self</span>
    <span class="k">procedure</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span> <span class="p">),</span> <span class="k">private</span> <span class="kd">::</span> <span class="n">R8P_not_eq_self</span>
    <span class="k">procedure</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span> <span class="p">),</span> <span class="k">private</span> <span class="kd">::</span> <span class="n">R4P_not_eq_self</span>
    <span class="k">procedure</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span> <span class="p">),</span> <span class="k">private</span> <span class="kd">::</span> <span class="n">I8P_not_eq_self</span>
    <span class="k">procedure</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span> <span class="p">),</span> <span class="k">private</span> <span class="kd">::</span> <span class="n">I4P_not_eq_self</span>
    <span class="k">procedure</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span> <span class="p">),</span> <span class="k">private</span> <span class="kd">::</span> <span class="n">I2P_not_eq_self</span>
    <span class="k">procedure</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span> <span class="p">),</span> <span class="k">private</span> <span class="kd">::</span> <span class="n">I1P_not_eq_self</span>
    <span class="k">procedure</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span> <span class="p">),</span> <span class="k">private</span> <span class="kd">::</span> <span class="n">self_not_eq_R8P</span>
    <span class="k">procedure</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span> <span class="p">),</span> <span class="k">private</span> <span class="kd">::</span> <span class="n">self_not_eq_R4P</span>
    <span class="k">procedure</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span> <span class="p">),</span> <span class="k">private</span> <span class="kd">::</span> <span class="n">self_not_eq_I8P</span>
    <span class="k">procedure</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span> <span class="p">),</span> <span class="k">private</span> <span class="kd">::</span> <span class="n">self_not_eq_I4P</span>
    <span class="k">procedure</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span> <span class="p">),</span> <span class="k">private</span> <span class="kd">::</span> <span class="n">self_not_eq_I2P</span>
    <span class="k">procedure</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span> <span class="p">),</span> <span class="k">private</span> <span class="kd">::</span> <span class="n">self_not_eq_I1P</span>
    <span class="k">procedure</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self1</span><span class="p">),</span> <span class="k">private</span> <span class="kd">::</span> <span class="n">self_low_self</span>
    <span class="k">procedure</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span> <span class="p">),</span> <span class="k">private</span> <span class="kd">::</span> <span class="n">R8P_low_self</span>
    <span class="k">procedure</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span> <span class="p">),</span> <span class="k">private</span> <span class="kd">::</span> <span class="n">R4P_low_self</span>
    <span class="k">procedure</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span> <span class="p">),</span> <span class="k">private</span> <span class="kd">::</span> <span class="n">I8P_low_self</span>
    <span class="k">procedure</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span> <span class="p">),</span> <span class="k">private</span> <span class="kd">::</span> <span class="n">I4P_low_self</span>
    <span class="k">procedure</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span> <span class="p">),</span> <span class="k">private</span> <span class="kd">::</span> <span class="n">I2P_low_self</span>
    <span class="k">procedure</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span> <span class="p">),</span> <span class="k">private</span> <span class="kd">::</span> <span class="n">I1P_low_self</span>
    <span class="k">procedure</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span> <span class="p">),</span> <span class="k">private</span> <span class="kd">::</span> <span class="n">self_low_R8P</span>
    <span class="k">procedure</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span> <span class="p">),</span> <span class="k">private</span> <span class="kd">::</span> <span class="n">self_low_R4P</span>
    <span class="k">procedure</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span> <span class="p">),</span> <span class="k">private</span> <span class="kd">::</span> <span class="n">self_low_I8P</span>
    <span class="k">procedure</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span> <span class="p">),</span> <span class="k">private</span> <span class="kd">::</span> <span class="n">self_low_I4P</span>
    <span class="k">procedure</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span> <span class="p">),</span> <span class="k">private</span> <span class="kd">::</span> <span class="n">self_low_I2P</span>
    <span class="k">procedure</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span> <span class="p">),</span> <span class="k">private</span> <span class="kd">::</span> <span class="n">self_low_I1P</span>
    <span class="k">procedure</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self1</span><span class="p">),</span> <span class="k">private</span> <span class="kd">::</span> <span class="n">self_low_eq_self</span>
    <span class="k">procedure</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span> <span class="p">),</span> <span class="k">private</span> <span class="kd">::</span> <span class="n">R8P_low_eq_self</span>
    <span class="k">procedure</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span> <span class="p">),</span> <span class="k">private</span> <span class="kd">::</span> <span class="n">R4P_low_eq_self</span>
    <span class="k">procedure</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span> <span class="p">),</span> <span class="k">private</span> <span class="kd">::</span> <span class="n">I8P_low_eq_self</span>
    <span class="k">procedure</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span> <span class="p">),</span> <span class="k">private</span> <span class="kd">::</span> <span class="n">I4P_low_eq_self</span>
    <span class="k">procedure</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span> <span class="p">),</span> <span class="k">private</span> <span class="kd">::</span> <span class="n">I2P_low_eq_self</span>
    <span class="k">procedure</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span> <span class="p">),</span> <span class="k">private</span> <span class="kd">::</span> <span class="n">I1P_low_eq_self</span>
    <span class="k">procedure</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span> <span class="p">),</span> <span class="k">private</span> <span class="kd">::</span> <span class="n">self_low_eq_R8P</span>
    <span class="k">procedure</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span> <span class="p">),</span> <span class="k">private</span> <span class="kd">::</span> <span class="n">self_low_eq_R4P</span>
    <span class="k">procedure</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span> <span class="p">),</span> <span class="k">private</span> <span class="kd">::</span> <span class="n">self_low_eq_I8P</span>
    <span class="k">procedure</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span> <span class="p">),</span> <span class="k">private</span> <span class="kd">::</span> <span class="n">self_low_eq_I4P</span>
    <span class="k">procedure</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span> <span class="p">),</span> <span class="k">private</span> <span class="kd">::</span> <span class="n">self_low_eq_I2P</span>
    <span class="k">procedure</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span> <span class="p">),</span> <span class="k">private</span> <span class="kd">::</span> <span class="n">self_low_eq_I1P</span>
    <span class="k">procedure</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self1</span><span class="p">),</span> <span class="k">private</span> <span class="kd">::</span> <span class="n">self_eq_self</span>
    <span class="k">procedure</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span> <span class="p">),</span> <span class="k">private</span> <span class="kd">::</span> <span class="n">R8P_eq_self</span>
    <span class="k">procedure</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span> <span class="p">),</span> <span class="k">private</span> <span class="kd">::</span> <span class="n">R4P_eq_self</span>
    <span class="k">procedure</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span> <span class="p">),</span> <span class="k">private</span> <span class="kd">::</span> <span class="n">I8P_eq_self</span>
    <span class="k">procedure</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span> <span class="p">),</span> <span class="k">private</span> <span class="kd">::</span> <span class="n">I4P_eq_self</span>
    <span class="k">procedure</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span> <span class="p">),</span> <span class="k">private</span> <span class="kd">::</span> <span class="n">I2P_eq_self</span>
    <span class="k">procedure</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span> <span class="p">),</span> <span class="k">private</span> <span class="kd">::</span> <span class="n">I1P_eq_self</span>
    <span class="k">procedure</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span> <span class="p">),</span> <span class="k">private</span> <span class="kd">::</span> <span class="n">self_eq_R8P</span>
    <span class="k">procedure</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span> <span class="p">),</span> <span class="k">private</span> <span class="kd">::</span> <span class="n">self_eq_R4P</span>
    <span class="k">procedure</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span> <span class="p">),</span> <span class="k">private</span> <span class="kd">::</span> <span class="n">self_eq_I8P</span>
    <span class="k">procedure</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span> <span class="p">),</span> <span class="k">private</span> <span class="kd">::</span> <span class="n">self_eq_I4P</span>
    <span class="k">procedure</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span> <span class="p">),</span> <span class="k">private</span> <span class="kd">::</span> <span class="n">self_eq_I2P</span>
    <span class="k">procedure</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span> <span class="p">),</span> <span class="k">private</span> <span class="kd">::</span> <span class="n">self_eq_I1P</span>
    <span class="k">procedure</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self1</span><span class="p">),</span> <span class="k">private</span> <span class="kd">::</span> <span class="n">self_great_eq_self</span>
    <span class="k">procedure</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span> <span class="p">),</span> <span class="k">private</span> <span class="kd">::</span> <span class="n">R8P_great_eq_self</span>
    <span class="k">procedure</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span> <span class="p">),</span> <span class="k">private</span> <span class="kd">::</span> <span class="n">R4P_great_eq_self</span>
    <span class="k">procedure</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span> <span class="p">),</span> <span class="k">private</span> <span class="kd">::</span> <span class="n">I8P_great_eq_self</span>
    <span class="k">procedure</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span> <span class="p">),</span> <span class="k">private</span> <span class="kd">::</span> <span class="n">I4P_great_eq_self</span>
    <span class="k">procedure</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span> <span class="p">),</span> <span class="k">private</span> <span class="kd">::</span> <span class="n">I2P_great_eq_self</span>
    <span class="k">procedure</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span> <span class="p">),</span> <span class="k">private</span> <span class="kd">::</span> <span class="n">I1P_great_eq_self</span>
    <span class="k">procedure</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span> <span class="p">),</span> <span class="k">private</span> <span class="kd">::</span> <span class="n">self_great_eq_R8P</span>
    <span class="k">procedure</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span> <span class="p">),</span> <span class="k">private</span> <span class="kd">::</span> <span class="n">self_great_eq_R4P</span>
    <span class="k">procedure</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span> <span class="p">),</span> <span class="k">private</span> <span class="kd">::</span> <span class="n">self_great_eq_I8P</span>
    <span class="k">procedure</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span> <span class="p">),</span> <span class="k">private</span> <span class="kd">::</span> <span class="n">self_great_eq_I4P</span>
    <span class="k">procedure</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span> <span class="p">),</span> <span class="k">private</span> <span class="kd">::</span> <span class="n">self_great_eq_I2P</span>
    <span class="k">procedure</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span> <span class="p">),</span> <span class="k">private</span> <span class="kd">::</span> <span class="n">self_great_eq_I1P</span>
    <span class="k">procedure</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self1</span><span class="p">),</span> <span class="k">private</span> <span class="kd">::</span> <span class="n">self_great_self</span>
    <span class="k">procedure</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span> <span class="p">),</span> <span class="k">private</span> <span class="kd">::</span> <span class="n">R8P_great_self</span>
    <span class="k">procedure</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span> <span class="p">),</span> <span class="k">private</span> <span class="kd">::</span> <span class="n">R4P_great_self</span>
    <span class="k">procedure</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span> <span class="p">),</span> <span class="k">private</span> <span class="kd">::</span> <span class="n">I8P_great_self</span>
    <span class="k">procedure</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span> <span class="p">),</span> <span class="k">private</span> <span class="kd">::</span> <span class="n">I4P_great_self</span>
    <span class="k">procedure</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span> <span class="p">),</span> <span class="k">private</span> <span class="kd">::</span> <span class="n">I2P_great_self</span>
    <span class="k">procedure</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span> <span class="p">),</span> <span class="k">private</span> <span class="kd">::</span> <span class="n">I1P_great_self</span>
    <span class="k">procedure</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span> <span class="p">),</span> <span class="k">private</span> <span class="kd">::</span> <span class="n">self_great_R8P</span>
    <span class="k">procedure</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span> <span class="p">),</span> <span class="k">private</span> <span class="kd">::</span> <span class="n">self_great_R4P</span>
    <span class="k">procedure</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span> <span class="p">),</span> <span class="k">private</span> <span class="kd">::</span> <span class="n">self_great_I8P</span>
    <span class="k">procedure</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span> <span class="p">),</span> <span class="k">private</span> <span class="kd">::</span> <span class="n">self_great_I4P</span>
    <span class="k">procedure</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span> <span class="p">),</span> <span class="k">private</span> <span class="kd">::</span> <span class="n">self_great_I2P</span>
    <span class="k">procedure</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span> <span class="p">),</span> <span class="k">private</span> <span class="kd">::</span> <span class="n">self_great_I1P</span>
<span class="n">endtype</span> <span class="n">Vector</span>

<span class="k">type</span><span class="p">,</span> <span class="k">public</span> <span class="kd">::</span> <span class="n">Vector_Ptr</span>
  <span class="c">!&lt; Pointer of Vector for creating array of pointers of Vector.</span>
  <span class="k">type</span><span class="p">(</span><span class="n">Vector</span><span class="p">),</span> <span class="k">pointer</span><span class="kd">::</span> <span class="n">p</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<span class="n">endtype</span> <span class="n">Vector_Ptr</span>

<span class="k">type</span><span class="p">(</span><span class="n">Vector</span><span class="p">),</span> <span class="k">parameter</span><span class="kd">::</span> <span class="n">ex</span> <span class="o">=</span> <span class="n">Vector</span><span class="p">(</span><span class="mf">1._R8P</span><span class="p">,</span><span class="mf">0._R8P</span><span class="p">,</span><span class="mf">0._R8P</span><span class="p">)</span> <span class="c">!&lt; X direction versor.</span>
<span class="k">type</span><span class="p">(</span><span class="n">Vector</span><span class="p">),</span> <span class="k">parameter</span><span class="kd">::</span> <span class="n">ey</span> <span class="o">=</span> <span class="n">Vector</span><span class="p">(</span><span class="mf">0._R8P</span><span class="p">,</span><span class="mf">1._R8P</span><span class="p">,</span><span class="mf">0._R8P</span><span class="p">)</span> <span class="c">!&lt; Y direction versor.</span>
<span class="k">type</span><span class="p">(</span><span class="n">Vector</span><span class="p">),</span> <span class="k">parameter</span><span class="kd">::</span> <span class="n">ez</span> <span class="o">=</span> <span class="n">Vector</span><span class="p">(</span><span class="mf">0._R8P</span><span class="p">,</span><span class="mf">0._R8P</span><span class="p">,</span><span class="mf">1._R8P</span><span class="p">)</span> <span class="c">!&lt; Z direction versor.</span>
<span class="c">!-----------------------------------------------------------------------------------------------------------------------------------</span>
<span class="k">contains</span>
<span class="k">  elemental function </span><span class="n">sq_norm</span><span class="p">(</span><span class="n">vec</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">sq</span><span class="p">)</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="c">!&lt; Compute the square of the norm of a vector.</span>
  <span class="c">!&lt;</span>
  <span class="c">!&lt; The square norm if defined as \( N = x^2  + y^2  + z^2 \).</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="k">type</span><span class="p">(</span><span class="n">Vector</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">vec</span> <span class="c">!&lt; Vector.</span>
  <span class="kt">real</span><span class="p">(</span><span class="n">R8P</span><span class="p">)</span>                <span class="kd">::</span> <span class="n">sq</span>  <span class="c">!&lt; Square of the Norm.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>

  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">sq</span> <span class="o">=</span> <span class="p">(</span><span class="n">vec</span><span class="p">%</span><span class="n">x</span> <span class="o">*</span> <span class="n">vec</span><span class="p">%</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">vec</span><span class="p">%</span><span class="n">y</span> <span class="o">*</span> <span class="n">vec</span><span class="p">%</span><span class="n">y</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">vec</span><span class="p">%</span><span class="n">z</span> <span class="o">*</span> <span class="n">vec</span><span class="p">%</span><span class="n">z</span><span class="p">)</span>
  <span class="k">return</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">endfunction</span> <span class="n">sq_norm</span>

  <span class="k">elemental function </span><span class="n">normL2</span><span class="p">(</span><span class="n">vec</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">norm</span><span class="p">)</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="c">!&lt; Compute the norm L2 of a vector.</span>
  <span class="c">!&lt;</span>
  <span class="c">!&lt; The norm L2 if defined as \( N = \sqrt {x^2  + y^2  + z^2 } \).</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="k">type</span><span class="p">(</span><span class="n">Vector</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">vec</span>  <span class="c">!&lt; Vector.</span>
  <span class="kt">real</span><span class="p">(</span><span class="n">R8P</span><span class="p">)</span>                <span class="kd">::</span> <span class="n">norm</span> <span class="c">!&lt; Norm L2.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>

  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">norm</span> <span class="o">=</span> <span class="nb">sqrt</span><span class="p">((</span><span class="n">vec</span><span class="p">%</span><span class="n">x</span><span class="o">*</span><span class="n">vec</span><span class="p">%</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">vec</span><span class="p">%</span><span class="n">y</span><span class="o">*</span><span class="n">vec</span><span class="p">%</span><span class="n">y</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">vec</span><span class="p">%</span><span class="n">z</span><span class="o">*</span><span class="n">vec</span><span class="p">%</span><span class="n">z</span><span class="p">))</span>
  <span class="k">return</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">endfunction</span> <span class="n">normL2</span>

  <span class="k">elemental function </span><span class="n">normalize</span><span class="p">(</span><span class="n">vec</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">norm</span><span class="p">)</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="c">!&lt; Normalize a vector.</span>
  <span class="c">!&lt;</span>
  <span class="c">!&lt; The normalization is made by means of norm L2. If the norm L2 of the vector is less than the parameter smallR8P the</span>
  <span class="c">!&lt; normalization value is set to normL2(vec)+smallR8P.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="k">type</span><span class="p">(</span><span class="n">Vector</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">vec</span>  <span class="c">!&lt; Vector to be normalized.</span>
  <span class="k">type</span><span class="p">(</span><span class="n">Vector</span><span class="p">)</span>             <span class="kd">::</span> <span class="n">norm</span> <span class="c">!&lt; Vector normalized.</span>
  <span class="kt">real</span><span class="p">(</span><span class="n">R8P</span><span class="p">)</span>                <span class="kd">::</span> <span class="n">nm</span>   <span class="c">!&lt; Norm L2 of vector.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>

  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">nm</span> <span class="o">=</span> <span class="n">normL2</span><span class="p">(</span><span class="n">vec</span><span class="p">)</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">nm</span> <span class="o">&lt;</span> <span class="n">smallR8P</span><span class="p">)</span> <span class="k">then</span>
<span class="k">    </span><span class="n">nm</span> <span class="o">=</span> <span class="n">nm</span> <span class="o">+</span> <span class="n">smallR8P</span>
  <span class="n">endif</span>
  <span class="n">norm</span><span class="p">%</span><span class="n">x</span> <span class="o">=</span> <span class="n">vec</span><span class="p">%</span><span class="n">x</span> <span class="o">/</span> <span class="n">nm</span>
  <span class="n">norm</span><span class="p">%</span><span class="n">y</span> <span class="o">=</span> <span class="n">vec</span><span class="p">%</span><span class="n">y</span> <span class="o">/</span> <span class="n">nm</span>
  <span class="n">norm</span><span class="p">%</span><span class="n">z</span> <span class="o">=</span> <span class="n">vec</span><span class="p">%</span><span class="n">z</span> <span class="o">/</span> <span class="n">nm</span>
  <span class="k">return</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">endfunction</span> <span class="n">normalize</span>

  <span class="k">elemental function </span><span class="n">face_normal4</span><span class="p">(</span><span class="n">pt1</span><span class="p">,</span> <span class="n">pt2</span><span class="p">,</span> <span class="n">pt3</span><span class="p">,</span> <span class="n">pt4</span><span class="p">,</span> <span class="n">norm</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">fnormal</span><span class="p">)</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="c">!&lt; Calculate the normal of the face defined by 4 points vector pt1, pt2, pt3 and pt4.</span>
  <span class="c">!&lt;</span>
  <span class="c">!&lt; The convention for the points numeration is the following:</span>
  <span class="c">!&lt;```</span>
  <span class="c">!&lt; 1.----------.2</span>
  <span class="c">!&lt;  |          |</span>
  <span class="c">!&lt;  |          |</span>
  <span class="c">!&lt;  |          |</span>
  <span class="c">!&lt;  |          |</span>
  <span class="c">!&lt; 4.----------.3</span>
  <span class="c">!&lt;```</span>
  <span class="c">!&lt; The normal is calculated by the cross product of the diagonal d13 for the diagonal d24: d13 x d24.</span>
  <span class="c">!&lt; The normal is normalized if the variable *norm* is passed (with any value).</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="k">type</span><span class="p">(</span><span class="n">Vector</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">pt1</span>     <span class="c">!&lt; First face point.</span>
  <span class="k">type</span><span class="p">(</span><span class="n">Vector</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">pt2</span>     <span class="c">!&lt; Second face point.</span>
  <span class="k">type</span><span class="p">(</span><span class="n">Vector</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">pt3</span>     <span class="c">!&lt; Third face point.</span>
  <span class="k">type</span><span class="p">(</span><span class="n">Vector</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">pt4</span>     <span class="c">!&lt; Fourth face point.</span>
  <span class="kt">character</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">norm</span>    <span class="c">!&lt; If &#39;norm&#39; is passed as argument the normal is normalized.</span>
  <span class="k">type</span><span class="p">(</span><span class="n">Vector</span><span class="p">)</span>                       <span class="kd">::</span> <span class="n">fnormal</span> <span class="c">!&lt; Face normal.</span>
  <span class="k">type</span><span class="p">(</span><span class="n">Vector</span><span class="p">)</span>                       <span class="kd">::</span> <span class="n">d13</span>     <span class="c">!&lt; Face 1-3 diagonal.</span>
  <span class="k">type</span><span class="p">(</span><span class="n">Vector</span><span class="p">)</span>                       <span class="kd">::</span> <span class="n">d24</span>     <span class="c">!&lt; Face 2-4 diagonal.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>

  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">d13</span> <span class="o">=</span> <span class="n">pt3</span> <span class="o">-</span> <span class="n">pt1</span>
  <span class="n">d24</span> <span class="o">=</span> <span class="n">pt4</span> <span class="o">-</span> <span class="n">pt2</span>
  <span class="k">if</span> <span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">norm</span><span class="p">))</span> <span class="k">then</span>
<span class="k">    </span><span class="n">fnormal</span> <span class="o">=</span> <span class="n">normalize</span><span class="p">(</span><span class="n">d13</span><span class="p">.</span><span class="n">cross</span><span class="p">.</span><span class="n">d24</span><span class="p">)</span>
  <span class="k">else</span>
<span class="k">    </span><span class="n">fnormal</span> <span class="o">=</span> <span class="mf">0.5_R8P</span> <span class="o">*</span> <span class="p">(</span><span class="n">d13</span><span class="p">.</span><span class="n">cross</span><span class="p">.</span><span class="n">d24</span><span class="p">)</span>
  <span class="n">endif</span>
  <span class="k">return</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">endfunction</span> <span class="n">face_normal4</span>

  <span class="k">elemental function </span><span class="n">face_normal3</span><span class="p">(</span><span class="n">pt1</span><span class="p">,</span> <span class="n">pt2</span><span class="p">,</span> <span class="n">pt3</span><span class="p">,</span> <span class="n">norm</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">fnormal</span><span class="p">)</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="c">!&lt; Calculate the normal of the face defined by the 3 points vector pt1, pt2 and pt3.</span>
  <span class="c">!&lt;</span>
  <span class="c">!&lt; The convention for the points numeration is the following:</span>
  <span class="c">!&lt;```</span>
  <span class="c">!&lt; 1.----.2</span>
  <span class="c">!&lt;   \   |</span>
  <span class="c">!&lt;    \  |</span>
  <span class="c">!&lt;     \ |</span>
  <span class="c">!&lt;      \|</span>
  <span class="c">!&lt;       .3</span>
  <span class="c">!&lt;```</span>
  <span class="c">!&lt; The normal is calculated by the cross product of the side s12 for the side s13: s12 x s13.</span>
  <span class="c">!&lt; The normal is normalized if the variable &#39;norm&#39; is passed (with any value).</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="k">type</span><span class="p">(</span><span class="n">Vector</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">pt1</span>     <span class="c">!&lt; First face point.</span>
  <span class="k">type</span><span class="p">(</span><span class="n">Vector</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">pt2</span>     <span class="c">!&lt; Second face point.</span>
  <span class="k">type</span><span class="p">(</span><span class="n">Vector</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">pt3</span>     <span class="c">!&lt; Third face point.</span>
  <span class="kt">character</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">norm</span>    <span class="c">!&lt; If &#39;norm&#39; is passed as argument the normal is normalized.</span>
  <span class="k">type</span><span class="p">(</span><span class="n">Vector</span><span class="p">)</span>                       <span class="kd">::</span> <span class="n">fnormal</span> <span class="c">!&lt; Face normal.</span>
  <span class="k">type</span><span class="p">(</span><span class="n">Vector</span><span class="p">)</span>                       <span class="kd">::</span> <span class="n">s12</span>     <span class="c">!&lt; Face 1-2 diagonals.</span>
  <span class="k">type</span><span class="p">(</span><span class="n">Vector</span><span class="p">)</span>                       <span class="kd">::</span> <span class="n">s13</span>     <span class="c">!&lt; Face 1-3 diagonals.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>

  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">s12</span> <span class="o">=</span> <span class="n">pt2</span> <span class="o">-</span> <span class="n">pt1</span>
  <span class="n">s13</span> <span class="o">=</span> <span class="n">pt3</span> <span class="o">-</span> <span class="n">pt1</span>
  <span class="k">if</span> <span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">norm</span><span class="p">))</span> <span class="k">then</span>
<span class="k">    </span><span class="n">fnormal</span> <span class="o">=</span> <span class="n">normalize</span><span class="p">(</span><span class="n">s12</span><span class="p">.</span><span class="n">cross</span><span class="p">.</span><span class="n">s13</span><span class="p">)</span>
  <span class="k">else</span>
<span class="k">    </span><span class="n">fnormal</span> <span class="o">=</span> <span class="mf">0.5_R8P</span> <span class="o">*</span> <span class="p">(</span><span class="n">s12</span><span class="p">.</span><span class="n">cross</span><span class="p">.</span><span class="n">s13</span><span class="p">)</span>
  <span class="n">endif</span>
  <span class="k">return</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">endfunction</span> <span class="n">face_normal3</span>

  <span class="k">elemental subroutine </span><span class="n">init_vector_self</span><span class="p">(</span><span class="n">vec</span><span class="p">)</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="c">!&lt; Initialize components of Vector variable.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="k">class</span><span class="p">(</span><span class="n">Vector</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">vec</span> <span class="c">!&lt; Vector.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>

  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">vec</span><span class="p">%</span><span class="n">x</span> <span class="o">=</span> <span class="mf">0._R8P</span>
  <span class="n">vec</span><span class="p">%</span><span class="n">y</span> <span class="o">=</span> <span class="mf">0._R8P</span>
  <span class="n">vec</span><span class="p">%</span><span class="n">z</span> <span class="o">=</span> <span class="mf">0._R8P</span>
  <span class="k">return</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">endsubroutine</span> <span class="n">init_vector_self</span>

  <span class="k">elemental subroutine </span><span class="n">set_vector_self</span><span class="p">(</span><span class="n">vec</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">)</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="c">!&lt; Set components of Vector variable.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="k">class</span><span class="p">(</span><span class="n">Vector</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span>        <span class="kd">::</span> <span class="n">vec</span> <span class="c">!&lt; Vector.</span>
  <span class="kt">real</span><span class="p">(</span><span class="n">R8P</span><span class="p">),</span>     <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">x</span>   <span class="c">!&lt; Cartesian component in x direction.</span>
  <span class="kt">real</span><span class="p">(</span><span class="n">R8P</span><span class="p">),</span>     <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">y</span>   <span class="c">!&lt; Cartesian component in y direction.</span>
  <span class="kt">real</span><span class="p">(</span><span class="n">R8P</span><span class="p">),</span>     <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">z</span>   <span class="c">!&lt; Cartesian component in z direction.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>

  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="k">if</span> <span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">x</span><span class="p">))</span> <span class="n">vec</span><span class="p">%</span><span class="n">x</span> <span class="o">=</span> <span class="n">x</span>
  <span class="k">if</span> <span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">y</span><span class="p">))</span> <span class="n">vec</span><span class="p">%</span><span class="n">y</span> <span class="o">=</span> <span class="n">y</span>
  <span class="k">if</span> <span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">z</span><span class="p">))</span> <span class="n">vec</span><span class="p">%</span><span class="n">z</span> <span class="o">=</span> <span class="n">z</span>
  <span class="k">return</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">endsubroutine</span> <span class="n">set_vector_self</span>

  <span class="k">function </span><span class="n">iolen_vector_self</span><span class="p">(</span><span class="n">vec</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">iolen</span><span class="p">)</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="c">!&lt; Compute IO length.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="k">class</span><span class="p">(</span><span class="n">Vector</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">vec</span>   <span class="c">!&lt; Vector.</span>
  <span class="kt">integer</span><span class="p">(</span><span class="n">I4P</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">iolen</span> <span class="c">!&lt; IO length.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>

  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="k">inquire</span><span class="p">(</span><span class="n">iolength</span><span class="o">=</span><span class="n">iolen</span><span class="p">)</span> <span class="n">vec</span><span class="p">%</span><span class="n">x</span><span class="p">,</span> <span class="n">vec</span><span class="p">%</span><span class="n">y</span><span class="p">,</span> <span class="n">vec</span><span class="p">%</span><span class="n">z</span>
  <span class="k">return</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">endfunction</span> <span class="n">iolen_vector_self</span>

  <span class="k">subroutine </span><span class="n">load_vector_self</span><span class="p">(</span><span class="n">vec</span><span class="p">,</span> <span class="n">unit</span><span class="p">,</span> <span class="n">pos</span><span class="p">,</span> <span class="n">iostat</span><span class="p">,</span> <span class="n">iomsg</span><span class="p">)</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="c">!&lt; Load Vector data.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="k">class</span><span class="p">(</span><span class="n">Vector</span><span class="p">),</span>          <span class="k">intent</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">vec</span>     <span class="c">!&lt; Vector data.</span>
  <span class="kt">integer</span><span class="p">(</span><span class="n">I4P</span><span class="p">),</span>           <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">unit</span>    <span class="c">!&lt; Logic unit.</span>
  <span class="kt">integer</span><span class="p">(</span><span class="n">I8P</span><span class="p">),</span> <span class="k">optional</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">pos</span>     <span class="c">!&lt; Position specifier.</span>
  <span class="kt">integer</span><span class="p">(</span><span class="n">I4P</span><span class="p">),</span> <span class="k">optional</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">iostat</span>  <span class="c">!&lt; IO error.</span>
  <span class="kt">character</span><span class="p">(</span><span class="o">*</span><span class="p">),</span> <span class="k">optional</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">iomsg</span>   <span class="c">!&lt; IO error message.</span>
  <span class="kt">integer</span><span class="p">(</span><span class="n">I4P</span><span class="p">)</span>                          <span class="kd">::</span> <span class="n">iostatd</span> <span class="c">!&lt; IO error.</span>
  <span class="kt">character</span><span class="p">(</span><span class="mi">500</span><span class="p">)</span>                        <span class="kd">::</span> <span class="n">iomsgd</span>  <span class="c">!&lt; Temporary variable for IO error message.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>

  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="k">if</span> <span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">pos</span><span class="p">))</span> <span class="k">then</span>
<span class="k">    read</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">unit</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="n">pos</span><span class="p">,</span> <span class="n">iostat</span><span class="o">=</span><span class="n">iostatd</span><span class="p">,</span> <span class="n">iomsg</span><span class="o">=</span><span class="n">iomsgd</span><span class="p">)</span><span class="n">vec</span><span class="p">%</span><span class="n">x</span><span class="p">,</span> <span class="n">vec</span><span class="p">%</span><span class="n">y</span><span class="p">,</span> <span class="n">vec</span><span class="p">%</span><span class="n">z</span>
  <span class="k">else</span>
<span class="k">    read</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">unit</span><span class="p">,</span>          <span class="n">iostat</span><span class="o">=</span><span class="n">iostatd</span><span class="p">,</span> <span class="n">iomsg</span><span class="o">=</span><span class="n">iomsgd</span><span class="p">)</span><span class="n">vec</span><span class="p">%</span><span class="n">x</span><span class="p">,</span> <span class="n">vec</span><span class="p">%</span><span class="n">y</span><span class="p">,</span> <span class="n">vec</span><span class="p">%</span><span class="n">z</span>
  <span class="n">endif</span>
  <span class="k">if</span> <span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">iostat</span><span class="p">))</span> <span class="n">iostat</span> <span class="o">=</span> <span class="n">iostatd</span>
  <span class="k">if</span> <span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">iomsg</span><span class="p">))</span>  <span class="n">iomsg</span>  <span class="o">=</span> <span class="nb">trim</span><span class="p">(</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">iomsgd</span><span class="p">))</span>
  <span class="k">return</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">endsubroutine</span> <span class="n">load_vector_self</span>

  <span class="k">subroutine </span><span class="n">save_vector_self</span><span class="p">(</span><span class="n">vec</span><span class="p">,</span> <span class="n">unit</span><span class="p">,</span> <span class="n">pos</span><span class="p">,</span> <span class="n">iostat</span><span class="p">,</span> <span class="n">iomsg</span><span class="p">)</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="c">!&lt; Save Vector data.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="k">class</span><span class="p">(</span><span class="n">Vector</span><span class="p">),</span>          <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">vec</span>     <span class="c">!&lt; Vector data.</span>
  <span class="kt">integer</span><span class="p">(</span><span class="n">I4P</span><span class="p">),</span>           <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">unit</span>    <span class="c">!&lt; Logic unit.</span>
  <span class="kt">integer</span><span class="p">(</span><span class="n">I8P</span><span class="p">),</span> <span class="k">optional</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">pos</span>     <span class="c">!&lt; Position specifier.</span>
  <span class="kt">integer</span><span class="p">(</span><span class="n">I4P</span><span class="p">),</span> <span class="k">optional</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">iostat</span>  <span class="c">!&lt; IO error.</span>
  <span class="kt">character</span><span class="p">(</span><span class="o">*</span><span class="p">),</span> <span class="k">optional</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">iomsg</span>   <span class="c">!&lt; IO error message.</span>
  <span class="kt">integer</span><span class="p">(</span><span class="n">I4P</span><span class="p">)</span>                        <span class="kd">::</span> <span class="n">iostatd</span> <span class="c">!&lt; IO error.</span>
  <span class="kt">character</span><span class="p">(</span><span class="mi">500</span><span class="p">)</span>                      <span class="kd">::</span> <span class="n">iomsgd</span>  <span class="c">!&lt; Temporary variable for IO error message.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>

  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="k">if</span> <span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">pos</span><span class="p">))</span> <span class="k">then</span>
<span class="k">    write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">unit</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="n">pos</span><span class="p">,</span> <span class="n">iostat</span><span class="o">=</span><span class="n">iostatd</span><span class="p">,</span> <span class="n">iomsg</span><span class="o">=</span><span class="n">iomsgd</span><span class="p">)</span><span class="n">vec</span><span class="p">%</span><span class="n">x</span><span class="p">,</span> <span class="n">vec</span><span class="p">%</span><span class="n">y</span><span class="p">,</span> <span class="n">vec</span><span class="p">%</span><span class="n">z</span>
  <span class="k">else</span>
<span class="k">    write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">unit</span><span class="p">,</span>          <span class="n">iostat</span><span class="o">=</span><span class="n">iostatd</span><span class="p">,</span> <span class="n">iomsg</span><span class="o">=</span><span class="n">iomsgd</span><span class="p">)</span><span class="n">vec</span><span class="p">%</span><span class="n">x</span><span class="p">,</span> <span class="n">vec</span><span class="p">%</span><span class="n">y</span><span class="p">,</span> <span class="n">vec</span><span class="p">%</span><span class="n">z</span>
  <span class="n">endif</span>
  <span class="k">if</span> <span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">iostat</span><span class="p">))</span> <span class="n">iostat</span> <span class="o">=</span> <span class="n">iostatd</span>
  <span class="k">if</span> <span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">iomsg</span><span class="p">))</span>  <span class="n">iomsg</span>  <span class="o">=</span> <span class="nb">trim</span><span class="p">(</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">iomsgd</span><span class="p">))</span>
  <span class="k">return</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">endsubroutine</span> <span class="n">save_vector_self</span>

  <span class="k">subroutine </span><span class="n">print_vector_self</span><span class="p">(</span><span class="n">vec</span><span class="p">,</span> <span class="n">unit</span><span class="p">,</span> <span class="n">pref</span><span class="p">,</span> <span class="n">iostat</span><span class="p">,</span> <span class="n">iomsg</span><span class="p">)</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="c">!&lt; Print in a pretty ascii format the components of type Vector.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="k">class</span><span class="p">(</span><span class="n">Vector</span><span class="p">),</span>          <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">vec</span>     <span class="c">!&lt; Vector.</span>
  <span class="kt">integer</span><span class="p">(</span><span class="n">I4P</span><span class="p">),</span> <span class="k">optional</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">unit</span>    <span class="c">!&lt; Logic unit.</span>
  <span class="kt">character</span><span class="p">(</span><span class="o">*</span><span class="p">),</span> <span class="k">optional</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">pref</span>    <span class="c">!&lt; Prefixing string for outputs.</span>
  <span class="kt">integer</span><span class="p">(</span><span class="n">I4P</span><span class="p">),</span> <span class="k">optional</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">iostat</span>  <span class="c">!&lt; IO error.</span>
  <span class="kt">character</span><span class="p">(</span><span class="o">*</span><span class="p">),</span> <span class="k">optional</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">iomsg</span>   <span class="c">!&lt; IO error message.</span>
  <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="p">:),</span> <span class="k">allocatable</span>       <span class="kd">::</span> <span class="n">prefd</span>   <span class="c">!&lt; Prefixing string.</span>
  <span class="kt">integer</span><span class="p">(</span><span class="n">I4P</span><span class="p">)</span>                        <span class="kd">::</span> <span class="n">unitd</span>   <span class="c">!&lt; Logic unit.</span>
  <span class="kt">integer</span><span class="p">(</span><span class="n">I4P</span><span class="p">)</span>                        <span class="kd">::</span> <span class="n">iostatd</span> <span class="c">!&lt; IO error.</span>
  <span class="kt">character</span><span class="p">(</span><span class="mi">500</span><span class="p">)</span>                      <span class="kd">::</span> <span class="n">iomsgd</span>  <span class="c">!&lt; Temporary variable for IO error message.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>

  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">unitd</span> <span class="o">=</span> <span class="n">stdout</span> <span class="p">;</span> <span class="k">if</span> <span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">unit</span><span class="p">))</span> <span class="n">unitd</span> <span class="o">=</span> <span class="n">unit</span>
  <span class="n">prefd</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span> <span class="p">;</span> <span class="k">if</span> <span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">pref</span><span class="p">))</span> <span class="n">prefd</span> <span class="o">=</span> <span class="n">pref</span>
  <span class="k">write</span><span class="p">(</span><span class="n">unitd</span><span class="p">,</span> <span class="s1">&#39;(A)&#39;</span><span class="p">,</span> <span class="n">iostat</span><span class="o">=</span><span class="n">iostatd</span><span class="p">,</span> <span class="n">iomsg</span><span class="o">=</span><span class="n">iomsgd</span><span class="p">)</span><span class="n">pref</span><span class="o">//</span><span class="s1">&#39; Component x &#39;</span><span class="o">//</span><span class="n">str</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="n">vec</span><span class="p">%</span><span class="n">x</span><span class="p">)</span>
  <span class="k">write</span><span class="p">(</span><span class="n">unitd</span><span class="p">,</span> <span class="s1">&#39;(A)&#39;</span><span class="p">,</span> <span class="n">iostat</span><span class="o">=</span><span class="n">iostatd</span><span class="p">,</span> <span class="n">iomsg</span><span class="o">=</span><span class="n">iomsgd</span><span class="p">)</span><span class="n">pref</span><span class="o">//</span><span class="s1">&#39; Component y &#39;</span><span class="o">//</span><span class="n">str</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="n">vec</span><span class="p">%</span><span class="n">y</span><span class="p">)</span>
  <span class="k">write</span><span class="p">(</span><span class="n">unitd</span><span class="p">,</span> <span class="s1">&#39;(A)&#39;</span><span class="p">,</span> <span class="n">iostat</span><span class="o">=</span><span class="n">iostatd</span><span class="p">,</span> <span class="n">iomsg</span><span class="o">=</span><span class="n">iomsgd</span><span class="p">)</span><span class="n">pref</span><span class="o">//</span><span class="s1">&#39; Component z &#39;</span><span class="o">//</span><span class="n">str</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="n">vec</span><span class="p">%</span><span class="n">z</span><span class="p">)</span>
  <span class="k">if</span> <span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">iostat</span><span class="p">))</span> <span class="n">iostat</span> <span class="o">=</span> <span class="n">iostatd</span>
  <span class="k">if</span> <span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">iomsg</span><span class="p">))</span>  <span class="n">iomsg</span>  <span class="o">=</span> <span class="nb">trim</span><span class="p">(</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">iomsgd</span><span class="p">))</span>
  <span class="k">return</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="k">contains</span>
<span class="k">    elemental function </span><span class="n">str</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">str_</span><span class="p">)</span>
    <span class="c">!-------------------------------------------------------------------------------------------------------------------------------</span>
    <span class="c">!&lt; Procedure for converting real to string. This function achieves casting of real to string.</span>
    <span class="c">!-------------------------------------------------------------------------------------------------------------------------------</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">R8P</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">n</span>    <span class="c">!&lt; Real to be converted.</span>
    <span class="kt">character</span><span class="p">(</span><span class="n">DR8P</span><span class="p">)</span>       <span class="kd">::</span> <span class="n">str_</span> <span class="c">!&lt; Returned string containing input number.</span>
    <span class="c">!-------------------------------------------------------------------------------------------------------------------------------</span>

    <span class="c">!-------------------------------------------------------------------------------------------------------------------------------</span>
    <span class="k">write</span><span class="p">(</span><span class="n">str_</span><span class="p">,</span><span class="n">FR8P</span><span class="p">)</span> <span class="n">n</span>          <span class="c">! Casting of n to string.</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">n</span><span class="o">&gt;</span><span class="mf">0._R8P</span><span class="p">)</span> <span class="n">str_</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="s1">&#39;+&#39;</span> <span class="c">! Prefixing plus if n&gt;0.</span>
    <span class="k">return</span>
    <span class="c">!-------------------------------------------------------------------------------------------------------------------------------</span>
    <span class="n">endfunction</span> <span class="n">str</span>
  <span class="n">endsubroutine</span> <span class="n">print_vector_self</span>

  <span class="k">elemental subroutine </span><span class="n">normalize_self</span><span class="p">(</span><span class="n">vec</span><span class="p">)</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="c">!&lt; Normalize a vector.</span>
  <span class="c">!&lt;</span>
  <span class="c">!&lt; The normalization is made by means of norm L2. If the norm L2 of the vector is less than the parameter smallR8P the</span>
  <span class="c">!&lt; normalization value is set to normL2(vec)+smallR8P.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="k">class</span><span class="p">(</span><span class="n">Vector</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">vec</span> <span class="c">!&lt; Vector to be normalized.</span>
  <span class="kt">real</span><span class="p">(</span><span class="n">R8P</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">nm</span>  <span class="c">!&lt; Norm L2 of vector.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>

  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">nm</span> <span class="o">=</span> <span class="n">normL2</span><span class="p">(</span><span class="n">vec</span><span class="p">)</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">nm</span> <span class="o">&lt;</span> <span class="n">smallR8P</span><span class="p">)</span> <span class="k">then</span>
<span class="k">    </span><span class="n">nm</span> <span class="o">=</span> <span class="n">nm</span> <span class="o">+</span> <span class="n">smallR8P</span>
  <span class="n">endif</span>
  <span class="n">vec</span><span class="p">%</span><span class="n">x</span> <span class="o">=</span> <span class="n">vec</span><span class="p">%</span><span class="n">x</span> <span class="o">/</span> <span class="n">nm</span>
  <span class="n">vec</span><span class="p">%</span><span class="n">y</span> <span class="o">=</span> <span class="n">vec</span><span class="p">%</span><span class="n">y</span> <span class="o">/</span> <span class="n">nm</span>
  <span class="n">vec</span><span class="p">%</span><span class="n">z</span> <span class="o">=</span> <span class="n">vec</span><span class="p">%</span><span class="n">z</span> <span class="o">/</span> <span class="n">nm</span>
  <span class="k">return</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">endsubroutine</span> <span class="n">normalize_self</span>

  <span class="k">elemental function </span><span class="n">normalized_self</span><span class="p">(</span><span class="n">vec</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">norm</span><span class="p">)</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="c">!&lt; Get a normalized copy of a vector.</span>
  <span class="c">!&lt;</span>
  <span class="c">!&lt; The normalization is made by means of norm L2. If the norm L2 of the vector is less than the parameter smallR8P the</span>
  <span class="c">!&lt; normalization value is set to normL2(vec)+smallR8P.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="k">class</span><span class="p">(</span><span class="n">Vector</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">vec</span>  <span class="c">!&lt; Vector to be normalized.</span>
  <span class="k">type</span><span class="p">(</span><span class="n">Vector</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">norm</span> <span class="c">!&lt; Normalized copy.</span>
  <span class="kt">real</span><span class="p">(</span><span class="n">R8P</span><span class="p">)</span>                 <span class="kd">::</span> <span class="n">nm</span>   <span class="c">!&lt; Norm L2 of vector.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>

  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">nm</span> <span class="o">=</span> <span class="n">normL2</span><span class="p">(</span><span class="n">vec</span><span class="p">)</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">nm</span> <span class="o">&lt;</span> <span class="n">smallR8P</span><span class="p">)</span> <span class="k">then</span>
<span class="k">    </span><span class="n">nm</span> <span class="o">=</span> <span class="n">nm</span> <span class="o">+</span> <span class="n">smallR8P</span>
  <span class="n">endif</span>
  <span class="n">norm</span><span class="p">%</span><span class="n">x</span> <span class="o">=</span> <span class="n">vec</span><span class="p">%</span><span class="n">x</span> <span class="o">/</span> <span class="n">nm</span>
  <span class="n">norm</span><span class="p">%</span><span class="n">y</span> <span class="o">=</span> <span class="n">vec</span><span class="p">%</span><span class="n">y</span> <span class="o">/</span> <span class="n">nm</span>
  <span class="n">norm</span><span class="p">%</span><span class="n">z</span> <span class="o">=</span> <span class="n">vec</span><span class="p">%</span><span class="n">z</span> <span class="o">/</span> <span class="n">nm</span>
  <span class="k">return</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">endfunction</span> <span class="n">normalized_self</span>

  <span class="k">elemental function </span><span class="n">sq_norm_self</span><span class="p">(</span><span class="n">vec</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">sq</span><span class="p">)</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="c">!&lt; Compute the square of the norm of a vector.</span>
  <span class="c">!&lt;</span>
  <span class="c">!&lt; The square norm if defined as \( N = x^2  + y^2  + z^2 \).</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="k">class</span><span class="p">(</span><span class="n">Vector</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">vec</span> <span class="c">!&lt; Vector.</span>
  <span class="kt">real</span><span class="p">(</span><span class="n">R8P</span><span class="p">)</span>                 <span class="kd">::</span> <span class="n">sq</span>  <span class="c">!&lt; Square of the Norm.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>

  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">sq</span> <span class="o">=</span> <span class="p">(</span><span class="n">vec</span><span class="p">%</span><span class="n">x</span> <span class="o">*</span> <span class="n">vec</span><span class="p">%</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">vec</span><span class="p">%</span><span class="n">y</span> <span class="o">*</span> <span class="n">vec</span><span class="p">%</span><span class="n">y</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">vec</span><span class="p">%</span><span class="n">z</span> <span class="o">*</span> <span class="n">vec</span><span class="p">%</span><span class="n">z</span><span class="p">)</span>
  <span class="k">return</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">endfunction</span> <span class="n">sq_norm_self</span>

  <span class="k">elemental function </span><span class="n">normL2_self</span><span class="p">(</span><span class="n">vec</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">norm</span><span class="p">)</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="c">!&lt; Compute the norm L2 of a vector.</span>
  <span class="c">!&lt;</span>
  <span class="c">!&lt; The norm L2 if defined as \( N = \sqrt {x^2  + y^2  + z^2 } \).</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="k">class</span><span class="p">(</span><span class="n">Vector</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">vec</span>  <span class="c">!&lt; Vector.</span>
  <span class="kt">real</span><span class="p">(</span><span class="n">R8P</span><span class="p">)</span>                 <span class="kd">::</span> <span class="n">norm</span> <span class="c">!&lt; Norm L2.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>

  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">norm</span> <span class="o">=</span> <span class="nb">sqrt</span><span class="p">((</span><span class="n">vec</span><span class="p">%</span><span class="n">x</span> <span class="o">*</span> <span class="n">vec</span><span class="p">%</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">vec</span><span class="p">%</span><span class="n">y</span> <span class="o">*</span> <span class="n">vec</span><span class="p">%</span><span class="n">y</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">vec</span><span class="p">%</span><span class="n">z</span> <span class="o">*</span> <span class="n">vec</span><span class="p">%</span><span class="n">z</span><span class="p">))</span>
  <span class="k">return</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">endfunction</span> <span class="n">normL2_self</span>

  <span class="k">elemental subroutine </span><span class="n">face_normal4_self</span><span class="p">(</span><span class="n">fnormal</span><span class="p">,</span> <span class="n">pt1</span><span class="p">,</span> <span class="n">pt2</span><span class="p">,</span> <span class="n">pt3</span><span class="p">,</span> <span class="n">pt4</span><span class="p">,</span> <span class="n">norm</span><span class="p">)</span>
  <span class="c">!&lt; Calculate the normal of the face defined by 4 points vector pt1, pt2, pt3 and pt4.</span>
  <span class="c">!&lt;</span>
  <span class="c">!&lt; The convention for the points numeration is the following:</span>
  <span class="c">!&lt;```</span>
  <span class="c">!&lt; 1.----------.2</span>
  <span class="c">!&lt;  |          |</span>
  <span class="c">!&lt;  |          |</span>
  <span class="c">!&lt;  |          |</span>
  <span class="c">!&lt;  |          |</span>
  <span class="c">!&lt; 4.----------.3</span>
  <span class="c">!&lt;```</span>
  <span class="c">!&lt; The normal is calculated by the cross product of the diagonal d13 for the diagonal d24: d13 x d24.</span>
  <span class="c">!&lt; The normal is normalized if the variable *norm* is passed (with any value).</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="k">class</span><span class="p">(</span><span class="n">Vector</span><span class="p">),</span>          <span class="k">intent</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">fnormal</span> <span class="c">!&lt; Face normal.</span>
  <span class="k">type</span><span class="p">(</span><span class="n">Vector</span><span class="p">),</span>           <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">pt1</span>     <span class="c">!&lt; First face point.</span>
  <span class="k">type</span><span class="p">(</span><span class="n">Vector</span><span class="p">),</span>           <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">pt2</span>     <span class="c">!&lt; Second face point.</span>
  <span class="k">type</span><span class="p">(</span><span class="n">Vector</span><span class="p">),</span>           <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">pt3</span>     <span class="c">!&lt; Third face point.</span>
  <span class="k">type</span><span class="p">(</span><span class="n">Vector</span><span class="p">),</span>           <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">pt4</span>     <span class="c">!&lt; Fourth face point.</span>
  <span class="kt">character</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="k">optional</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">norm</span>    <span class="c">!&lt; If &#39;norm&#39; is passed as argument the normal is normalized.</span>
  <span class="k">type</span><span class="p">(</span><span class="n">Vector</span><span class="p">)</span>                          <span class="kd">::</span> <span class="n">d13</span>     <span class="c">!&lt; Face 1-3 diagonals.</span>
  <span class="k">type</span><span class="p">(</span><span class="n">Vector</span><span class="p">)</span>                          <span class="kd">::</span> <span class="n">d24</span>     <span class="c">!&lt; Face 2-4 diagonals.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>

  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">d13</span> <span class="o">=</span> <span class="n">pt3</span> <span class="o">-</span> <span class="n">pt1</span>
  <span class="n">d24</span> <span class="o">=</span> <span class="n">pt4</span> <span class="o">-</span> <span class="n">pt2</span>
  <span class="k">if</span> <span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">norm</span><span class="p">))</span> <span class="k">then</span>
<span class="k">    </span><span class="n">fnormal</span> <span class="o">=</span> <span class="n">normalize</span><span class="p">(</span><span class="n">d13</span><span class="p">.</span><span class="n">cross</span><span class="p">.</span><span class="n">d24</span><span class="p">)</span>
  <span class="k">else</span>
<span class="k">    </span><span class="n">fnormal</span> <span class="o">=</span> <span class="mf">0.5_R8P</span> <span class="o">*</span> <span class="p">(</span><span class="n">d13</span><span class="p">.</span><span class="n">cross</span><span class="p">.</span><span class="n">d24</span><span class="p">)</span>
  <span class="n">endif</span>
  <span class="k">return</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">endsubroutine</span> <span class="n">face_normal4_self</span>

  <span class="k">elemental subroutine </span><span class="n">face_normal3_self</span><span class="p">(</span><span class="n">fnormal</span><span class="p">,</span> <span class="n">pt1</span><span class="p">,</span> <span class="n">pt2</span><span class="p">,</span> <span class="n">pt3</span><span class="p">,</span> <span class="n">norm</span><span class="p">)</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="c">!&lt; Calculate the normal of the face defined by the 3 points vector pt1, pt2 and pt3.</span>
  <span class="c">!&lt;</span>
  <span class="c">!&lt; The convention for the points numeration is the following:</span>
  <span class="c">!&lt;```</span>
  <span class="c">!&lt; 1.----.2</span>
  <span class="c">!&lt;   \   |</span>
  <span class="c">!&lt;    \  |</span>
  <span class="c">!&lt;     \ |</span>
  <span class="c">!&lt;      \|</span>
  <span class="c">!&lt;       .3</span>
  <span class="c">!&lt;```</span>
  <span class="c">!&lt; The normal is calculated by the cross product of the side s12 for the side s13: s12 x s13.</span>
  <span class="c">!&lt; The normal is normalized if the variable *norm* is passed (with any value).</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="k">class</span><span class="p">(</span><span class="n">Vector</span><span class="p">),</span>          <span class="k">intent</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">fnormal</span> <span class="c">!&lt; Face normal.</span>
  <span class="k">type</span><span class="p">(</span><span class="n">Vector</span><span class="p">),</span>           <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">pt1</span>     <span class="c">!&lt; First face point.</span>
  <span class="k">type</span><span class="p">(</span><span class="n">Vector</span><span class="p">),</span>           <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">pt2</span>     <span class="c">!&lt; Second face point.</span>
  <span class="k">type</span><span class="p">(</span><span class="n">Vector</span><span class="p">),</span>           <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">pt3</span>     <span class="c">!&lt; Third face point.</span>
  <span class="kt">character</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="k">optional</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">norm</span>    <span class="c">!&lt; If &#39;norm&#39; is passed as argument the normal is normalized.</span>
  <span class="k">type</span><span class="p">(</span><span class="n">Vector</span><span class="p">)</span>                          <span class="kd">::</span> <span class="n">s12</span>     <span class="c">!&lt; Face 1-2 diagonals.</span>
  <span class="k">type</span><span class="p">(</span><span class="n">Vector</span><span class="p">)</span>                          <span class="kd">::</span> <span class="n">s13</span>     <span class="c">!&lt; Face 1-3 diagonals.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>

  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">s12</span> <span class="o">=</span> <span class="n">pt2</span> <span class="o">-</span> <span class="n">pt1</span>
  <span class="n">s13</span> <span class="o">=</span> <span class="n">pt3</span> <span class="o">-</span> <span class="n">pt1</span>
  <span class="k">if</span> <span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">norm</span><span class="p">))</span> <span class="k">then</span>
<span class="k">    </span><span class="n">fnormal</span> <span class="o">=</span> <span class="n">normalize</span><span class="p">(</span><span class="n">s12</span><span class="p">.</span><span class="n">cross</span><span class="p">.</span><span class="n">s13</span><span class="p">)</span>
  <span class="k">else</span>
<span class="k">    </span><span class="n">fnormal</span> <span class="o">=</span> <span class="mf">0.5_R8P</span> <span class="o">*</span> <span class="p">(</span><span class="n">s12</span><span class="p">.</span><span class="n">cross</span><span class="p">.</span><span class="n">s13</span><span class="p">)</span>
  <span class="n">endif</span>
  <span class="k">return</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">endsubroutine</span> <span class="n">face_normal3_self</span>

  <span class="k">elemental function </span><span class="n">crossproduct</span><span class="p">(</span><span class="n">vec1</span><span class="p">,</span> <span class="n">vec2</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">cross</span><span class="p">)</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="c">!&lt; Compute the cross product of 2 vectors.</span>
  <span class="c">!&lt;</span>
  <span class="c">!&lt; $$ \vec V=\left({y_1 z_2 - z_1 y_2}\right)\vec i +</span>
  <span class="c">!&lt;           \left({z_1 x_2 - x_1 z_2}\right)\vec j +</span>
  <span class="c">!&lt;           \left({x_1 y_2 - y_1 x_2}\right)\vec k $$</span>
  <span class="c">!&lt; where \( x_i \), \( y_i \) and \( z_i \) \( i=1,2 \) are the components of the vectors.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="k">class</span><span class="p">(</span><span class="n">Vector</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">vec1</span>  <span class="c">!&lt; First vector.</span>
  <span class="k">type</span><span class="p">(</span><span class="n">Vector</span><span class="p">),</span>  <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">vec2</span>  <span class="c">!&lt; Second vector.</span>
  <span class="k">type</span><span class="p">(</span><span class="n">Vector</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">cross</span> <span class="c">!&lt; Cross product vector.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>

  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">cross</span><span class="p">%</span><span class="n">x</span> <span class="o">=</span> <span class="p">(</span><span class="n">vec1</span><span class="p">%</span><span class="n">y</span> <span class="o">*</span> <span class="n">vec2</span><span class="p">%</span><span class="n">z</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="n">vec1</span><span class="p">%</span><span class="n">z</span> <span class="o">*</span> <span class="n">vec2</span><span class="p">%</span><span class="n">y</span><span class="p">)</span>
  <span class="n">cross</span><span class="p">%</span><span class="n">y</span> <span class="o">=</span> <span class="p">(</span><span class="n">vec1</span><span class="p">%</span><span class="n">z</span> <span class="o">*</span> <span class="n">vec2</span><span class="p">%</span><span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="n">vec1</span><span class="p">%</span><span class="n">x</span> <span class="o">*</span> <span class="n">vec2</span><span class="p">%</span><span class="n">z</span><span class="p">)</span>
  <span class="n">cross</span><span class="p">%</span><span class="n">z</span> <span class="o">=</span> <span class="p">(</span><span class="n">vec1</span><span class="p">%</span><span class="n">x</span> <span class="o">*</span> <span class="n">vec2</span><span class="p">%</span><span class="n">y</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="n">vec1</span><span class="p">%</span><span class="n">y</span> <span class="o">*</span> <span class="n">vec2</span><span class="p">%</span><span class="n">x</span><span class="p">)</span>
  <span class="k">return</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">endfunction</span> <span class="n">crossproduct</span>

  <span class="k">elemental function </span><span class="n">dotproduct</span><span class="p">(</span><span class="n">vec1</span><span class="p">,</span> <span class="n">vec2</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">dot</span><span class="p">)</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="c">!&lt; Compute the scalar (dot) product of 2 vectors.</span>
  <span class="c">!&lt;</span>
  <span class="c">!&lt; $$ {\rm D}= x_1 \cdot x_2 + y_1 \cdot y_2 + z_1 \cdot z_2 $$</span>
  <span class="c">!&lt; where \( x_i \), \( y_i \) and \( z_i \) \( i=1,2 \) are the components of the vectors.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="k">class</span><span class="p">(</span><span class="n">Vector</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">vec1</span> <span class="c">!&lt; First vector.</span>
  <span class="k">type</span><span class="p">(</span><span class="n">Vector</span><span class="p">),</span>  <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">vec2</span> <span class="c">!&lt; Second vector.</span>
  <span class="kt">real</span><span class="p">(</span><span class="n">R8P</span><span class="p">)</span>                 <span class="kd">::</span> <span class="n">dot</span>  <span class="c">!&lt; Dot product.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>

  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">dot</span> <span class="o">=</span> <span class="p">(</span><span class="n">vec1</span><span class="p">%</span><span class="n">x</span> <span class="o">*</span> <span class="n">vec2</span><span class="p">%</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">vec1</span><span class="p">%</span><span class="n">y</span> <span class="o">*</span> <span class="n">vec2</span><span class="p">%</span><span class="n">y</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">vec1</span><span class="p">%</span><span class="n">z</span> <span class="o">*</span> <span class="n">vec2</span><span class="p">%</span><span class="n">z</span><span class="p">)</span>
  <span class="k">return</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">endfunction</span> <span class="n">dotproduct</span>

  <span class="k">elemental function </span><span class="n">parallel</span><span class="p">(</span><span class="n">vec1</span><span class="p">,</span> <span class="n">vec2</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">paral</span><span class="p">)</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="c">!&gt; Compute the component of vec1 parallel to vec2.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="k">class</span><span class="p">(</span><span class="n">Vector</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">vec1</span>  <span class="c">!&lt; First vector.</span>
  <span class="k">type</span><span class="p">(</span><span class="n">Vector</span><span class="p">),</span>  <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">vec2</span>  <span class="c">!&lt; Second vector.</span>
  <span class="k">type</span><span class="p">(</span><span class="n">Vector</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">paral</span> <span class="c">!&lt; Component of of vec1 parallel to vec2.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>

  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">paral</span> <span class="o">=</span> <span class="p">(</span><span class="n">vec1</span><span class="p">.</span><span class="n">dot</span><span class="p">.</span><span class="n">vec2</span><span class="p">)</span> <span class="o">*</span> <span class="n">normalize</span><span class="p">(</span><span class="n">vec2</span><span class="p">)</span><span class="o">/</span><span class="n">normL2</span><span class="p">(</span><span class="n">vec2</span><span class="p">)</span>
  <span class="k">return</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">endfunction</span> <span class="n">parallel</span>

  <span class="k">elemental function </span><span class="n">orthogonal</span><span class="p">(</span><span class="n">vec1</span><span class="p">,</span> <span class="n">vec2</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">ortho</span><span class="p">)</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="c">!&lt; Compute the component of vec1 orthogonal to vec2.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="k">class</span><span class="p">(</span><span class="n">Vector</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">vec1</span>  <span class="c">!&lt; First vector.</span>
  <span class="k">type</span><span class="p">(</span><span class="n">Vector</span><span class="p">),</span>  <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">vec2</span>  <span class="c">!&lt; Second vector.</span>
  <span class="k">type</span><span class="p">(</span><span class="n">Vector</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">ortho</span> <span class="c">!&lt; Component of of vec1 orthogonal to vec2.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>

  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">ortho</span> <span class="o">=</span> <span class="n">vec1</span> <span class="o">-</span> <span class="p">(</span><span class="n">vec1</span><span class="p">.</span><span class="n">paral</span><span class="p">.</span><span class="n">vec2</span><span class="p">)</span>
  <span class="k">return</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">endfunction</span> <span class="n">orthogonal</span>

  <span class="c">! Operators overloading.</span>
  <span class="c">! Operator (=)</span>
  <span class="k">pure subroutine </span><span class="n">assign_self</span><span class="p">(</span><span class="n">self1</span><span class="p">,</span> <span class="n">self2</span><span class="p">)</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="c">!&lt; Assignment between two selfs.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="k">class</span><span class="p">(</span><span class="n">Vector</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">self1</span>
  <span class="k">class</span><span class="p">(</span><span class="n">Vector</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">self2</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>

  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">self1</span><span class="p">%</span><span class="n">x</span> <span class="o">=</span> <span class="n">self2</span><span class="p">%</span><span class="n">x</span>
  <span class="n">self1</span><span class="p">%</span><span class="n">y</span> <span class="o">=</span> <span class="n">self2</span><span class="p">%</span><span class="n">y</span>
  <span class="n">self1</span><span class="p">%</span><span class="n">z</span> <span class="o">=</span> <span class="n">self2</span><span class="p">%</span><span class="n">z</span>
  <span class="k">return</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">endsubroutine</span> <span class="n">assign_self</span>

  <span class="k">elemental subroutine </span><span class="n">assign_ScalR16P</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">scal</span><span class="p">)</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="c">!&lt; Assignment between a scalar (real R16P) and self.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="k">class</span><span class="p">(</span><span class="n">Vector</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">self</span>
  <span class="kt">real</span><span class="p">(</span><span class="n">R16P</span><span class="p">),</span>    <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">scal</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>

  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">self</span><span class="p">%</span><span class="n">x</span> <span class="o">=</span> <span class="kt">real</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">R8P</span><span class="p">)</span>
  <span class="n">self</span><span class="p">%</span><span class="n">y</span> <span class="o">=</span> <span class="kt">real</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">R8P</span><span class="p">)</span>
  <span class="n">self</span><span class="p">%</span><span class="n">z</span> <span class="o">=</span> <span class="kt">real</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">R8P</span><span class="p">)</span>
  <span class="k">return</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">endsubroutine</span> <span class="n">assign_ScalR16P</span>

  <span class="k">elemental subroutine </span><span class="n">assign_ScalR8P</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">scal</span><span class="p">)</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="c">!&lt; Assignment between a scalar (real R8P) and self.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="k">implicit none</span>
<span class="k">  class</span><span class="p">(</span><span class="n">Vector</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">self</span>
  <span class="kt">real</span><span class="p">(</span><span class="n">R8P</span><span class="p">),</span>     <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">scal</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>

  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">self</span><span class="p">%</span><span class="n">x</span> <span class="o">=</span> <span class="kt">real</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">R8P</span><span class="p">)</span>
  <span class="n">self</span><span class="p">%</span><span class="n">y</span> <span class="o">=</span> <span class="kt">real</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">R8P</span><span class="p">)</span>
  <span class="n">self</span><span class="p">%</span><span class="n">z</span> <span class="o">=</span> <span class="kt">real</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">R8P</span><span class="p">)</span>
  <span class="k">return</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">endsubroutine</span> <span class="n">assign_ScalR8P</span>

  <span class="k">elemental subroutine </span><span class="n">assign_ScalR4P</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">scal</span><span class="p">)</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="c">!&lt; Assignment between a scalar (real R4P) and self.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="k">class</span><span class="p">(</span><span class="n">Vector</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">self</span>
  <span class="kt">real</span><span class="p">(</span><span class="n">R4P</span><span class="p">),</span>     <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">scal</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>

  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">self</span><span class="p">%</span><span class="n">x</span> <span class="o">=</span> <span class="kt">real</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">R8P</span><span class="p">)</span>
  <span class="n">self</span><span class="p">%</span><span class="n">y</span> <span class="o">=</span> <span class="kt">real</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">R8P</span><span class="p">)</span>
  <span class="n">self</span><span class="p">%</span><span class="n">z</span> <span class="o">=</span> <span class="kt">real</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">R8P</span><span class="p">)</span>
  <span class="k">return</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">endsubroutine</span> <span class="n">assign_ScalR4P</span>

  <span class="k">elemental subroutine </span><span class="n">assign_ScalI8P</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">scal</span><span class="p">)</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="c">!&lt; Assignment between a scalar (integer I8P) and self.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="k">class</span><span class="p">(</span><span class="n">Vector</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">self</span>
  <span class="kt">integer</span><span class="p">(</span><span class="n">I8P</span><span class="p">),</span>  <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">scal</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>

  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">self</span><span class="p">%</span><span class="n">x</span> <span class="o">=</span> <span class="kt">real</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">R8P</span><span class="p">)</span>
  <span class="n">self</span><span class="p">%</span><span class="n">y</span> <span class="o">=</span> <span class="kt">real</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">R8P</span><span class="p">)</span>
  <span class="n">self</span><span class="p">%</span><span class="n">z</span> <span class="o">=</span> <span class="kt">real</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">R8P</span><span class="p">)</span>
  <span class="k">return</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">endsubroutine</span> <span class="n">assign_ScalI8P</span>

  <span class="k">elemental subroutine </span><span class="n">assign_ScalI4P</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">scal</span><span class="p">)</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="c">!&lt; Assignment between a scalar (integer I4P) and self.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="k">class</span><span class="p">(</span><span class="n">Vector</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">self</span>
  <span class="kt">integer</span><span class="p">(</span><span class="n">I4P</span><span class="p">),</span>  <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">scal</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>

  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">self</span><span class="p">%</span><span class="n">x</span> <span class="o">=</span> <span class="kt">real</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">R8P</span><span class="p">)</span>
  <span class="n">self</span><span class="p">%</span><span class="n">y</span> <span class="o">=</span> <span class="kt">real</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">R8P</span><span class="p">)</span>
  <span class="n">self</span><span class="p">%</span><span class="n">z</span> <span class="o">=</span> <span class="kt">real</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">R8P</span><span class="p">)</span>
  <span class="k">return</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">endsubroutine</span> <span class="n">assign_ScalI4P</span>

  <span class="k">elemental subroutine </span><span class="n">assign_ScalI2P</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">scal</span><span class="p">)</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="c">!&gt; Assignment between a scalar (integer I2P) and self.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="k">class</span><span class="p">(</span><span class="n">Vector</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">self</span>
  <span class="kt">integer</span><span class="p">(</span><span class="n">I2P</span><span class="p">),</span>  <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">scal</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>

  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">self</span><span class="p">%</span><span class="n">x</span> <span class="o">=</span> <span class="kt">real</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">R8P</span><span class="p">)</span>
  <span class="n">self</span><span class="p">%</span><span class="n">y</span> <span class="o">=</span> <span class="kt">real</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">R8P</span><span class="p">)</span>
  <span class="n">self</span><span class="p">%</span><span class="n">z</span> <span class="o">=</span> <span class="kt">real</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">R8P</span><span class="p">)</span>
  <span class="k">return</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">endsubroutine</span> <span class="n">assign_ScalI2P</span>

  <span class="k">elemental subroutine </span><span class="n">assign_ScalI1P</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">scal</span><span class="p">)</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="c">!&lt; Assignment between a scalar (integer I1P) and self.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="k">class</span><span class="p">(</span><span class="n">Vector</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">self</span>
  <span class="kt">integer</span><span class="p">(</span><span class="n">I1P</span><span class="p">),</span>  <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">scal</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>

  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">self</span><span class="p">%</span><span class="n">x</span> <span class="o">=</span> <span class="kt">real</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">R8P</span><span class="p">)</span>
  <span class="n">self</span><span class="p">%</span><span class="n">y</span> <span class="o">=</span> <span class="kt">real</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">R8P</span><span class="p">)</span>
  <span class="n">self</span><span class="p">%</span><span class="n">z</span> <span class="o">=</span> <span class="kt">real</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">R8P</span><span class="p">)</span>
  <span class="k">return</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">endsubroutine</span> <span class="n">assign_ScalI1P</span>

  <span class="c">! Operator (*)</span>
  <span class="k">elemental function </span><span class="n">self_mul_self</span><span class="p">(</span><span class="n">self1</span><span class="p">,</span> <span class="n">self2</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">mul</span><span class="p">)</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="c">!&lt; Multiply (by components) two selfs.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="k">class</span><span class="p">(</span><span class="n">Vector</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">self1</span>
  <span class="k">type</span><span class="p">(</span><span class="n">Vector</span><span class="p">),</span>  <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">self2</span>
  <span class="k">type</span><span class="p">(</span><span class="n">Vector</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">mul</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>

  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">mul</span><span class="p">%</span><span class="n">x</span> <span class="o">=</span> <span class="n">self1</span><span class="p">%</span><span class="n">x</span> <span class="o">*</span> <span class="n">self2</span><span class="p">%</span><span class="n">x</span>
  <span class="n">mul</span><span class="p">%</span><span class="n">y</span> <span class="o">=</span> <span class="n">self1</span><span class="p">%</span><span class="n">y</span> <span class="o">*</span> <span class="n">self2</span><span class="p">%</span><span class="n">y</span>
  <span class="n">mul</span><span class="p">%</span><span class="n">z</span> <span class="o">=</span> <span class="n">self1</span><span class="p">%</span><span class="n">z</span> <span class="o">*</span> <span class="n">self2</span><span class="p">%</span><span class="n">z</span>
  <span class="k">return</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">endfunction</span> <span class="n">self_mul_self</span>

  <span class="k">elemental function </span><span class="n">ScalR16P_mul_self</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">self</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">mul</span><span class="p">)</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="c">!&lt; Multiply scalar (real R16P) for self.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="kt">real</span><span class="p">(</span><span class="n">R16P</span><span class="p">),</span>    <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">scal</span>
  <span class="k">class</span><span class="p">(</span><span class="n">Vector</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">self</span>
  <span class="k">type</span><span class="p">(</span><span class="n">Vector</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">mul</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>

  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">mul</span><span class="p">%</span><span class="n">x</span> <span class="o">=</span> <span class="kt">real</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">R8P</span><span class="p">)</span> <span class="o">*</span> <span class="n">self</span><span class="p">%</span><span class="n">x</span>
  <span class="n">mul</span><span class="p">%</span><span class="n">y</span> <span class="o">=</span> <span class="kt">real</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">R8P</span><span class="p">)</span> <span class="o">*</span> <span class="n">self</span><span class="p">%</span><span class="n">y</span>
  <span class="n">mul</span><span class="p">%</span><span class="n">z</span> <span class="o">=</span> <span class="kt">real</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">R8P</span><span class="p">)</span> <span class="o">*</span> <span class="n">self</span><span class="p">%</span><span class="n">z</span>
  <span class="k">return</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">endfunction</span> <span class="n">ScalR16P_mul_self</span>

  <span class="k">elemental function </span><span class="n">self_mul_ScalR16P</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">scal</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">mul</span><span class="p">)</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="c">!&lt; Multiply self for scalar (real R16P).</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="k">class</span><span class="p">(</span><span class="n">Vector</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">self</span>
  <span class="kt">real</span><span class="p">(</span><span class="n">R16P</span><span class="p">),</span>    <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">scal</span>
  <span class="k">type</span><span class="p">(</span><span class="n">Vector</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">mul</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>

  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">mul</span><span class="p">%</span><span class="n">x</span> <span class="o">=</span> <span class="kt">real</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">R8P</span><span class="p">)</span> <span class="o">*</span> <span class="n">self</span><span class="p">%</span><span class="n">x</span>
  <span class="n">mul</span><span class="p">%</span><span class="n">y</span> <span class="o">=</span> <span class="kt">real</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">R8P</span><span class="p">)</span> <span class="o">*</span> <span class="n">self</span><span class="p">%</span><span class="n">y</span>
  <span class="n">mul</span><span class="p">%</span><span class="n">z</span> <span class="o">=</span> <span class="kt">real</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">R8P</span><span class="p">)</span> <span class="o">*</span> <span class="n">self</span><span class="p">%</span><span class="n">z</span>
  <span class="k">return</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">endfunction</span> <span class="n">self_mul_ScalR16P</span>

  <span class="k">elemental function </span><span class="n">ScalR8P_mul_self</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">self</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">mul</span><span class="p">)</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="c">!&lt; Multiply scalar (real R8P) for self.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="kt">real</span><span class="p">(</span><span class="n">R8P</span><span class="p">),</span>     <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">scal</span>
  <span class="k">class</span><span class="p">(</span><span class="n">Vector</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">self</span>
  <span class="k">type</span><span class="p">(</span><span class="n">Vector</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">mul</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>

  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">mul</span><span class="p">%</span><span class="n">x</span> <span class="o">=</span> <span class="kt">real</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">R8P</span><span class="p">)</span> <span class="o">*</span> <span class="n">self</span><span class="p">%</span><span class="n">x</span>
  <span class="n">mul</span><span class="p">%</span><span class="n">y</span> <span class="o">=</span> <span class="kt">real</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">R8P</span><span class="p">)</span> <span class="o">*</span> <span class="n">self</span><span class="p">%</span><span class="n">y</span>
  <span class="n">mul</span><span class="p">%</span><span class="n">z</span> <span class="o">=</span> <span class="kt">real</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">R8P</span><span class="p">)</span> <span class="o">*</span> <span class="n">self</span><span class="p">%</span><span class="n">z</span>
  <span class="k">return</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">endfunction</span> <span class="n">ScalR8P_mul_self</span>

  <span class="k">elemental function </span><span class="n">self_mul_ScalR8P</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">scal</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">mul</span><span class="p">)</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="c">!&lt; Multiply self for scalar (real R8P).</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="k">class</span><span class="p">(</span><span class="n">Vector</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">self</span>
  <span class="kt">real</span><span class="p">(</span><span class="n">R8P</span><span class="p">),</span>     <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">scal</span>
  <span class="k">type</span><span class="p">(</span><span class="n">Vector</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">mul</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>

  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">mul</span><span class="p">%</span><span class="n">x</span> <span class="o">=</span> <span class="kt">real</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">R8P</span><span class="p">)</span> <span class="o">*</span> <span class="n">self</span><span class="p">%</span><span class="n">x</span>
  <span class="n">mul</span><span class="p">%</span><span class="n">y</span> <span class="o">=</span> <span class="kt">real</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">R8P</span><span class="p">)</span> <span class="o">*</span> <span class="n">self</span><span class="p">%</span><span class="n">y</span>
  <span class="n">mul</span><span class="p">%</span><span class="n">z</span> <span class="o">=</span> <span class="kt">real</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">R8P</span><span class="p">)</span> <span class="o">*</span> <span class="n">self</span><span class="p">%</span><span class="n">z</span>
  <span class="k">return</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">endfunction</span> <span class="n">self_mul_ScalR8P</span>

  <span class="k">elemental function </span><span class="n">ScalR4P_mul_self</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">self</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">mul</span><span class="p">)</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="c">!&lt; Multiply scalar (real R4P) for self.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="kt">real</span><span class="p">(</span><span class="n">R4P</span><span class="p">),</span>     <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">scal</span>
  <span class="k">class</span><span class="p">(</span><span class="n">Vector</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">self</span>
  <span class="k">type</span><span class="p">(</span><span class="n">Vector</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">mul</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>

  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">mul</span><span class="p">%</span><span class="n">x</span> <span class="o">=</span> <span class="kt">real</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">R8P</span><span class="p">)</span> <span class="o">*</span> <span class="n">self</span><span class="p">%</span><span class="n">x</span>
  <span class="n">mul</span><span class="p">%</span><span class="n">y</span> <span class="o">=</span> <span class="kt">real</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">R8P</span><span class="p">)</span> <span class="o">*</span> <span class="n">self</span><span class="p">%</span><span class="n">y</span>
  <span class="n">mul</span><span class="p">%</span><span class="n">z</span> <span class="o">=</span> <span class="kt">real</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">R8P</span><span class="p">)</span> <span class="o">*</span> <span class="n">self</span><span class="p">%</span><span class="n">z</span>
  <span class="k">return</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">endfunction</span> <span class="n">ScalR4P_mul_self</span>

  <span class="k">elemental function </span><span class="n">self_mul_ScalR4P</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">scal</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">mul</span><span class="p">)</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="c">!&lt; Multiply self for scalar (real R4P).</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="k">class</span><span class="p">(</span><span class="n">Vector</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">self</span>
  <span class="kt">real</span><span class="p">(</span><span class="n">R4P</span><span class="p">),</span>     <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">scal</span>
  <span class="k">type</span><span class="p">(</span><span class="n">Vector</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">mul</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>

  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">mul</span><span class="p">%</span><span class="n">x</span> <span class="o">=</span> <span class="kt">real</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">R8P</span><span class="p">)</span> <span class="o">*</span> <span class="n">self</span><span class="p">%</span><span class="n">x</span>
  <span class="n">mul</span><span class="p">%</span><span class="n">y</span> <span class="o">=</span> <span class="kt">real</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">R8P</span><span class="p">)</span> <span class="o">*</span> <span class="n">self</span><span class="p">%</span><span class="n">y</span>
  <span class="n">mul</span><span class="p">%</span><span class="n">z</span> <span class="o">=</span> <span class="kt">real</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">R8P</span><span class="p">)</span> <span class="o">*</span> <span class="n">self</span><span class="p">%</span><span class="n">z</span>
  <span class="k">return</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">endfunction</span> <span class="n">self_mul_ScalR4P</span>

  <span class="k">elemental function </span><span class="n">ScalI8P_mul_self</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">self</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">mul</span><span class="p">)</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="c">!&lt; Multiply scalar (integer I8P) for self.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="kt">integer</span><span class="p">(</span><span class="n">I8P</span><span class="p">),</span>  <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">scal</span>
  <span class="k">class</span><span class="p">(</span><span class="n">Vector</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">self</span>
  <span class="k">type</span><span class="p">(</span><span class="n">Vector</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">mul</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>

  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">mul</span><span class="p">%</span><span class="n">x</span> <span class="o">=</span> <span class="kt">real</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">R8P</span><span class="p">)</span> <span class="o">*</span> <span class="n">self</span><span class="p">%</span><span class="n">x</span>
  <span class="n">mul</span><span class="p">%</span><span class="n">y</span> <span class="o">=</span> <span class="kt">real</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">R8P</span><span class="p">)</span> <span class="o">*</span> <span class="n">self</span><span class="p">%</span><span class="n">y</span>
  <span class="n">mul</span><span class="p">%</span><span class="n">z</span> <span class="o">=</span> <span class="kt">real</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">R8P</span><span class="p">)</span> <span class="o">*</span> <span class="n">self</span><span class="p">%</span><span class="n">z</span>
  <span class="k">return</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">endfunction</span> <span class="n">ScalI8P_mul_self</span>

  <span class="k">elemental function </span><span class="n">self_mul_ScalI8P</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">scal</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">mul</span><span class="p">)</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="c">!&lt; Multiply self for scalar (integer I8P).</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="k">class</span><span class="p">(</span><span class="n">Vector</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">self</span>
  <span class="kt">integer</span><span class="p">(</span><span class="n">I8P</span><span class="p">),</span>  <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">scal</span>
  <span class="k">type</span><span class="p">(</span><span class="n">Vector</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">mul</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>

  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">mul</span><span class="p">%</span><span class="n">x</span> <span class="o">=</span> <span class="kt">real</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">R8P</span><span class="p">)</span> <span class="o">*</span> <span class="n">self</span><span class="p">%</span><span class="n">x</span>
  <span class="n">mul</span><span class="p">%</span><span class="n">y</span> <span class="o">=</span> <span class="kt">real</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">R8P</span><span class="p">)</span> <span class="o">*</span> <span class="n">self</span><span class="p">%</span><span class="n">y</span>
  <span class="n">mul</span><span class="p">%</span><span class="n">z</span> <span class="o">=</span> <span class="kt">real</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">R8P</span><span class="p">)</span> <span class="o">*</span> <span class="n">self</span><span class="p">%</span><span class="n">z</span>
  <span class="k">return</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">endfunction</span> <span class="n">self_mul_ScalI8P</span>

  <span class="k">elemental function </span><span class="n">ScalI4P_mul_self</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">self</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">mul</span><span class="p">)</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="c">!&lt; Multiply scalar (integer I4P) for self.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="kt">integer</span><span class="p">(</span><span class="n">I4P</span><span class="p">),</span>  <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">scal</span>
  <span class="k">class</span><span class="p">(</span><span class="n">Vector</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">self</span>
  <span class="k">type</span><span class="p">(</span><span class="n">Vector</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">mul</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>

  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">mul</span><span class="p">%</span><span class="n">x</span> <span class="o">=</span> <span class="kt">real</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">R8P</span><span class="p">)</span> <span class="o">*</span> <span class="n">self</span><span class="p">%</span><span class="n">x</span>
  <span class="n">mul</span><span class="p">%</span><span class="n">y</span> <span class="o">=</span> <span class="kt">real</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">R8P</span><span class="p">)</span> <span class="o">*</span> <span class="n">self</span><span class="p">%</span><span class="n">y</span>
  <span class="n">mul</span><span class="p">%</span><span class="n">z</span> <span class="o">=</span> <span class="kt">real</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">R8P</span><span class="p">)</span> <span class="o">*</span> <span class="n">self</span><span class="p">%</span><span class="n">z</span>
  <span class="k">return</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">endfunction</span> <span class="n">ScalI4P_mul_self</span>

  <span class="k">elemental function </span><span class="n">self_mul_ScalI4P</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">scal</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">mul</span><span class="p">)</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="c">!&lt; Multiply self for scalar (integer I4P).</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="k">class</span><span class="p">(</span><span class="n">Vector</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">self</span>
  <span class="kt">integer</span><span class="p">(</span><span class="n">I4P</span><span class="p">),</span>  <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">scal</span>
  <span class="k">type</span><span class="p">(</span><span class="n">Vector</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">mul</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>

  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">mul</span><span class="p">%</span><span class="n">x</span> <span class="o">=</span> <span class="kt">real</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">R8P</span><span class="p">)</span> <span class="o">*</span> <span class="n">self</span><span class="p">%</span><span class="n">x</span>
  <span class="n">mul</span><span class="p">%</span><span class="n">y</span> <span class="o">=</span> <span class="kt">real</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">R8P</span><span class="p">)</span> <span class="o">*</span> <span class="n">self</span><span class="p">%</span><span class="n">y</span>
  <span class="n">mul</span><span class="p">%</span><span class="n">z</span> <span class="o">=</span> <span class="kt">real</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">R8P</span><span class="p">)</span> <span class="o">*</span> <span class="n">self</span><span class="p">%</span><span class="n">z</span>
  <span class="k">return</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">endfunction</span> <span class="n">self_mul_ScalI4P</span>

  <span class="k">elemental function </span><span class="n">ScalI2P_mul_self</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">self</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">mul</span><span class="p">)</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="c">!&lt; Multiply scalar (integer I2P) for self.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="kt">integer</span><span class="p">(</span><span class="n">I2P</span><span class="p">),</span>  <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">scal</span>
  <span class="k">class</span><span class="p">(</span><span class="n">Vector</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">self</span>
  <span class="k">type</span><span class="p">(</span><span class="n">Vector</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">mul</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>

  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">mul</span><span class="p">%</span><span class="n">x</span> <span class="o">=</span> <span class="kt">real</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">R8P</span><span class="p">)</span> <span class="o">*</span> <span class="n">self</span><span class="p">%</span><span class="n">x</span>
  <span class="n">mul</span><span class="p">%</span><span class="n">y</span> <span class="o">=</span> <span class="kt">real</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">R8P</span><span class="p">)</span> <span class="o">*</span> <span class="n">self</span><span class="p">%</span><span class="n">y</span>
  <span class="n">mul</span><span class="p">%</span><span class="n">z</span> <span class="o">=</span> <span class="kt">real</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">R8P</span><span class="p">)</span> <span class="o">*</span> <span class="n">self</span><span class="p">%</span><span class="n">z</span>
  <span class="k">return</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">endfunction</span> <span class="n">ScalI2P_mul_self</span>

  <span class="k">elemental function </span><span class="n">self_mul_ScalI2P</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">scal</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">mul</span><span class="p">)</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="c">!&lt; Multiply self for scalar (integer I2P).</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="k">class</span><span class="p">(</span><span class="n">Vector</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">self</span>
  <span class="kt">integer</span><span class="p">(</span><span class="n">I2P</span><span class="p">),</span>  <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">scal</span>
  <span class="k">type</span><span class="p">(</span><span class="n">Vector</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">mul</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>

  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">mul</span><span class="p">%</span><span class="n">x</span> <span class="o">=</span> <span class="kt">real</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">R8P</span><span class="p">)</span> <span class="o">*</span> <span class="n">self</span><span class="p">%</span><span class="n">x</span>
  <span class="n">mul</span><span class="p">%</span><span class="n">y</span> <span class="o">=</span> <span class="kt">real</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">R8P</span><span class="p">)</span> <span class="o">*</span> <span class="n">self</span><span class="p">%</span><span class="n">y</span>
  <span class="n">mul</span><span class="p">%</span><span class="n">z</span> <span class="o">=</span> <span class="kt">real</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">R8P</span><span class="p">)</span> <span class="o">*</span> <span class="n">self</span><span class="p">%</span><span class="n">z</span>
  <span class="k">return</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">endfunction</span> <span class="n">self_mul_ScalI2P</span>

  <span class="k">elemental function </span><span class="n">ScalI1P_mul_self</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">self</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">mul</span><span class="p">)</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="c">!&lt; Multiply scalar (integer I1P) for self.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="kt">integer</span><span class="p">(</span><span class="n">I1P</span><span class="p">),</span>  <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">scal</span>
  <span class="k">class</span><span class="p">(</span><span class="n">Vector</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">self</span>
  <span class="k">type</span><span class="p">(</span><span class="n">Vector</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">mul</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>

  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">mul</span><span class="p">%</span><span class="n">x</span> <span class="o">=</span> <span class="kt">real</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">R8P</span><span class="p">)</span> <span class="o">*</span> <span class="n">self</span><span class="p">%</span><span class="n">x</span>
  <span class="n">mul</span><span class="p">%</span><span class="n">y</span> <span class="o">=</span> <span class="kt">real</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">R8P</span><span class="p">)</span> <span class="o">*</span> <span class="n">self</span><span class="p">%</span><span class="n">y</span>
  <span class="n">mul</span><span class="p">%</span><span class="n">z</span> <span class="o">=</span> <span class="kt">real</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">R8P</span><span class="p">)</span> <span class="o">*</span> <span class="n">self</span><span class="p">%</span><span class="n">z</span>
  <span class="k">return</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">endfunction</span> <span class="n">ScalI1P_mul_self</span>

  <span class="k">elemental function </span><span class="n">self_mul_ScalI1P</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">scal</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">mul</span><span class="p">)</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="c">!&lt; Multiply self for scalar (integer I1P).</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="k">class</span><span class="p">(</span><span class="n">Vector</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">self</span>
  <span class="kt">integer</span><span class="p">(</span><span class="n">I1P</span><span class="p">),</span>  <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">scal</span>
  <span class="k">type</span><span class="p">(</span><span class="n">Vector</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">mul</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>

  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">mul</span><span class="p">%</span><span class="n">x</span> <span class="o">=</span> <span class="kt">real</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">R8P</span><span class="p">)</span> <span class="o">*</span> <span class="n">self</span><span class="p">%</span><span class="n">x</span>
  <span class="n">mul</span><span class="p">%</span><span class="n">y</span> <span class="o">=</span> <span class="kt">real</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">R8P</span><span class="p">)</span> <span class="o">*</span> <span class="n">self</span><span class="p">%</span><span class="n">y</span>
  <span class="n">mul</span><span class="p">%</span><span class="n">z</span> <span class="o">=</span> <span class="kt">real</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">R8P</span><span class="p">)</span> <span class="o">*</span> <span class="n">self</span><span class="p">%</span><span class="n">z</span>
  <span class="k">return</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">endfunction</span> <span class="n">self_mul_ScalI1P</span>

  <span class="c">! Operator (/)</span>
  <span class="k">elemental function </span><span class="n">self_div_self</span><span class="p">(</span><span class="n">self1</span><span class="p">,</span> <span class="n">self2</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">div</span><span class="p">)</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="c">!&lt; Divide self for self.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="k">class</span><span class="p">(</span><span class="n">Vector</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">self1</span>
  <span class="k">type</span><span class="p">(</span><span class="n">Vector</span><span class="p">),</span>  <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">self2</span>
  <span class="k">type</span><span class="p">(</span><span class="n">Vector</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">div</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>

  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">div</span><span class="p">%</span><span class="n">x</span> <span class="o">=</span> <span class="n">self1</span><span class="p">%</span><span class="n">x</span> <span class="o">/</span> <span class="n">self2</span><span class="p">%</span><span class="n">x</span>
  <span class="n">div</span><span class="p">%</span><span class="n">y</span> <span class="o">=</span> <span class="n">self1</span><span class="p">%</span><span class="n">y</span> <span class="o">/</span> <span class="n">self2</span><span class="p">%</span><span class="n">y</span>
  <span class="n">div</span><span class="p">%</span><span class="n">z</span> <span class="o">=</span> <span class="n">self1</span><span class="p">%</span><span class="n">z</span> <span class="o">/</span> <span class="n">self2</span><span class="p">%</span><span class="n">z</span>
  <span class="k">return</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">endfunction</span> <span class="n">self_div_self</span>

  <span class="k">elemental function </span><span class="n">self_div_ScalR16P</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">scal</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">div</span><span class="p">)</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="c">!&lt; Divide self for scalar (real R16P).</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="k">class</span><span class="p">(</span><span class="n">Vector</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">self</span>
  <span class="kt">real</span><span class="p">(</span><span class="n">R16P</span><span class="p">),</span>    <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">scal</span>
  <span class="k">type</span><span class="p">(</span><span class="n">Vector</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">div</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>

  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">div</span><span class="p">%</span><span class="n">x</span> <span class="o">=</span> <span class="n">self</span><span class="p">%</span><span class="n">x</span> <span class="o">/</span> <span class="kt">real</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">R8P</span><span class="p">)</span>
  <span class="n">div</span><span class="p">%</span><span class="n">y</span> <span class="o">=</span> <span class="n">self</span><span class="p">%</span><span class="n">y</span> <span class="o">/</span> <span class="kt">real</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">R8P</span><span class="p">)</span>
  <span class="n">div</span><span class="p">%</span><span class="n">z</span> <span class="o">=</span> <span class="n">self</span><span class="p">%</span><span class="n">z</span> <span class="o">/</span> <span class="kt">real</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">R8P</span><span class="p">)</span>
  <span class="k">return</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">endfunction</span> <span class="n">self_div_ScalR16P</span>

  <span class="k">elemental function </span><span class="n">self_div_ScalR8P</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">scal</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">div</span><span class="p">)</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="c">!&lt; Divide self for scalar (real R8P).</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="k">class</span><span class="p">(</span><span class="n">Vector</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span><span class="kd">::</span> <span class="n">self</span>
  <span class="kt">real</span><span class="p">(</span><span class="n">R8P</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span><span class="kd">::</span> <span class="n">scal</span>
  <span class="k">type</span><span class="p">(</span><span class="n">Vector</span><span class="p">)</span><span class="kd">::</span> <span class="n">div</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>

  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">div</span><span class="p">%</span><span class="n">x</span> <span class="o">=</span> <span class="n">self</span><span class="p">%</span><span class="n">x</span> <span class="o">/</span> <span class="kt">real</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">R8P</span><span class="p">)</span>
  <span class="n">div</span><span class="p">%</span><span class="n">y</span> <span class="o">=</span> <span class="n">self</span><span class="p">%</span><span class="n">y</span> <span class="o">/</span> <span class="kt">real</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">R8P</span><span class="p">)</span>
  <span class="n">div</span><span class="p">%</span><span class="n">z</span> <span class="o">=</span> <span class="n">self</span><span class="p">%</span><span class="n">z</span> <span class="o">/</span> <span class="kt">real</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">R8P</span><span class="p">)</span>
  <span class="k">return</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">endfunction</span> <span class="n">self_div_ScalR8P</span>

  <span class="k">elemental function </span><span class="n">self_div_ScalR4P</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">scal</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">div</span><span class="p">)</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="c">!&lt; Divide self for scalar (real R4P).</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="k">class</span><span class="p">(</span><span class="n">Vector</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">self</span>
  <span class="kt">real</span><span class="p">(</span><span class="n">R4P</span><span class="p">),</span>     <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">scal</span>
  <span class="k">type</span><span class="p">(</span><span class="n">Vector</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">div</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>

  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">div</span><span class="p">%</span><span class="n">x</span> <span class="o">=</span> <span class="n">self</span><span class="p">%</span><span class="n">x</span> <span class="o">/</span> <span class="kt">real</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">R8P</span><span class="p">)</span>
  <span class="n">div</span><span class="p">%</span><span class="n">y</span> <span class="o">=</span> <span class="n">self</span><span class="p">%</span><span class="n">y</span> <span class="o">/</span> <span class="kt">real</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">R8P</span><span class="p">)</span>
  <span class="n">div</span><span class="p">%</span><span class="n">z</span> <span class="o">=</span> <span class="n">self</span><span class="p">%</span><span class="n">z</span> <span class="o">/</span> <span class="kt">real</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">R8P</span><span class="p">)</span>
  <span class="k">return</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">endfunction</span> <span class="n">self_div_ScalR4P</span>

  <span class="k">elemental function </span><span class="n">self_div_ScalI8P</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">scal</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">div</span><span class="p">)</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="c">!&lt; Divide self for scalar (integer I8P).</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="k">class</span><span class="p">(</span><span class="n">Vector</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">self</span>
  <span class="kt">integer</span><span class="p">(</span><span class="n">I8P</span><span class="p">),</span>  <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">scal</span>
  <span class="k">type</span><span class="p">(</span><span class="n">Vector</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">div</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>

  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">div</span><span class="p">%</span><span class="n">x</span> <span class="o">=</span> <span class="n">self</span><span class="p">%</span><span class="n">x</span> <span class="o">/</span> <span class="kt">real</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">R8P</span><span class="p">)</span>
  <span class="n">div</span><span class="p">%</span><span class="n">y</span> <span class="o">=</span> <span class="n">self</span><span class="p">%</span><span class="n">y</span> <span class="o">/</span> <span class="kt">real</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">R8P</span><span class="p">)</span>
  <span class="n">div</span><span class="p">%</span><span class="n">z</span> <span class="o">=</span> <span class="n">self</span><span class="p">%</span><span class="n">z</span> <span class="o">/</span> <span class="kt">real</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">R8P</span><span class="p">)</span>
  <span class="k">return</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">endfunction</span> <span class="n">self_div_ScalI8P</span>

  <span class="k">elemental function </span><span class="n">self_div_ScalI4P</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">scal</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">div</span><span class="p">)</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="c">!&lt; Divide self for scalar (integer I4P).</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="k">class</span><span class="p">(</span><span class="n">Vector</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">self</span>
  <span class="kt">integer</span><span class="p">(</span><span class="n">I4P</span><span class="p">),</span>  <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">scal</span>
  <span class="k">type</span><span class="p">(</span><span class="n">Vector</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">div</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>

  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">div</span><span class="p">%</span><span class="n">x</span> <span class="o">=</span> <span class="n">self</span><span class="p">%</span><span class="n">x</span> <span class="o">/</span> <span class="kt">real</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">R8P</span><span class="p">)</span>
  <span class="n">div</span><span class="p">%</span><span class="n">y</span> <span class="o">=</span> <span class="n">self</span><span class="p">%</span><span class="n">y</span> <span class="o">/</span> <span class="kt">real</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">R8P</span><span class="p">)</span>
  <span class="n">div</span><span class="p">%</span><span class="n">z</span> <span class="o">=</span> <span class="n">self</span><span class="p">%</span><span class="n">z</span> <span class="o">/</span> <span class="kt">real</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">R8P</span><span class="p">)</span>
  <span class="k">return</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">endfunction</span> <span class="n">self_div_ScalI4P</span>

  <span class="k">elemental function </span><span class="n">self_div_ScalI2P</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">scal</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">div</span><span class="p">)</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="c">!&lt; Divide self for scalar (integer I2P).</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="k">class</span><span class="p">(</span><span class="n">Vector</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">self</span>
  <span class="kt">integer</span><span class="p">(</span><span class="n">I2P</span><span class="p">),</span>  <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">scal</span>
  <span class="k">type</span><span class="p">(</span><span class="n">Vector</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">div</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>

  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">div</span><span class="p">%</span><span class="n">x</span> <span class="o">=</span> <span class="n">self</span><span class="p">%</span><span class="n">x</span> <span class="o">/</span> <span class="kt">real</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">R8P</span><span class="p">)</span>
  <span class="n">div</span><span class="p">%</span><span class="n">y</span> <span class="o">=</span> <span class="n">self</span><span class="p">%</span><span class="n">y</span> <span class="o">/</span> <span class="kt">real</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">R8P</span><span class="p">)</span>
  <span class="n">div</span><span class="p">%</span><span class="n">z</span> <span class="o">=</span> <span class="n">self</span><span class="p">%</span><span class="n">z</span> <span class="o">/</span> <span class="kt">real</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">R8P</span><span class="p">)</span>
  <span class="k">return</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">endfunction</span> <span class="n">self_div_ScalI2P</span>

  <span class="k">elemental function </span><span class="n">self_div_ScalI1P</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">scal</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">div</span><span class="p">)</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="c">!&lt; Divide self for scalar (integer I1P).</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="k">class</span><span class="p">(</span><span class="n">Vector</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">self</span>
  <span class="kt">integer</span><span class="p">(</span><span class="n">I1P</span><span class="p">),</span>  <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">scal</span>
  <span class="k">type</span><span class="p">(</span><span class="n">Vector</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">div</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>

  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">div</span><span class="p">%</span><span class="n">x</span> <span class="o">=</span> <span class="n">self</span><span class="p">%</span><span class="n">x</span> <span class="o">/</span> <span class="kt">real</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">R8P</span><span class="p">)</span>
  <span class="n">div</span><span class="p">%</span><span class="n">y</span> <span class="o">=</span> <span class="n">self</span><span class="p">%</span><span class="n">y</span> <span class="o">/</span> <span class="kt">real</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">R8P</span><span class="p">)</span>
  <span class="n">div</span><span class="p">%</span><span class="n">z</span> <span class="o">=</span> <span class="n">self</span><span class="p">%</span><span class="n">z</span> <span class="o">/</span> <span class="kt">real</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">R8P</span><span class="p">)</span>
  <span class="k">return</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">endfunction</span> <span class="n">self_div_ScalI1P</span>

  <span class="c">! Operator (+)</span>
  <span class="k">elemental function </span><span class="n">positive_self</span><span class="p">(</span><span class="n">self</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">pos</span><span class="p">)</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="c">!&lt; Applay unary + to a self.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="k">class</span><span class="p">(</span><span class="n">Vector</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">self</span>
  <span class="k">type</span><span class="p">(</span><span class="n">Vector</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">pos</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>

  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">pos</span><span class="p">%</span><span class="n">x</span> <span class="o">=</span> <span class="o">+</span> <span class="n">self</span><span class="p">%</span><span class="n">x</span>
  <span class="n">pos</span><span class="p">%</span><span class="n">y</span> <span class="o">=</span> <span class="o">+</span> <span class="n">self</span><span class="p">%</span><span class="n">y</span>
  <span class="n">pos</span><span class="p">%</span><span class="n">z</span> <span class="o">=</span> <span class="o">+</span> <span class="n">self</span><span class="p">%</span><span class="n">z</span>
  <span class="k">return</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">endfunction</span> <span class="n">positive_self</span>

  <span class="k">elemental function </span><span class="n">self_sum_self</span><span class="p">(</span><span class="n">self1</span><span class="p">,</span> <span class="n">self2</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">summ</span><span class="p">)</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="c">!&lt; Sum self and self.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="k">class</span><span class="p">(</span><span class="n">Vector</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">self1</span>
  <span class="k">type</span><span class="p">(</span><span class="n">Vector</span><span class="p">),</span>  <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">self2</span>
  <span class="k">type</span><span class="p">(</span><span class="n">Vector</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">summ</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>

  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">summ</span><span class="p">%</span><span class="n">x</span> <span class="o">=</span> <span class="n">self1</span><span class="p">%</span><span class="n">x</span> <span class="o">+</span> <span class="n">self2</span><span class="p">%</span><span class="n">x</span>
  <span class="n">summ</span><span class="p">%</span><span class="n">y</span> <span class="o">=</span> <span class="n">self1</span><span class="p">%</span><span class="n">y</span> <span class="o">+</span> <span class="n">self2</span><span class="p">%</span><span class="n">y</span>
  <span class="n">summ</span><span class="p">%</span><span class="n">z</span> <span class="o">=</span> <span class="n">self1</span><span class="p">%</span><span class="n">z</span> <span class="o">+</span> <span class="n">self2</span><span class="p">%</span><span class="n">z</span>
  <span class="k">return</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">endfunction</span> <span class="n">self_sum_self</span>

  <span class="k">elemental function </span><span class="n">ScalR16P_sum_self</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">self</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">summ</span><span class="p">)</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="c">!&lt; Sum scalar (real R16P) and self.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="kt">real</span><span class="p">(</span><span class="n">R16P</span><span class="p">),</span>    <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">scal</span>
  <span class="k">class</span><span class="p">(</span><span class="n">Vector</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">self</span>
  <span class="k">type</span><span class="p">(</span><span class="n">Vector</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">summ</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>

  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">summ</span><span class="p">%</span><span class="n">x</span> <span class="o">=</span> <span class="kt">real</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">R8P</span><span class="p">)</span> <span class="o">+</span> <span class="n">self</span><span class="p">%</span><span class="n">x</span>
  <span class="n">summ</span><span class="p">%</span><span class="n">y</span> <span class="o">=</span> <span class="kt">real</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">R8P</span><span class="p">)</span> <span class="o">+</span> <span class="n">self</span><span class="p">%</span><span class="n">y</span>
  <span class="n">summ</span><span class="p">%</span><span class="n">z</span> <span class="o">=</span> <span class="kt">real</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">R8P</span><span class="p">)</span> <span class="o">+</span> <span class="n">self</span><span class="p">%</span><span class="n">z</span>
  <span class="k">return</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">endfunction</span> <span class="n">ScalR16P_sum_self</span>

  <span class="k">elemental function </span><span class="n">self_sum_ScalR16P</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">scal</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">summ</span><span class="p">)</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="c">!&lt; Sum self and scalar (real R16P).</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="k">class</span><span class="p">(</span><span class="n">Vector</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">self</span>
  <span class="kt">real</span><span class="p">(</span><span class="n">R16P</span><span class="p">),</span>    <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">scal</span>
  <span class="k">type</span><span class="p">(</span><span class="n">Vector</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">summ</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>

  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">summ</span><span class="p">%</span><span class="n">x</span> <span class="o">=</span> <span class="kt">real</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">R8P</span><span class="p">)</span> <span class="o">+</span> <span class="n">self</span><span class="p">%</span><span class="n">x</span>
  <span class="n">summ</span><span class="p">%</span><span class="n">y</span> <span class="o">=</span> <span class="kt">real</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">R8P</span><span class="p">)</span> <span class="o">+</span> <span class="n">self</span><span class="p">%</span><span class="n">y</span>
  <span class="n">summ</span><span class="p">%</span><span class="n">z</span> <span class="o">=</span> <span class="kt">real</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">R8P</span><span class="p">)</span> <span class="o">+</span> <span class="n">self</span><span class="p">%</span><span class="n">z</span>
  <span class="k">return</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">endfunction</span> <span class="n">self_sum_ScalR16P</span>

  <span class="k">elemental function </span><span class="n">ScalR8P_sum_self</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">self</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">summ</span><span class="p">)</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="c">!&lt; Sum scalar (real R8P) and self.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="kt">real</span><span class="p">(</span><span class="n">R8P</span><span class="p">),</span>     <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">scal</span>
  <span class="k">class</span><span class="p">(</span><span class="n">Vector</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">self</span>
  <span class="k">type</span><span class="p">(</span><span class="n">Vector</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">summ</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>

  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">summ</span><span class="p">%</span><span class="n">x</span> <span class="o">=</span> <span class="kt">real</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">R8P</span><span class="p">)</span> <span class="o">+</span> <span class="n">self</span><span class="p">%</span><span class="n">x</span>
  <span class="n">summ</span><span class="p">%</span><span class="n">y</span> <span class="o">=</span> <span class="kt">real</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">R8P</span><span class="p">)</span> <span class="o">+</span> <span class="n">self</span><span class="p">%</span><span class="n">y</span>
  <span class="n">summ</span><span class="p">%</span><span class="n">z</span> <span class="o">=</span> <span class="kt">real</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">R8P</span><span class="p">)</span> <span class="o">+</span> <span class="n">self</span><span class="p">%</span><span class="n">z</span>
  <span class="k">return</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">endfunction</span> <span class="n">ScalR8P_sum_self</span>

  <span class="k">elemental function </span><span class="n">self_sum_ScalR8P</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">scal</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">summ</span><span class="p">)</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="c">!&lt; Sum self and scalar (real R8P).</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="k">class</span><span class="p">(</span><span class="n">Vector</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">self</span>
  <span class="kt">real</span><span class="p">(</span><span class="n">R8P</span><span class="p">),</span>     <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">scal</span>
  <span class="k">type</span><span class="p">(</span><span class="n">Vector</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">summ</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>

  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">summ</span><span class="p">%</span><span class="n">x</span> <span class="o">=</span> <span class="kt">real</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">R8P</span><span class="p">)</span> <span class="o">+</span> <span class="n">self</span><span class="p">%</span><span class="n">x</span>
  <span class="n">summ</span><span class="p">%</span><span class="n">y</span> <span class="o">=</span> <span class="kt">real</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">R8P</span><span class="p">)</span> <span class="o">+</span> <span class="n">self</span><span class="p">%</span><span class="n">y</span>
  <span class="n">summ</span><span class="p">%</span><span class="n">z</span> <span class="o">=</span> <span class="kt">real</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">R8P</span><span class="p">)</span> <span class="o">+</span> <span class="n">self</span><span class="p">%</span><span class="n">z</span>
  <span class="k">return</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">endfunction</span> <span class="n">self_sum_ScalR8P</span>

  <span class="k">elemental function </span><span class="n">ScalR4P_sum_self</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">self</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">summ</span><span class="p">)</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="c">!&lt; Sum scalar (real R4P) and self.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="kt">real</span><span class="p">(</span><span class="n">R4P</span><span class="p">),</span>     <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">scal</span>
  <span class="k">class</span><span class="p">(</span><span class="n">Vector</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">self</span>
  <span class="k">type</span><span class="p">(</span><span class="n">Vector</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">summ</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>

  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">summ</span><span class="p">%</span><span class="n">x</span> <span class="o">=</span> <span class="kt">real</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">R8P</span><span class="p">)</span> <span class="o">+</span> <span class="n">self</span><span class="p">%</span><span class="n">x</span>
  <span class="n">summ</span><span class="p">%</span><span class="n">y</span> <span class="o">=</span> <span class="kt">real</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">R8P</span><span class="p">)</span> <span class="o">+</span> <span class="n">self</span><span class="p">%</span><span class="n">y</span>
  <span class="n">summ</span><span class="p">%</span><span class="n">z</span> <span class="o">=</span> <span class="kt">real</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">R8P</span><span class="p">)</span> <span class="o">+</span> <span class="n">self</span><span class="p">%</span><span class="n">z</span>
  <span class="k">return</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">endfunction</span> <span class="n">ScalR4P_sum_self</span>

  <span class="k">elemental function </span><span class="n">self_sum_ScalR4P</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">scal</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">summ</span><span class="p">)</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="c">!&lt; Sum self and scalar (real R4P).</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="k">class</span><span class="p">(</span><span class="n">Vector</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">self</span>
  <span class="kt">real</span><span class="p">(</span><span class="n">R4P</span><span class="p">),</span>     <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">scal</span>
  <span class="k">type</span><span class="p">(</span><span class="n">Vector</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">summ</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>

  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">summ</span><span class="p">%</span><span class="n">x</span> <span class="o">=</span> <span class="kt">real</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">R8P</span><span class="p">)</span> <span class="o">+</span> <span class="n">self</span><span class="p">%</span><span class="n">x</span>
  <span class="n">summ</span><span class="p">%</span><span class="n">y</span> <span class="o">=</span> <span class="kt">real</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">R8P</span><span class="p">)</span> <span class="o">+</span> <span class="n">self</span><span class="p">%</span><span class="n">y</span>
  <span class="n">summ</span><span class="p">%</span><span class="n">z</span> <span class="o">=</span> <span class="kt">real</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">R8P</span><span class="p">)</span> <span class="o">+</span> <span class="n">self</span><span class="p">%</span><span class="n">z</span>
  <span class="k">return</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">endfunction</span> <span class="n">self_sum_ScalR4P</span>

  <span class="k">elemental function </span><span class="n">ScalI8P_sum_self</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">self</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">summ</span><span class="p">)</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="c">!&lt; Sum scalar (integer I8P) and self.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="kt">integer</span><span class="p">(</span><span class="n">I8P</span><span class="p">),</span>  <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">scal</span>
  <span class="k">class</span><span class="p">(</span><span class="n">Vector</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">self</span>
  <span class="k">type</span><span class="p">(</span><span class="n">Vector</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">summ</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>

  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">summ</span><span class="p">%</span><span class="n">x</span> <span class="o">=</span> <span class="kt">real</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">R8P</span><span class="p">)</span> <span class="o">+</span> <span class="n">self</span><span class="p">%</span><span class="n">x</span>
  <span class="n">summ</span><span class="p">%</span><span class="n">y</span> <span class="o">=</span> <span class="kt">real</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">R8P</span><span class="p">)</span> <span class="o">+</span> <span class="n">self</span><span class="p">%</span><span class="n">y</span>
  <span class="n">summ</span><span class="p">%</span><span class="n">z</span> <span class="o">=</span> <span class="kt">real</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">R8P</span><span class="p">)</span> <span class="o">+</span> <span class="n">self</span><span class="p">%</span><span class="n">z</span>
  <span class="k">return</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">endfunction</span> <span class="n">ScalI8P_sum_self</span>

  <span class="k">elemental function </span><span class="n">self_sum_ScalI8P</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">scal</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">summ</span><span class="p">)</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="c">!&lt; Sum self and scalar (integer I8P).</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="k">class</span><span class="p">(</span><span class="n">Vector</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">self</span>
  <span class="kt">integer</span><span class="p">(</span><span class="n">I8P</span><span class="p">),</span>  <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">scal</span>
  <span class="k">type</span><span class="p">(</span><span class="n">Vector</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">summ</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>

  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">summ</span><span class="p">%</span><span class="n">x</span> <span class="o">=</span> <span class="kt">real</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">R8P</span><span class="p">)</span> <span class="o">+</span> <span class="n">self</span><span class="p">%</span><span class="n">x</span>
  <span class="n">summ</span><span class="p">%</span><span class="n">y</span> <span class="o">=</span> <span class="kt">real</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">R8P</span><span class="p">)</span> <span class="o">+</span> <span class="n">self</span><span class="p">%</span><span class="n">y</span>
  <span class="n">summ</span><span class="p">%</span><span class="n">z</span> <span class="o">=</span> <span class="kt">real</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">R8P</span><span class="p">)</span> <span class="o">+</span> <span class="n">self</span><span class="p">%</span><span class="n">z</span>
  <span class="k">return</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">endfunction</span> <span class="n">self_sum_ScalI8P</span>

  <span class="k">elemental function </span><span class="n">ScalI4P_sum_self</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">self</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">summ</span><span class="p">)</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="c">!&lt; Sum scalar (integer I4P) and self.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="kt">integer</span><span class="p">(</span><span class="n">I4P</span><span class="p">),</span>  <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">scal</span>
  <span class="k">class</span><span class="p">(</span><span class="n">Vector</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">self</span>
  <span class="k">type</span><span class="p">(</span><span class="n">Vector</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">summ</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>

  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">summ</span><span class="p">%</span><span class="n">x</span> <span class="o">=</span> <span class="kt">real</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">R8P</span><span class="p">)</span> <span class="o">+</span> <span class="n">self</span><span class="p">%</span><span class="n">x</span>
  <span class="n">summ</span><span class="p">%</span><span class="n">y</span> <span class="o">=</span> <span class="kt">real</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">R8P</span><span class="p">)</span> <span class="o">+</span> <span class="n">self</span><span class="p">%</span><span class="n">y</span>
  <span class="n">summ</span><span class="p">%</span><span class="n">z</span> <span class="o">=</span> <span class="kt">real</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">R8P</span><span class="p">)</span> <span class="o">+</span> <span class="n">self</span><span class="p">%</span><span class="n">z</span>
  <span class="k">return</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">endfunction</span> <span class="n">ScalI4P_sum_self</span>

  <span class="k">elemental function </span><span class="n">self_sum_ScalI4P</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">scal</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">summ</span><span class="p">)</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="c">!&lt; Sum self and scalar (integer I4P).</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="k">class</span><span class="p">(</span><span class="n">Vector</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">self</span>
  <span class="kt">integer</span><span class="p">(</span><span class="n">I4P</span><span class="p">),</span>  <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">scal</span>
  <span class="k">type</span><span class="p">(</span><span class="n">Vector</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">summ</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>

  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">summ</span><span class="p">%</span><span class="n">x</span> <span class="o">=</span> <span class="kt">real</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">R8P</span><span class="p">)</span> <span class="o">+</span> <span class="n">self</span><span class="p">%</span><span class="n">x</span>
  <span class="n">summ</span><span class="p">%</span><span class="n">y</span> <span class="o">=</span> <span class="kt">real</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">R8P</span><span class="p">)</span> <span class="o">+</span> <span class="n">self</span><span class="p">%</span><span class="n">y</span>
  <span class="n">summ</span><span class="p">%</span><span class="n">z</span> <span class="o">=</span> <span class="kt">real</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">R8P</span><span class="p">)</span> <span class="o">+</span> <span class="n">self</span><span class="p">%</span><span class="n">z</span>
  <span class="k">return</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">endfunction</span> <span class="n">self_sum_ScalI4P</span>

  <span class="k">elemental function </span><span class="n">ScalI2P_sum_self</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">self</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">summ</span><span class="p">)</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="c">!&lt; Sum scalar (integer I2P) and self.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="kt">integer</span><span class="p">(</span><span class="n">I2P</span><span class="p">),</span>  <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">scal</span>
  <span class="k">class</span><span class="p">(</span><span class="n">Vector</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">self</span>
  <span class="k">type</span><span class="p">(</span><span class="n">Vector</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">summ</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>

  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">summ</span><span class="p">%</span><span class="n">x</span> <span class="o">=</span> <span class="kt">real</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">R8P</span><span class="p">)</span> <span class="o">+</span> <span class="n">self</span><span class="p">%</span><span class="n">x</span>
  <span class="n">summ</span><span class="p">%</span><span class="n">y</span> <span class="o">=</span> <span class="kt">real</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">R8P</span><span class="p">)</span> <span class="o">+</span> <span class="n">self</span><span class="p">%</span><span class="n">y</span>
  <span class="n">summ</span><span class="p">%</span><span class="n">z</span> <span class="o">=</span> <span class="kt">real</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">R8P</span><span class="p">)</span> <span class="o">+</span> <span class="n">self</span><span class="p">%</span><span class="n">z</span>
  <span class="k">return</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">endfunction</span> <span class="n">ScalI2P_sum_self</span>

  <span class="k">elemental function </span><span class="n">self_sum_ScalI2P</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">scal</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">summ</span><span class="p">)</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="c">!&lt; Sum self and scalar (integer I2P).</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="k">class</span><span class="p">(</span><span class="n">Vector</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">self</span>
  <span class="kt">integer</span><span class="p">(</span><span class="n">I2P</span><span class="p">),</span>  <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">scal</span>
  <span class="k">type</span><span class="p">(</span><span class="n">Vector</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">summ</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>

  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">summ</span><span class="p">%</span><span class="n">x</span> <span class="o">=</span> <span class="kt">real</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">R8P</span><span class="p">)</span> <span class="o">+</span> <span class="n">self</span><span class="p">%</span><span class="n">x</span>
  <span class="n">summ</span><span class="p">%</span><span class="n">y</span> <span class="o">=</span> <span class="kt">real</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">R8P</span><span class="p">)</span> <span class="o">+</span> <span class="n">self</span><span class="p">%</span><span class="n">y</span>
  <span class="n">summ</span><span class="p">%</span><span class="n">z</span> <span class="o">=</span> <span class="kt">real</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">R8P</span><span class="p">)</span> <span class="o">+</span> <span class="n">self</span><span class="p">%</span><span class="n">z</span>
  <span class="k">return</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">endfunction</span> <span class="n">self_sum_ScalI2P</span>

  <span class="k">elemental function </span><span class="n">ScalI1P_sum_self</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">self</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">summ</span><span class="p">)</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="c">!&lt; Sum scalar (integer I1P) and self.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="kt">integer</span><span class="p">(</span><span class="n">I1P</span><span class="p">),</span>  <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">scal</span>
  <span class="k">class</span><span class="p">(</span><span class="n">Vector</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">self</span>
  <span class="k">type</span><span class="p">(</span><span class="n">Vector</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">summ</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>

  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">summ</span><span class="p">%</span><span class="n">x</span> <span class="o">=</span> <span class="kt">real</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">R8P</span><span class="p">)</span> <span class="o">+</span> <span class="n">self</span><span class="p">%</span><span class="n">x</span>
  <span class="n">summ</span><span class="p">%</span><span class="n">y</span> <span class="o">=</span> <span class="kt">real</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">R8P</span><span class="p">)</span> <span class="o">+</span> <span class="n">self</span><span class="p">%</span><span class="n">y</span>
  <span class="n">summ</span><span class="p">%</span><span class="n">z</span> <span class="o">=</span> <span class="kt">real</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">R8P</span><span class="p">)</span> <span class="o">+</span> <span class="n">self</span><span class="p">%</span><span class="n">z</span>
  <span class="k">return</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">endfunction</span> <span class="n">ScalI1P_sum_self</span>

  <span class="k">elemental function </span><span class="n">self_sum_ScalI1P</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">scal</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">summ</span><span class="p">)</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="c">!&lt; Sum self and scalar (integer I1P).</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="k">class</span><span class="p">(</span><span class="n">Vector</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">self</span>
  <span class="kt">integer</span><span class="p">(</span><span class="n">I1P</span><span class="p">),</span>  <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">scal</span>
  <span class="k">type</span><span class="p">(</span><span class="n">Vector</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">summ</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>

  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">summ</span><span class="p">%</span><span class="n">x</span> <span class="o">=</span> <span class="kt">real</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">R8P</span><span class="p">)</span> <span class="o">+</span> <span class="n">self</span><span class="p">%</span><span class="n">x</span>
  <span class="n">summ</span><span class="p">%</span><span class="n">y</span> <span class="o">=</span> <span class="kt">real</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">R8P</span><span class="p">)</span> <span class="o">+</span> <span class="n">self</span><span class="p">%</span><span class="n">y</span>
  <span class="n">summ</span><span class="p">%</span><span class="n">z</span> <span class="o">=</span> <span class="kt">real</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">R8P</span><span class="p">)</span> <span class="o">+</span> <span class="n">self</span><span class="p">%</span><span class="n">z</span>
  <span class="k">return</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">endfunction</span> <span class="n">self_sum_ScalI1P</span>

  <span class="c">! Operator (-)</span>
  <span class="k">elemental function </span><span class="n">negative_self</span><span class="p">(</span><span class="n">self</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">neg</span><span class="p">)</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="c">!&lt; Applay unary - to a self.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="k">class</span><span class="p">(</span><span class="n">Vector</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">self</span>
  <span class="k">type</span><span class="p">(</span><span class="n">Vector</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">neg</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>

  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">neg</span><span class="p">%</span><span class="n">x</span> <span class="o">=</span> <span class="o">-</span> <span class="n">self</span><span class="p">%</span><span class="n">x</span>
  <span class="n">neg</span><span class="p">%</span><span class="n">y</span> <span class="o">=</span> <span class="o">-</span> <span class="n">self</span><span class="p">%</span><span class="n">y</span>
  <span class="n">neg</span><span class="p">%</span><span class="n">z</span> <span class="o">=</span> <span class="o">-</span> <span class="n">self</span><span class="p">%</span><span class="n">z</span>
  <span class="k">return</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">endfunction</span> <span class="n">negative_self</span>

  <span class="k">elemental function </span><span class="n">self_sub_self</span><span class="p">(</span><span class="n">self1</span><span class="p">,</span> <span class="n">self2</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">sub</span><span class="p">)</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="c">!&lt; Subtract self and self.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="k">class</span><span class="p">(</span><span class="n">Vector</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">self1</span>
  <span class="k">type</span><span class="p">(</span><span class="n">Vector</span><span class="p">),</span>  <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">self2</span>
  <span class="k">type</span><span class="p">(</span><span class="n">Vector</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">sub</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>

  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">sub</span><span class="p">%</span><span class="n">x</span> <span class="o">=</span> <span class="n">self1</span><span class="p">%</span><span class="n">x</span> <span class="o">-</span> <span class="n">self2</span><span class="p">%</span><span class="n">x</span>
  <span class="n">sub</span><span class="p">%</span><span class="n">y</span> <span class="o">=</span> <span class="n">self1</span><span class="p">%</span><span class="n">y</span> <span class="o">-</span> <span class="n">self2</span><span class="p">%</span><span class="n">y</span>
  <span class="n">sub</span><span class="p">%</span><span class="n">z</span> <span class="o">=</span> <span class="n">self1</span><span class="p">%</span><span class="n">z</span> <span class="o">-</span> <span class="n">self2</span><span class="p">%</span><span class="n">z</span>
  <span class="k">return</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">endfunction</span> <span class="n">self_sub_self</span>

  <span class="k">elemental function </span><span class="n">ScalR16P_sub_self</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">self</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">sub</span><span class="p">)</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="c">!&lt; Subtract scalar (real R16P) and self.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="kt">real</span><span class="p">(</span><span class="n">R16P</span><span class="p">),</span>    <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">scal</span>
  <span class="k">class</span><span class="p">(</span><span class="n">Vector</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">self</span>
  <span class="k">type</span><span class="p">(</span><span class="n">Vector</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">sub</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>

  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">sub</span><span class="p">%</span><span class="n">x</span> <span class="o">=</span> <span class="kt">real</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">R8P</span><span class="p">)</span> <span class="o">-</span> <span class="n">self</span><span class="p">%</span><span class="n">x</span>
  <span class="n">sub</span><span class="p">%</span><span class="n">y</span> <span class="o">=</span> <span class="kt">real</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">R8P</span><span class="p">)</span> <span class="o">-</span> <span class="n">self</span><span class="p">%</span><span class="n">y</span>
  <span class="n">sub</span><span class="p">%</span><span class="n">z</span> <span class="o">=</span> <span class="kt">real</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">R8P</span><span class="p">)</span> <span class="o">-</span> <span class="n">self</span><span class="p">%</span><span class="n">z</span>
  <span class="k">return</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">endfunction</span> <span class="n">ScalR16P_sub_self</span>

  <span class="k">elemental function </span><span class="n">self_sub_ScalR16P</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">scal</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">sub</span><span class="p">)</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="c">!&lt; Subtract self and scalar (real R16P).</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="k">class</span><span class="p">(</span><span class="n">Vector</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">self</span>
  <span class="kt">real</span><span class="p">(</span><span class="n">R16P</span><span class="p">),</span>    <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">scal</span>
  <span class="k">type</span><span class="p">(</span><span class="n">Vector</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">sub</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>

  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">sub</span><span class="p">%</span><span class="n">x</span> <span class="o">=</span> <span class="n">self</span><span class="p">%</span><span class="n">x</span> <span class="o">-</span> <span class="kt">real</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">R8P</span><span class="p">)</span>
  <span class="n">sub</span><span class="p">%</span><span class="n">y</span> <span class="o">=</span> <span class="n">self</span><span class="p">%</span><span class="n">y</span> <span class="o">-</span> <span class="kt">real</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">R8P</span><span class="p">)</span>
  <span class="n">sub</span><span class="p">%</span><span class="n">z</span> <span class="o">=</span> <span class="n">self</span><span class="p">%</span><span class="n">z</span> <span class="o">-</span> <span class="kt">real</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">R8P</span><span class="p">)</span>
  <span class="k">return</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">endfunction</span> <span class="n">self_sub_ScalR16P</span>

  <span class="k">elemental function </span><span class="n">ScalR8P_sub_self</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">self</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">sub</span><span class="p">)</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="c">!&lt; Subtract scalar (real R8P) and self.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="kt">real</span><span class="p">(</span><span class="n">R8P</span><span class="p">),</span>     <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">scal</span>
  <span class="k">class</span><span class="p">(</span><span class="n">Vector</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">self</span>
  <span class="k">type</span><span class="p">(</span><span class="n">Vector</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">sub</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>

  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">sub</span><span class="p">%</span><span class="n">x</span> <span class="o">=</span> <span class="kt">real</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">R8P</span><span class="p">)</span> <span class="o">-</span> <span class="n">self</span><span class="p">%</span><span class="n">x</span>
  <span class="n">sub</span><span class="p">%</span><span class="n">y</span> <span class="o">=</span> <span class="kt">real</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">R8P</span><span class="p">)</span> <span class="o">-</span> <span class="n">self</span><span class="p">%</span><span class="n">y</span>
  <span class="n">sub</span><span class="p">%</span><span class="n">z</span> <span class="o">=</span> <span class="kt">real</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">R8P</span><span class="p">)</span> <span class="o">-</span> <span class="n">self</span><span class="p">%</span><span class="n">z</span>
  <span class="k">return</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">endfunction</span> <span class="n">ScalR8P_sub_self</span>

  <span class="k">elemental function </span><span class="n">self_sub_ScalR8P</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">scal</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">sub</span><span class="p">)</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="c">!&lt; Subtract self and scalar (real R8P).</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="k">class</span><span class="p">(</span><span class="n">Vector</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">self</span>
  <span class="kt">real</span><span class="p">(</span><span class="n">R8P</span><span class="p">),</span>     <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">scal</span>
  <span class="k">type</span><span class="p">(</span><span class="n">Vector</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">sub</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>

  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">sub</span><span class="p">%</span><span class="n">x</span> <span class="o">=</span> <span class="n">self</span><span class="p">%</span><span class="n">x</span> <span class="o">-</span> <span class="kt">real</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">R8P</span><span class="p">)</span>
  <span class="n">sub</span><span class="p">%</span><span class="n">y</span> <span class="o">=</span> <span class="n">self</span><span class="p">%</span><span class="n">y</span> <span class="o">-</span> <span class="kt">real</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">R8P</span><span class="p">)</span>
  <span class="n">sub</span><span class="p">%</span><span class="n">z</span> <span class="o">=</span> <span class="n">self</span><span class="p">%</span><span class="n">z</span> <span class="o">-</span> <span class="kt">real</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">R8P</span><span class="p">)</span>
  <span class="k">return</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">endfunction</span> <span class="n">self_sub_ScalR8P</span>

  <span class="k">elemental function </span><span class="n">ScalR4P_sub_self</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">self</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">sub</span><span class="p">)</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="c">!&lt; Subtract scalar (real R4P) and self.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="kt">real</span><span class="p">(</span><span class="n">R4P</span><span class="p">),</span>     <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">scal</span>
  <span class="k">class</span><span class="p">(</span><span class="n">Vector</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">self</span>
  <span class="k">type</span><span class="p">(</span><span class="n">Vector</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">sub</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>

  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">sub</span><span class="p">%</span><span class="n">x</span> <span class="o">=</span> <span class="kt">real</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">R8P</span><span class="p">)</span> <span class="o">-</span> <span class="n">self</span><span class="p">%</span><span class="n">x</span>
  <span class="n">sub</span><span class="p">%</span><span class="n">y</span> <span class="o">=</span> <span class="kt">real</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">R8P</span><span class="p">)</span> <span class="o">-</span> <span class="n">self</span><span class="p">%</span><span class="n">y</span>
  <span class="n">sub</span><span class="p">%</span><span class="n">z</span> <span class="o">=</span> <span class="kt">real</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">R8P</span><span class="p">)</span> <span class="o">-</span> <span class="n">self</span><span class="p">%</span><span class="n">z</span>
  <span class="k">return</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">endfunction</span> <span class="n">ScalR4P_sub_self</span>

  <span class="k">elemental function </span><span class="n">self_sub_ScalR4P</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">scal</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">sub</span><span class="p">)</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="c">!&lt; Subtract self and scalar (real R4P).</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="k">class</span><span class="p">(</span><span class="n">Vector</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">self</span>
  <span class="kt">real</span><span class="p">(</span><span class="n">R4P</span><span class="p">),</span>     <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">scal</span>
  <span class="k">type</span><span class="p">(</span><span class="n">Vector</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">sub</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>

  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">sub</span><span class="p">%</span><span class="n">x</span> <span class="o">=</span> <span class="n">self</span><span class="p">%</span><span class="n">x</span> <span class="o">-</span> <span class="kt">real</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">R8P</span><span class="p">)</span>
  <span class="n">sub</span><span class="p">%</span><span class="n">y</span> <span class="o">=</span> <span class="n">self</span><span class="p">%</span><span class="n">y</span> <span class="o">-</span> <span class="kt">real</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">R8P</span><span class="p">)</span>
  <span class="n">sub</span><span class="p">%</span><span class="n">z</span> <span class="o">=</span> <span class="n">self</span><span class="p">%</span><span class="n">z</span> <span class="o">-</span> <span class="kt">real</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">R8P</span><span class="p">)</span>
  <span class="k">return</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">endfunction</span> <span class="n">self_sub_ScalR4P</span>

  <span class="k">elemental function </span><span class="n">ScalI8P_sub_self</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">self</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">sub</span><span class="p">)</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="c">!&lt; Subtract scalar (integer I8P) and self.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="kt">integer</span><span class="p">(</span><span class="n">I8P</span><span class="p">),</span>  <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">scal</span>
  <span class="k">class</span><span class="p">(</span><span class="n">Vector</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">self</span>
  <span class="k">type</span><span class="p">(</span><span class="n">Vector</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">sub</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>

  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">sub</span><span class="p">%</span><span class="n">x</span> <span class="o">=</span> <span class="kt">real</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">R8P</span><span class="p">)</span> <span class="o">-</span> <span class="n">self</span><span class="p">%</span><span class="n">x</span>
  <span class="n">sub</span><span class="p">%</span><span class="n">y</span> <span class="o">=</span> <span class="kt">real</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">R8P</span><span class="p">)</span> <span class="o">-</span> <span class="n">self</span><span class="p">%</span><span class="n">y</span>
  <span class="n">sub</span><span class="p">%</span><span class="n">z</span> <span class="o">=</span> <span class="kt">real</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">R8P</span><span class="p">)</span> <span class="o">-</span> <span class="n">self</span><span class="p">%</span><span class="n">z</span>
  <span class="k">return</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">endfunction</span> <span class="n">ScalI8P_sub_self</span>

  <span class="k">elemental function </span><span class="n">self_sub_ScalI8P</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">scal</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">sub</span><span class="p">)</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="c">!&lt; Subtract self and scalar (integer I8P).</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="k">class</span><span class="p">(</span><span class="n">Vector</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">self</span>
  <span class="kt">integer</span><span class="p">(</span><span class="n">I8P</span><span class="p">),</span>  <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">scal</span>
  <span class="k">type</span><span class="p">(</span><span class="n">Vector</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">sub</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>

  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">sub</span><span class="p">%</span><span class="n">x</span> <span class="o">=</span> <span class="n">self</span><span class="p">%</span><span class="n">x</span> <span class="o">-</span> <span class="kt">real</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">R8P</span><span class="p">)</span>
  <span class="n">sub</span><span class="p">%</span><span class="n">y</span> <span class="o">=</span> <span class="n">self</span><span class="p">%</span><span class="n">y</span> <span class="o">-</span> <span class="kt">real</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">R8P</span><span class="p">)</span>
  <span class="n">sub</span><span class="p">%</span><span class="n">z</span> <span class="o">=</span> <span class="n">self</span><span class="p">%</span><span class="n">z</span> <span class="o">-</span> <span class="kt">real</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">R8P</span><span class="p">)</span>
  <span class="k">return</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">endfunction</span> <span class="n">self_sub_ScalI8P</span>

  <span class="k">elemental function </span><span class="n">ScalI4P_sub_self</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">self</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">sub</span><span class="p">)</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="c">!&lt; Subtract scalar (integer I4P) and self.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="kt">integer</span><span class="p">(</span><span class="n">I4P</span><span class="p">),</span>  <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">scal</span>
  <span class="k">class</span><span class="p">(</span><span class="n">Vector</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">self</span>
  <span class="k">type</span><span class="p">(</span><span class="n">Vector</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">sub</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>

  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">sub</span><span class="p">%</span><span class="n">x</span> <span class="o">=</span> <span class="kt">real</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">R8P</span><span class="p">)</span> <span class="o">-</span> <span class="n">self</span><span class="p">%</span><span class="n">x</span>
  <span class="n">sub</span><span class="p">%</span><span class="n">y</span> <span class="o">=</span> <span class="kt">real</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">R8P</span><span class="p">)</span> <span class="o">-</span> <span class="n">self</span><span class="p">%</span><span class="n">y</span>
  <span class="n">sub</span><span class="p">%</span><span class="n">z</span> <span class="o">=</span> <span class="kt">real</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">R8P</span><span class="p">)</span> <span class="o">-</span> <span class="n">self</span><span class="p">%</span><span class="n">z</span>
  <span class="k">return</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">endfunction</span> <span class="n">ScalI4P_sub_self</span>

  <span class="k">elemental function </span><span class="n">self_sub_ScalI4P</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">scal</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">sub</span><span class="p">)</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="c">!&lt; Subtract self and scalar (integer I4P).</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="k">class</span><span class="p">(</span><span class="n">Vector</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">self</span>
  <span class="kt">integer</span><span class="p">(</span><span class="n">I4P</span><span class="p">),</span>  <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">scal</span>
  <span class="k">type</span><span class="p">(</span><span class="n">Vector</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">sub</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>

  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">sub</span><span class="p">%</span><span class="n">x</span> <span class="o">=</span> <span class="n">self</span><span class="p">%</span><span class="n">x</span> <span class="o">-</span> <span class="kt">real</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">R8P</span><span class="p">)</span>
  <span class="n">sub</span><span class="p">%</span><span class="n">y</span> <span class="o">=</span> <span class="n">self</span><span class="p">%</span><span class="n">y</span> <span class="o">-</span> <span class="kt">real</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">R8P</span><span class="p">)</span>
  <span class="n">sub</span><span class="p">%</span><span class="n">z</span> <span class="o">=</span> <span class="n">self</span><span class="p">%</span><span class="n">z</span> <span class="o">-</span> <span class="kt">real</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">R8P</span><span class="p">)</span>
  <span class="k">return</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">endfunction</span> <span class="n">self_sub_ScalI4P</span>

  <span class="k">elemental function </span><span class="n">ScalI2P_sub_self</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">self</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">sub</span><span class="p">)</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="c">!&lt; Subtract scalar (integer I2P) and self.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="kt">integer</span><span class="p">(</span><span class="n">I2P</span><span class="p">),</span>  <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">scal</span>
  <span class="k">class</span><span class="p">(</span><span class="n">Vector</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">self</span>
  <span class="k">type</span><span class="p">(</span><span class="n">Vector</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">sub</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>

  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">sub</span><span class="p">%</span><span class="n">x</span> <span class="o">=</span> <span class="kt">real</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">R8P</span><span class="p">)</span> <span class="o">-</span> <span class="n">self</span><span class="p">%</span><span class="n">x</span>
  <span class="n">sub</span><span class="p">%</span><span class="n">y</span> <span class="o">=</span> <span class="kt">real</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">R8P</span><span class="p">)</span> <span class="o">-</span> <span class="n">self</span><span class="p">%</span><span class="n">y</span>
  <span class="n">sub</span><span class="p">%</span><span class="n">z</span> <span class="o">=</span> <span class="kt">real</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">R8P</span><span class="p">)</span> <span class="o">-</span> <span class="n">self</span><span class="p">%</span><span class="n">z</span>
  <span class="k">return</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">endfunction</span> <span class="n">ScalI2P_sub_self</span>

  <span class="k">elemental function </span><span class="n">self_sub_ScalI2P</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">scal</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">sub</span><span class="p">)</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="c">!&lt; Subtract self and scalar (integer I2P).</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="k">class</span><span class="p">(</span><span class="n">Vector</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">self</span>
  <span class="kt">integer</span><span class="p">(</span><span class="n">I2P</span><span class="p">),</span>  <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">scal</span>
  <span class="k">type</span><span class="p">(</span><span class="n">Vector</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">sub</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>

  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">sub</span><span class="p">%</span><span class="n">x</span> <span class="o">=</span> <span class="n">self</span><span class="p">%</span><span class="n">x</span> <span class="o">-</span> <span class="kt">real</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">R8P</span><span class="p">)</span>
  <span class="n">sub</span><span class="p">%</span><span class="n">y</span> <span class="o">=</span> <span class="n">self</span><span class="p">%</span><span class="n">y</span> <span class="o">-</span> <span class="kt">real</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">R8P</span><span class="p">)</span>
  <span class="n">sub</span><span class="p">%</span><span class="n">z</span> <span class="o">=</span> <span class="n">self</span><span class="p">%</span><span class="n">z</span> <span class="o">-</span> <span class="kt">real</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">R8P</span><span class="p">)</span>
  <span class="k">return</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">endfunction</span> <span class="n">self_sub_ScalI2P</span>

  <span class="k">elemental function </span><span class="n">ScalI1P_sub_self</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">self</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">sub</span><span class="p">)</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="c">!&lt; Subtract scalar (integer I1P) and self.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="kt">integer</span><span class="p">(</span><span class="n">I1P</span><span class="p">),</span>  <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">scal</span>
  <span class="k">class</span><span class="p">(</span><span class="n">Vector</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">self</span>
  <span class="k">type</span><span class="p">(</span><span class="n">Vector</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">sub</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>

  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">sub</span><span class="p">%</span><span class="n">x</span> <span class="o">=</span> <span class="kt">real</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">R8P</span><span class="p">)</span> <span class="o">-</span> <span class="n">self</span><span class="p">%</span><span class="n">x</span>
  <span class="n">sub</span><span class="p">%</span><span class="n">y</span> <span class="o">=</span> <span class="kt">real</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">R8P</span><span class="p">)</span> <span class="o">-</span> <span class="n">self</span><span class="p">%</span><span class="n">y</span>
  <span class="n">sub</span><span class="p">%</span><span class="n">z</span> <span class="o">=</span> <span class="kt">real</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">R8P</span><span class="p">)</span> <span class="o">-</span> <span class="n">self</span><span class="p">%</span><span class="n">z</span>
  <span class="k">return</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">endfunction</span> <span class="n">ScalI1P_sub_self</span>

  <span class="k">elemental function </span><span class="n">self_sub_ScalI1P</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">scal</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">sub</span><span class="p">)</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="c">!&lt; Subtract self and scalar (integer I1P).</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="k">class</span><span class="p">(</span><span class="n">Vector</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">self</span>
  <span class="kt">integer</span><span class="p">(</span><span class="n">I1P</span><span class="p">),</span>  <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">scal</span>
  <span class="k">type</span><span class="p">(</span><span class="n">Vector</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">sub</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>

  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">sub</span><span class="p">%</span><span class="n">x</span> <span class="o">=</span> <span class="n">self</span><span class="p">%</span><span class="n">x</span> <span class="o">-</span> <span class="kt">real</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">R8P</span><span class="p">)</span>
  <span class="n">sub</span><span class="p">%</span><span class="n">y</span> <span class="o">=</span> <span class="n">self</span><span class="p">%</span><span class="n">y</span> <span class="o">-</span> <span class="kt">real</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">R8P</span><span class="p">)</span>
  <span class="n">sub</span><span class="p">%</span><span class="n">z</span> <span class="o">=</span> <span class="n">self</span><span class="p">%</span><span class="n">z</span> <span class="o">-</span> <span class="kt">real</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">R8P</span><span class="p">)</span>
  <span class="k">return</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">endfunction</span> <span class="n">self_sub_ScalI1P</span>

  <span class="c">! Conditional operators</span>
  <span class="c">! Oprator /=</span>
  <span class="k">elemental function </span><span class="n">self_not_eq_self</span><span class="p">(</span><span class="n">self1</span><span class="p">,</span> <span class="n">self2</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">compare</span><span class="p">)</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="c">!&lt; Return .true. if the normL2 of the self1 is /= with respect the normL2 of self2 or if the directions of self1</span>
  <span class="c">!&lt; and self2 are different, .false. otherwise.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="k">class</span><span class="p">(</span><span class="n">Vector</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">self1</span>   <span class="c">!&lt; First selftor.</span>
  <span class="k">type</span><span class="p">(</span><span class="n">Vector</span><span class="p">),</span>  <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">self2</span>   <span class="c">!&lt; Second selftor.</span>
  <span class="kt">logical</span>                   <span class="kd">::</span> <span class="n">compare</span> <span class="c">!&lt; The result of the comparison.</span>
  <span class="k">type</span><span class="p">(</span><span class="n">Vector</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">n1</span>      <span class="c">!&lt; Normalizations of self1.</span>
  <span class="k">type</span><span class="p">(</span><span class="n">Vector</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">n2</span>      <span class="c">!&lt; Normalizations of self2.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>

  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">compare</span> <span class="o">=</span> <span class="p">(</span><span class="n">normL2</span><span class="p">(</span><span class="n">self1</span><span class="p">)</span><span class="o">/=</span><span class="n">normL2</span><span class="p">(</span><span class="n">self2</span><span class="p">))</span>
  <span class="k">if</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span><span class="n">compare</span><span class="p">)</span> <span class="k">then</span> <span class="c">! the normL2 are the same, checking the directions</span>
    <span class="n">n1</span> <span class="o">=</span> <span class="n">normalize</span><span class="p">(</span><span class="n">self1</span><span class="p">)</span>
    <span class="n">n2</span> <span class="o">=</span> <span class="n">normalize</span><span class="p">(</span><span class="n">self2</span><span class="p">)</span>
    <span class="n">compare</span> <span class="o">=</span> <span class="p">((</span><span class="n">n1</span><span class="p">%</span><span class="n">x</span><span class="o">/=</span><span class="n">n2</span><span class="p">%</span><span class="n">x</span><span class="p">).</span><span class="nb">OR</span><span class="p">.(</span><span class="n">n1</span><span class="p">%</span><span class="n">y</span><span class="o">/=</span><span class="n">n2</span><span class="p">%</span><span class="n">y</span><span class="p">).</span><span class="nb">OR</span><span class="p">.(</span><span class="n">n1</span><span class="p">%</span><span class="n">z</span><span class="o">/=</span><span class="n">n2</span><span class="p">%</span><span class="n">z</span><span class="p">))</span>
  <span class="n">endif</span>
  <span class="k">return</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">endfunction</span> <span class="n">self_not_eq_self</span>

  <span class="k">elemental function </span><span class="n">R16P_not_eq_self</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">self</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">compare</span><span class="p">)</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="c">!&lt; Return .true. if the normL2 of the self is /= with respect the value of scalar scal, .false. otherwise.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="kt">real</span><span class="p">(</span><span class="n">R16P</span><span class="p">),</span>    <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">scal</span>
  <span class="k">class</span><span class="p">(</span><span class="n">Vector</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">self</span>
  <span class="kt">logical</span>                   <span class="kd">::</span> <span class="n">compare</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>

  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">compare</span> <span class="o">=</span> <span class="p">(</span><span class="kt">real</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">R8P</span><span class="p">)</span><span class="o">/=</span><span class="n">normL2</span><span class="p">(</span><span class="n">self</span><span class="p">))</span>
  <span class="k">return</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">endfunction</span> <span class="n">R16P_not_eq_self</span>

  <span class="k">elemental function </span><span class="n">self_not_eq_R16P</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">scal</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">compare</span><span class="p">)</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="c">!&lt; Return .true. if the normL2 of the self is /= with respect the value of scalar scal, .false. otherwise.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="k">class</span><span class="p">(</span><span class="n">Vector</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">self</span>
  <span class="kt">real</span><span class="p">(</span><span class="n">R16P</span><span class="p">),</span>    <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">scal</span>
  <span class="kt">logical</span>                   <span class="kd">::</span> <span class="n">compare</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>

  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">compare</span> <span class="o">=</span> <span class="p">(</span><span class="kt">real</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">R8P</span><span class="p">)</span><span class="o">/=</span><span class="n">normL2</span><span class="p">(</span><span class="n">self</span><span class="p">))</span>
  <span class="k">return</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">endfunction</span> <span class="n">self_not_eq_R16P</span>

  <span class="k">elemental function </span><span class="n">R8P_not_eq_self</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">self</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">compare</span><span class="p">)</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="c">!&lt; Return .true. if the normL2 of the self is /= with respect the value of scalar scal, .false. otherwise.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="kt">real</span><span class="p">(</span><span class="n">R8P</span><span class="p">),</span>     <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">scal</span>
  <span class="k">class</span><span class="p">(</span><span class="n">Vector</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">self</span>
  <span class="kt">logical</span>                   <span class="kd">::</span> <span class="n">compare</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>

  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">compare</span> <span class="o">=</span> <span class="p">(</span><span class="kt">real</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">R8P</span><span class="p">)</span><span class="o">/=</span><span class="n">normL2</span><span class="p">(</span><span class="n">self</span><span class="p">))</span>
  <span class="k">return</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">endfunction</span> <span class="n">R8P_not_eq_self</span>

  <span class="k">elemental function </span><span class="n">self_not_eq_R8P</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">scal</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">compare</span><span class="p">)</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="c">!&lt; Return .true. if the normL2 of the self is /= with respect the value of scalar scal, .false. otherwise.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="k">class</span><span class="p">(</span><span class="n">Vector</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">self</span>
  <span class="kt">real</span><span class="p">(</span><span class="n">R8P</span><span class="p">),</span>     <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">scal</span>
  <span class="kt">logical</span>                   <span class="kd">::</span> <span class="n">compare</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>

  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">compare</span> <span class="o">=</span> <span class="p">(</span><span class="kt">real</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">R8P</span><span class="p">)</span><span class="o">/=</span><span class="n">normL2</span><span class="p">(</span><span class="n">self</span><span class="p">))</span>
  <span class="k">return</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">endfunction</span> <span class="n">self_not_eq_R8P</span>

  <span class="k">elemental function </span><span class="n">R4P_not_eq_self</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">self</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">compare</span><span class="p">)</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="c">!&lt; Return .true. if the normL2 of the self is /= with respect the value of scalar scal, .false. otherwise.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="kt">real</span><span class="p">(</span><span class="n">R4P</span><span class="p">),</span>     <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">scal</span>
  <span class="k">class</span><span class="p">(</span><span class="n">Vector</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">self</span>
  <span class="kt">logical</span>                   <span class="kd">::</span> <span class="n">compare</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>

  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">compare</span> <span class="o">=</span> <span class="p">(</span><span class="kt">real</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">R8P</span><span class="p">)</span><span class="o">/=</span><span class="n">normL2</span><span class="p">(</span><span class="n">self</span><span class="p">))</span>
  <span class="k">return</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">endfunction</span> <span class="n">R4P_not_eq_self</span>

  <span class="k">elemental function </span><span class="n">self_not_eq_R4P</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">scal</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">compare</span><span class="p">)</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="c">!&lt; Return .true. if the normL2 of the self is /= with respect the value of scalar scal, .false. otherwise.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="k">class</span><span class="p">(</span><span class="n">Vector</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">self</span>
  <span class="kt">real</span><span class="p">(</span><span class="n">R4P</span><span class="p">),</span>     <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">scal</span>
  <span class="kt">logical</span>                   <span class="kd">::</span> <span class="n">compare</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>

  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">compare</span> <span class="o">=</span> <span class="p">(</span><span class="kt">real</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">R8P</span><span class="p">)</span><span class="o">/=</span><span class="n">normL2</span><span class="p">(</span><span class="n">self</span><span class="p">))</span>
  <span class="k">return</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">endfunction</span> <span class="n">self_not_eq_R4P</span>

  <span class="k">elemental function </span><span class="n">I8P_not_eq_self</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">self</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">compare</span><span class="p">)</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="c">!&lt; Return .true. if the normL2 of the self is /= with respect the value of scalar scal, .false. otherwise.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="kt">integer</span><span class="p">(</span><span class="n">I8P</span><span class="p">),</span>  <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">scal</span>
  <span class="k">class</span><span class="p">(</span><span class="n">Vector</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">self</span>
  <span class="kt">logical</span>                   <span class="kd">::</span> <span class="n">compare</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>

  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">compare</span> <span class="o">=</span> <span class="p">(</span><span class="kt">real</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">R8P</span><span class="p">)</span><span class="o">/=</span><span class="n">normL2</span><span class="p">(</span><span class="n">self</span><span class="p">))</span>
  <span class="k">return</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">endfunction</span> <span class="n">I8P_not_eq_self</span>

  <span class="k">elemental function </span><span class="n">self_not_eq_I8P</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">scal</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">compare</span><span class="p">)</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="c">!&lt; Return .true. if the normL2 of the self is /= with respect the value of scalar scal, .false. otherwise.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="k">class</span><span class="p">(</span><span class="n">Vector</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">self</span>
  <span class="kt">integer</span><span class="p">(</span><span class="n">I8P</span><span class="p">),</span>  <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">scal</span>
  <span class="kt">logical</span>                   <span class="kd">::</span> <span class="n">compare</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>

  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">compare</span> <span class="o">=</span> <span class="p">(</span><span class="kt">real</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">R8P</span><span class="p">)</span><span class="o">/=</span><span class="n">normL2</span><span class="p">(</span><span class="n">self</span><span class="p">))</span>
  <span class="k">return</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">endfunction</span> <span class="n">self_not_eq_I8P</span>

  <span class="k">elemental function </span><span class="n">I4P_not_eq_self</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">self</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">compare</span><span class="p">)</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="c">!&lt; Return .true. if the normL2 of the self is /= with respect the value of scalar scal, .false. otherwise.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="kt">integer</span><span class="p">(</span><span class="n">I4P</span><span class="p">),</span>  <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">scal</span>
  <span class="k">class</span><span class="p">(</span><span class="n">Vector</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">self</span>
  <span class="kt">logical</span>                   <span class="kd">::</span> <span class="n">compare</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>

  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">compare</span> <span class="o">=</span> <span class="p">(</span><span class="kt">real</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">R8P</span><span class="p">)</span><span class="o">/=</span><span class="n">normL2</span><span class="p">(</span><span class="n">self</span><span class="p">))</span>
  <span class="k">return</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">endfunction</span> <span class="n">I4P_not_eq_self</span>

  <span class="k">elemental function </span><span class="n">self_not_eq_I4P</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">scal</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">compare</span><span class="p">)</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="c">!&lt; Return .true. if the normL2 of the self is /= with respect the value of scalar scal, .false. otherwise.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="k">class</span><span class="p">(</span><span class="n">Vector</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">self</span>
  <span class="kt">integer</span><span class="p">(</span><span class="n">I4P</span><span class="p">),</span>  <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">scal</span>
  <span class="kt">logical</span>                   <span class="kd">::</span> <span class="n">compare</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>

  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">compare</span> <span class="o">=</span> <span class="p">(</span><span class="kt">real</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">R8P</span><span class="p">)</span><span class="o">/=</span><span class="n">normL2</span><span class="p">(</span><span class="n">self</span><span class="p">))</span>
  <span class="k">return</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">endfunction</span> <span class="n">self_not_eq_I4P</span>

  <span class="k">elemental function </span><span class="n">I2P_not_eq_self</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">self</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">compare</span><span class="p">)</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="c">!&lt; Return .true. if the normL2 of the self is /= with respect the value of scalar scal, .false. otherwise.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="kt">integer</span><span class="p">(</span><span class="n">I2P</span><span class="p">),</span>  <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">scal</span>
  <span class="k">class</span><span class="p">(</span><span class="n">Vector</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">self</span>
  <span class="kt">logical</span>                   <span class="kd">::</span> <span class="n">compare</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>

  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">compare</span> <span class="o">=</span> <span class="p">(</span><span class="kt">real</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">R8P</span><span class="p">)</span><span class="o">/=</span><span class="n">normL2</span><span class="p">(</span><span class="n">self</span><span class="p">))</span>
  <span class="k">return</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">endfunction</span> <span class="n">I2P_not_eq_self</span>

  <span class="k">elemental function </span><span class="n">self_not_eq_I2P</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">scal</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">compare</span><span class="p">)</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="c">!&lt; Return .true. if the normL2 of the self is /= with respect the value of scalar scal, .false. otherwise.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="k">class</span><span class="p">(</span><span class="n">Vector</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">self</span>
  <span class="kt">integer</span><span class="p">(</span><span class="n">I2P</span><span class="p">),</span>  <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">scal</span>
  <span class="kt">logical</span>                   <span class="kd">::</span> <span class="n">compare</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>

  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">compare</span> <span class="o">=</span> <span class="p">(</span><span class="kt">real</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">R8P</span><span class="p">)</span><span class="o">/=</span><span class="n">normL2</span><span class="p">(</span><span class="n">self</span><span class="p">))</span>
  <span class="k">return</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">endfunction</span> <span class="n">self_not_eq_I2P</span>

  <span class="k">elemental function </span><span class="n">I1P_not_eq_self</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">self</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">compare</span><span class="p">)</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="c">!&lt; Return .true. if the normL2 of the self is /= with respect the value of scalar scal, .false. otherwise.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="kt">integer</span><span class="p">(</span><span class="n">I1P</span><span class="p">),</span>  <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">scal</span>
  <span class="k">class</span><span class="p">(</span><span class="n">Vector</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">self</span>
  <span class="kt">logical</span>                   <span class="kd">::</span> <span class="n">compare</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>

  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">compare</span> <span class="o">=</span> <span class="p">(</span><span class="kt">real</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">R8P</span><span class="p">)</span><span class="o">/=</span><span class="n">normL2</span><span class="p">(</span><span class="n">self</span><span class="p">))</span>
  <span class="k">return</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">endfunction</span> <span class="n">I1P_not_eq_self</span>

  <span class="k">elemental function </span><span class="n">self_not_eq_I1P</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">scal</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">compare</span><span class="p">)</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="c">!&lt; Return .true. if the normL2 of the self is /= with respect the value of scalar scal, .false. otherwise.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="k">class</span><span class="p">(</span><span class="n">Vector</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">self</span>
  <span class="kt">integer</span><span class="p">(</span><span class="n">I1P</span><span class="p">),</span>  <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">scal</span>
  <span class="kt">logical</span>                   <span class="kd">::</span> <span class="n">compare</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>

  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">compare</span> <span class="o">=</span> <span class="p">(</span><span class="kt">real</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">R8P</span><span class="p">)</span><span class="o">/=</span><span class="n">normL2</span><span class="p">(</span><span class="n">self</span><span class="p">))</span>
  <span class="k">return</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">endfunction</span> <span class="n">self_not_eq_I1P</span>

  <span class="c">! Oprator &lt;</span>
  <span class="k">elemental function </span><span class="n">self_low_self</span><span class="p">(</span><span class="n">self1</span><span class="p">,</span> <span class="n">self2</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">compare</span><span class="p">)</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="c">!&lt; Return .true. if the normL2 of the self1 is &lt; with respect the normL2 of self2, .false. otherwise.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="k">class</span><span class="p">(</span><span class="n">Vector</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">self1</span>
  <span class="k">type</span><span class="p">(</span><span class="n">Vector</span><span class="p">),</span>  <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">self2</span>
  <span class="kt">logical</span>                   <span class="kd">::</span> <span class="n">compare</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>

  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">compare</span> <span class="o">=</span> <span class="p">(</span><span class="n">normL2</span><span class="p">(</span><span class="n">self1</span><span class="p">)</span><span class="o">&lt;</span><span class="n">normL2</span><span class="p">(</span><span class="n">self2</span><span class="p">))</span>
  <span class="k">return</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">endfunction</span> <span class="n">self_low_self</span>

  <span class="k">elemental function </span><span class="n">R16P_low_self</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">self</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">compare</span><span class="p">)</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="c">!&lt; Return .true. if the normL2 of the self1 is &lt; with respect the  value of scalar scal, .false. otherwise.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="kt">real</span><span class="p">(</span><span class="n">R16P</span><span class="p">),</span>    <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">scal</span>
  <span class="k">class</span><span class="p">(</span><span class="n">Vector</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">self</span>
  <span class="kt">logical</span>                   <span class="kd">::</span> <span class="n">compare</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>

  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">compare</span> <span class="o">=</span> <span class="p">(</span><span class="kt">real</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">R8P</span><span class="p">)</span><span class="o">&lt;</span><span class="n">normL2</span><span class="p">(</span><span class="n">self</span><span class="p">))</span>
  <span class="k">return</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">endfunction</span> <span class="n">R16P_low_self</span>

  <span class="k">elemental function </span><span class="n">self_low_R16P</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">scal</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">compare</span><span class="p">)</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="c">!&lt; Return .true. if the normL2 of the self1 is &lt; with respect the  value of scalar scal, .false. otherwise.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="k">class</span><span class="p">(</span><span class="n">Vector</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">self</span>
  <span class="kt">real</span><span class="p">(</span><span class="n">R16P</span><span class="p">),</span>    <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">scal</span>
  <span class="kt">logical</span>                   <span class="kd">::</span> <span class="n">compare</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>

  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">compare</span> <span class="o">=</span> <span class="p">(</span><span class="n">normL2</span><span class="p">(</span><span class="n">self</span><span class="p">)</span><span class="o">&lt;</span><span class="kt">real</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">R8P</span><span class="p">))</span>
  <span class="k">return</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">endfunction</span> <span class="n">self_low_R16P</span>

  <span class="k">elemental function </span><span class="n">R8P_low_self</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">self</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">compare</span><span class="p">)</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="c">!&lt; Return .true. if the normL2 of the self1 is &lt; with respect the  value of scalar scal, .false. otherwise.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="kt">real</span><span class="p">(</span><span class="n">R8P</span><span class="p">),</span>     <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">scal</span>
  <span class="k">class</span><span class="p">(</span><span class="n">Vector</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">self</span>
  <span class="kt">logical</span>                   <span class="kd">::</span> <span class="n">compare</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>

  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">compare</span> <span class="o">=</span> <span class="p">(</span><span class="kt">real</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">R8P</span><span class="p">)</span><span class="o">&lt;</span><span class="n">normL2</span><span class="p">(</span><span class="n">self</span><span class="p">))</span>
  <span class="k">return</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">endfunction</span> <span class="n">R8P_low_self</span>

  <span class="k">elemental function </span><span class="n">self_low_R8P</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">scal</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">compare</span><span class="p">)</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="c">!&lt; Return .true. if the normL2 of the self1 is &lt; with respect the  value of scalar scal, .false. otherwise.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="k">class</span><span class="p">(</span><span class="n">Vector</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">self</span>
  <span class="kt">real</span><span class="p">(</span><span class="n">R8P</span><span class="p">),</span>     <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">scal</span>
  <span class="kt">logical</span>                   <span class="kd">::</span> <span class="n">compare</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>

  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">compare</span> <span class="o">=</span> <span class="p">(</span><span class="n">normL2</span><span class="p">(</span><span class="n">self</span><span class="p">)</span><span class="o">&lt;</span><span class="kt">real</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">R8P</span><span class="p">))</span>
  <span class="k">return</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">endfunction</span> <span class="n">self_low_R8P</span>

  <span class="k">elemental function </span><span class="n">R4P_low_self</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">self</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">compare</span><span class="p">)</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="c">!&lt; Return .true. if the normL2 of the self1 is &lt; with respect the  value of scalar scal, .false. otherwise.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="kt">real</span><span class="p">(</span><span class="n">R4P</span><span class="p">),</span>     <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">scal</span>
  <span class="k">class</span><span class="p">(</span><span class="n">Vector</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">self</span>
  <span class="kt">logical</span>                   <span class="kd">::</span> <span class="n">compare</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>

  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">compare</span> <span class="o">=</span> <span class="p">(</span><span class="kt">real</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">R8P</span><span class="p">)</span><span class="o">&lt;</span><span class="n">normL2</span><span class="p">(</span><span class="n">self</span><span class="p">))</span>
  <span class="k">return</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">endfunction</span> <span class="n">R4P_low_self</span>

  <span class="k">elemental function </span><span class="n">self_low_R4P</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">scal</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">compare</span><span class="p">)</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="c">!&lt; Return .true. if the normL2 of the self1 is &lt; with respect the  value of scalar scal, .false. otherwise.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="k">class</span><span class="p">(</span><span class="n">Vector</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">self</span>
  <span class="kt">real</span><span class="p">(</span><span class="n">R4P</span><span class="p">),</span>     <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">scal</span>
  <span class="kt">logical</span>                   <span class="kd">::</span> <span class="n">compare</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>

  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">compare</span> <span class="o">=</span> <span class="p">(</span><span class="n">normL2</span><span class="p">(</span><span class="n">self</span><span class="p">)</span><span class="o">&lt;</span><span class="kt">real</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">R8P</span><span class="p">))</span>
  <span class="k">return</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">endfunction</span> <span class="n">self_low_R4P</span>

  <span class="k">elemental function </span><span class="n">I8P_low_self</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">self</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">compare</span><span class="p">)</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="c">!&lt; Return .true. if the normL2 of the self1 is &lt; with respect the  value of scalar scal, .false. otherwise.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="kt">integer</span><span class="p">(</span><span class="n">I8P</span><span class="p">),</span>  <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">scal</span>
  <span class="k">class</span><span class="p">(</span><span class="n">Vector</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">self</span>
  <span class="kt">logical</span>                   <span class="kd">::</span> <span class="n">compare</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>

  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">compare</span> <span class="o">=</span> <span class="p">(</span><span class="kt">real</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">R8P</span><span class="p">)</span><span class="o">&lt;</span><span class="n">normL2</span><span class="p">(</span><span class="n">self</span><span class="p">))</span>
  <span class="k">return</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">endfunction</span> <span class="n">I8P_low_self</span>

  <span class="k">elemental function </span><span class="n">self_low_I8P</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">scal</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">compare</span><span class="p">)</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="c">!&lt; Return .true. if the normL2 of the self1 is &lt; with respect the  value of scalar scal, .false. otherwise.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="k">class</span><span class="p">(</span><span class="n">Vector</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">self</span>
  <span class="kt">integer</span><span class="p">(</span><span class="n">I8P</span><span class="p">),</span>  <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">scal</span>
  <span class="kt">logical</span>                   <span class="kd">::</span> <span class="n">compare</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>

  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">compare</span> <span class="o">=</span> <span class="p">(</span><span class="n">normL2</span><span class="p">(</span><span class="n">self</span><span class="p">)</span><span class="o">&lt;</span><span class="kt">real</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">R8P</span><span class="p">))</span>
  <span class="k">return</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">endfunction</span> <span class="n">self_low_I8P</span>

  <span class="k">elemental function </span><span class="n">I4P_low_self</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">self</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">compare</span><span class="p">)</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="c">!&lt; Return .true. if the normL2 of the self1 is &lt; with respect the  value of scalar scal, .false. otherwise.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="kt">integer</span><span class="p">(</span><span class="n">I4P</span><span class="p">),</span>  <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">scal</span>
  <span class="k">class</span><span class="p">(</span><span class="n">Vector</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">self</span>
  <span class="kt">logical</span>                   <span class="kd">::</span> <span class="n">compare</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>

  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">compare</span> <span class="o">=</span> <span class="p">(</span><span class="kt">real</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">R8P</span><span class="p">)</span><span class="o">&lt;</span><span class="n">normL2</span><span class="p">(</span><span class="n">self</span><span class="p">))</span>
  <span class="k">return</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">endfunction</span> <span class="n">I4P_low_self</span>

  <span class="k">elemental function </span><span class="n">self_low_I4P</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">scal</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">compare</span><span class="p">)</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="c">!&lt; Return .true. if the normL2 of the self1 is &lt; with respect the  value of scalar scal, .false. otherwise.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="k">class</span><span class="p">(</span><span class="n">Vector</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">self</span>
  <span class="kt">integer</span><span class="p">(</span><span class="n">I4P</span><span class="p">),</span>  <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">scal</span>
  <span class="kt">logical</span>                   <span class="kd">::</span> <span class="n">compare</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>

  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">compare</span> <span class="o">=</span> <span class="p">(</span><span class="n">normL2</span><span class="p">(</span><span class="n">self</span><span class="p">)</span><span class="o">&lt;</span><span class="kt">real</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">R8P</span><span class="p">))</span>
  <span class="k">return</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">endfunction</span> <span class="n">self_low_I4P</span>

  <span class="k">elemental function </span><span class="n">I2P_low_self</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">self</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">compare</span><span class="p">)</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="c">!&lt; Return .true. if the normL2 of the self1 is &lt; with respect the  value of scalar scal, .false. otherwise.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="kt">integer</span><span class="p">(</span><span class="n">I2P</span><span class="p">),</span>  <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">scal</span>
  <span class="k">class</span><span class="p">(</span><span class="n">Vector</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">self</span>
  <span class="kt">logical</span>                   <span class="kd">::</span> <span class="n">compare</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>

  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">compare</span> <span class="o">=</span> <span class="p">(</span><span class="kt">real</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">R8P</span><span class="p">)</span><span class="o">&lt;</span><span class="n">normL2</span><span class="p">(</span><span class="n">self</span><span class="p">))</span>
  <span class="k">return</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">endfunction</span> <span class="n">I2P_low_self</span>

  <span class="k">elemental function </span><span class="n">self_low_I2P</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">scal</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">compare</span><span class="p">)</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="c">!&lt; Return .true. if the normL2 of the self1 is &lt; with respect the  value of scalar scal, .false. otherwise.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="k">class</span><span class="p">(</span><span class="n">Vector</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">self</span>
  <span class="kt">integer</span><span class="p">(</span><span class="n">I2P</span><span class="p">),</span>  <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">scal</span>
  <span class="kt">logical</span>                   <span class="kd">::</span> <span class="n">compare</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>

  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">compare</span> <span class="o">=</span> <span class="p">(</span><span class="n">normL2</span><span class="p">(</span><span class="n">self</span><span class="p">)</span><span class="o">&lt;</span><span class="kt">real</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">R8P</span><span class="p">))</span>
  <span class="k">return</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">endfunction</span> <span class="n">self_low_I2P</span>

  <span class="k">elemental function </span><span class="n">I1P_low_self</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">self</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">compare</span><span class="p">)</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="c">!&lt; Return .true. if the normL2 of the self1 is &lt; with respect the  value of scalar scal, .false. otherwise.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="kt">integer</span><span class="p">(</span><span class="n">I1P</span><span class="p">),</span>  <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">scal</span>
  <span class="k">class</span><span class="p">(</span><span class="n">Vector</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">self</span>
  <span class="kt">logical</span>                   <span class="kd">::</span> <span class="n">compare</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>

  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">compare</span> <span class="o">=</span> <span class="p">(</span><span class="kt">real</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">R8P</span><span class="p">)</span><span class="o">&lt;</span><span class="n">normL2</span><span class="p">(</span><span class="n">self</span><span class="p">))</span>
  <span class="k">return</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">endfunction</span> <span class="n">I1P_low_self</span>

  <span class="k">elemental function </span><span class="n">self_low_I1P</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">scal</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">compare</span><span class="p">)</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="c">!&lt; Return .true. if the normL2 of the self1 is &lt; with respect the  value of scalar scal, .false. otherwise.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="k">class</span><span class="p">(</span><span class="n">Vector</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">self</span>
  <span class="kt">integer</span><span class="p">(</span><span class="n">I1P</span><span class="p">),</span>  <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">scal</span>
  <span class="kt">logical</span>                   <span class="kd">::</span> <span class="n">compare</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>

  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">compare</span> <span class="o">=</span> <span class="p">(</span><span class="n">normL2</span><span class="p">(</span><span class="n">self</span><span class="p">)</span><span class="o">&lt;</span><span class="kt">real</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">R8P</span><span class="p">))</span>
  <span class="k">return</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">endfunction</span> <span class="n">self_low_I1P</span>

  <span class="c">! Oprator &lt;=</span>
  <span class="k">elemental function </span><span class="n">self_low_eq_self</span><span class="p">(</span><span class="n">self1</span><span class="p">,</span> <span class="n">self2</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">compare</span><span class="p">)</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="c">!&lt; Return .true. if the normL2 of the self1 is &lt;= with respect the normL2 of self2, .false. otherwise.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="k">class</span><span class="p">(</span><span class="n">Vector</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">self1</span>   <span class="c">! First selftor.</span>
  <span class="k">type</span><span class="p">(</span><span class="n">Vector</span><span class="p">),</span>  <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">self2</span>   <span class="c">! Second selftor.</span>
  <span class="kt">logical</span>                   <span class="kd">::</span> <span class="n">compare</span> <span class="c">! The result of the comparison.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>

  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">compare</span> <span class="o">=</span> <span class="p">(</span><span class="n">normL2</span><span class="p">(</span><span class="n">self1</span><span class="p">)</span><span class="o">&lt;=</span><span class="n">normL2</span><span class="p">(</span><span class="n">self2</span><span class="p">))</span>
  <span class="k">return</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">endfunction</span> <span class="n">self_low_eq_self</span>

  <span class="k">elemental function </span><span class="n">R16P_low_eq_self</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">self</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">compare</span><span class="p">)</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="c">!&lt; Return .true. if the normL2 of the self1 is &lt;= with respect the  value of scalar scal, .false. otherwise.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="kt">real</span><span class="p">(</span><span class="n">R16P</span><span class="p">),</span>    <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">scal</span>    <span class="c">! Scalar.</span>
  <span class="k">class</span><span class="p">(</span><span class="n">Vector</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">self</span>    <span class="c">! Vector.</span>
  <span class="kt">logical</span>                   <span class="kd">::</span> <span class="n">compare</span> <span class="c">! The result of the comparison.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>

  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">compare</span> <span class="o">=</span> <span class="p">(</span><span class="kt">real</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">R8P</span><span class="p">)</span><span class="o">&lt;=</span><span class="n">normL2</span><span class="p">(</span><span class="n">self</span><span class="p">))</span>
  <span class="k">return</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">endfunction</span> <span class="n">R16P_low_eq_self</span>

  <span class="k">elemental function </span><span class="n">self_low_eq_R16P</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">scal</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">compare</span><span class="p">)</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="c">!&lt; Return .true. if the normL2 of the self1 is &lt;= with respect the  value of scalar scal, .false. otherwise.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="k">class</span><span class="p">(</span><span class="n">Vector</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">self</span>    <span class="c">! Vector.</span>
  <span class="kt">real</span><span class="p">(</span><span class="n">R16P</span><span class="p">),</span>    <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">scal</span>    <span class="c">! Scalar.</span>
  <span class="kt">logical</span>                   <span class="kd">::</span> <span class="n">compare</span> <span class="c">! The result of the comparison.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>

  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">compare</span> <span class="o">=</span> <span class="p">(</span><span class="n">normL2</span><span class="p">(</span><span class="n">self</span><span class="p">)</span><span class="o">&lt;=</span><span class="kt">real</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">R8P</span><span class="p">))</span>
  <span class="k">return</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">endfunction</span> <span class="n">self_low_eq_R16P</span>

  <span class="k">elemental function </span><span class="n">R8P_low_eq_self</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">self</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">compare</span><span class="p">)</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="c">!&lt; Return .true. if the normL2 of the self1 is &lt;= with respect the  value of scalar scal, .false. otherwise.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="kt">real</span><span class="p">(</span><span class="n">R8P</span><span class="p">),</span>     <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">scal</span>    <span class="c">! Scalar.</span>
  <span class="k">class</span><span class="p">(</span><span class="n">Vector</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">self</span>    <span class="c">! Vector.</span>
  <span class="kt">logical</span>                   <span class="kd">::</span> <span class="n">compare</span> <span class="c">! The result of the comparison.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>

  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">compare</span> <span class="o">=</span> <span class="p">(</span><span class="kt">real</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">R8P</span><span class="p">)</span><span class="o">&lt;=</span><span class="n">normL2</span><span class="p">(</span><span class="n">self</span><span class="p">))</span>
  <span class="k">return</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">endfunction</span> <span class="n">R8P_low_eq_self</span>

  <span class="k">elemental function </span><span class="n">self_low_eq_R8P</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">scal</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">compare</span><span class="p">)</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="c">!&lt; Return .true. if the normL2 of the self1 is &lt;= with respect the  value of scalar scal, .false. otherwise.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="k">class</span><span class="p">(</span><span class="n">Vector</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">self</span>    <span class="c">! Vector.</span>
  <span class="kt">real</span><span class="p">(</span><span class="n">R8P</span><span class="p">),</span>     <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">scal</span>    <span class="c">! Scalar.</span>
  <span class="kt">logical</span>                   <span class="kd">::</span> <span class="n">compare</span> <span class="c">! The result of the comparison.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>

  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">compare</span> <span class="o">=</span> <span class="p">(</span><span class="n">normL2</span><span class="p">(</span><span class="n">self</span><span class="p">)</span><span class="o">&lt;=</span><span class="kt">real</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">R8P</span><span class="p">))</span>
  <span class="k">return</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">endfunction</span> <span class="n">self_low_eq_R8P</span>

  <span class="k">elemental function </span><span class="n">R4P_low_eq_self</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">self</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">compare</span><span class="p">)</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="c">!&lt; Return .true. if the normL2 of the self1 is &lt;= with respect the  value of scalar scal, .false. otherwise.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="kt">real</span><span class="p">(</span><span class="n">R4P</span><span class="p">),</span>     <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">scal</span>    <span class="c">! Scalar.</span>
  <span class="k">class</span><span class="p">(</span><span class="n">Vector</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">self</span>    <span class="c">! Vector.</span>
  <span class="kt">logical</span>                   <span class="kd">::</span> <span class="n">compare</span> <span class="c">! The result of the comparison.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>

  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">compare</span> <span class="o">=</span> <span class="p">(</span><span class="kt">real</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">R8P</span><span class="p">)</span><span class="o">&lt;=</span><span class="n">normL2</span><span class="p">(</span><span class="n">self</span><span class="p">))</span>
  <span class="k">return</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">endfunction</span> <span class="n">R4P_low_eq_self</span>

  <span class="k">elemental function </span><span class="n">self_low_eq_R4P</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">scal</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">compare</span><span class="p">)</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="c">!&lt; Return .true. if the normL2 of the self1 is &lt;= with respect the  value of scalar scal, .false. otherwise.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="k">class</span><span class="p">(</span><span class="n">Vector</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">self</span>    <span class="c">! Vector.</span>
  <span class="kt">real</span><span class="p">(</span><span class="n">R4P</span><span class="p">),</span>     <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">scal</span>    <span class="c">! Scalar.</span>
  <span class="kt">logical</span>                   <span class="kd">::</span> <span class="n">compare</span> <span class="c">! The result of the comparison.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>

  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">compare</span> <span class="o">=</span> <span class="p">(</span><span class="n">normL2</span><span class="p">(</span><span class="n">self</span><span class="p">)</span><span class="o">&lt;=</span><span class="kt">real</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">R8P</span><span class="p">))</span>
  <span class="k">return</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">endfunction</span> <span class="n">self_low_eq_R4P</span>

  <span class="k">elemental function </span><span class="n">I8P_low_eq_self</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">self</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">compare</span><span class="p">)</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="c">!&lt; Return .true. if the normL2 of the self1 is &lt;= with respect the  value of scalar scal, .false. otherwise.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="kt">integer</span><span class="p">(</span><span class="n">I8P</span><span class="p">),</span>  <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">scal</span>    <span class="c">! Scalar.</span>
  <span class="k">class</span><span class="p">(</span><span class="n">Vector</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">self</span>    <span class="c">! Vector.</span>
  <span class="kt">logical</span>                   <span class="kd">::</span> <span class="n">compare</span> <span class="c">! The result of the comparison.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>

  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">compare</span> <span class="o">=</span> <span class="p">(</span><span class="kt">real</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">R8P</span><span class="p">)</span><span class="o">&lt;=</span><span class="n">normL2</span><span class="p">(</span><span class="n">self</span><span class="p">))</span>
  <span class="k">return</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">endfunction</span> <span class="n">I8P_low_eq_self</span>

  <span class="k">elemental function </span><span class="n">self_low_eq_I8P</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">scal</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">compare</span><span class="p">)</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="c">!&lt; Return .true. if the normL2 of the self1 is &lt;= with respect the  value of scalar scal, .false. otherwise.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="k">class</span><span class="p">(</span><span class="n">Vector</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">self</span>    <span class="c">! Vector.</span>
  <span class="kt">integer</span><span class="p">(</span><span class="n">I8P</span><span class="p">),</span>  <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">scal</span>    <span class="c">! Scalar.</span>
  <span class="kt">logical</span>                   <span class="kd">::</span> <span class="n">compare</span> <span class="c">! The result of the comparison.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>

  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">compare</span> <span class="o">=</span> <span class="p">(</span><span class="n">normL2</span><span class="p">(</span><span class="n">self</span><span class="p">)</span><span class="o">&lt;=</span><span class="kt">real</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">R8P</span><span class="p">))</span>
  <span class="k">return</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">endfunction</span> <span class="n">self_low_eq_I8P</span>

  <span class="k">elemental function </span><span class="n">I4P_low_eq_self</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">self</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">compare</span><span class="p">)</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="c">!&lt; Return .true. if the normL2 of the self1 is &lt;= with respect the  value of scalar scal, .false. otherwise.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="kt">integer</span><span class="p">(</span><span class="n">I4P</span><span class="p">),</span>  <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">scal</span>    <span class="c">! Scalar.</span>
  <span class="k">class</span><span class="p">(</span><span class="n">Vector</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">self</span>    <span class="c">! Vector.</span>
  <span class="kt">logical</span>                   <span class="kd">::</span> <span class="n">compare</span> <span class="c">! The result of the comparison.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>

  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">compare</span> <span class="o">=</span> <span class="p">(</span><span class="kt">real</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">R8P</span><span class="p">)</span><span class="o">&lt;=</span><span class="n">normL2</span><span class="p">(</span><span class="n">self</span><span class="p">))</span>
  <span class="k">return</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">endfunction</span> <span class="n">I4P_low_eq_self</span>

  <span class="k">elemental function </span><span class="n">self_low_eq_I4P</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">scal</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">compare</span><span class="p">)</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="c">!&lt; Return .true. if the normL2 of the self1 is &lt;= with respect the  value of scalar scal, .false. otherwise.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="k">class</span><span class="p">(</span><span class="n">Vector</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">self</span>    <span class="c">! Vector.</span>
  <span class="kt">integer</span><span class="p">(</span><span class="n">I4P</span><span class="p">),</span>  <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">scal</span>    <span class="c">! Scalar.</span>
  <span class="kt">logical</span>                   <span class="kd">::</span> <span class="n">compare</span> <span class="c">! The result of the comparison.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>

  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">compare</span> <span class="o">=</span> <span class="p">(</span><span class="n">normL2</span><span class="p">(</span><span class="n">self</span><span class="p">)</span><span class="o">&lt;=</span><span class="kt">real</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">R8P</span><span class="p">))</span>
  <span class="k">return</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">endfunction</span> <span class="n">self_low_eq_I4P</span>

  <span class="k">elemental function </span><span class="n">I2P_low_eq_self</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">self</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">compare</span><span class="p">)</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="c">!&lt; Return .true. if the normL2 of the self1 is &lt;= with respect the  value of scalar scal, .false. otherwise.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="kt">integer</span><span class="p">(</span><span class="n">I2P</span><span class="p">),</span>  <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">scal</span>    <span class="c">! Scalar.</span>
  <span class="k">class</span><span class="p">(</span><span class="n">Vector</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">self</span>    <span class="c">! Vector.</span>
  <span class="kt">logical</span>                   <span class="kd">::</span> <span class="n">compare</span> <span class="c">! The result of the comparison.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>

  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">compare</span> <span class="o">=</span> <span class="p">(</span><span class="kt">real</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">R8P</span><span class="p">)</span><span class="o">&lt;=</span><span class="n">normL2</span><span class="p">(</span><span class="n">self</span><span class="p">))</span>
  <span class="k">return</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">endfunction</span> <span class="n">I2P_low_eq_self</span>

  <span class="k">elemental function </span><span class="n">self_low_eq_I2P</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">scal</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">compare</span><span class="p">)</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="c">!&lt; Return .true. if the normL2 of the self1 is &lt;= with respect the  value of scalar scal, .false. otherwise.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="k">class</span><span class="p">(</span><span class="n">Vector</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">self</span>    <span class="c">! Vector.</span>
  <span class="kt">integer</span><span class="p">(</span><span class="n">I2P</span><span class="p">),</span>  <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">scal</span>    <span class="c">! Scalar.</span>
  <span class="kt">logical</span>                   <span class="kd">::</span> <span class="n">compare</span> <span class="c">! The result of the comparison.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>

  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">compare</span> <span class="o">=</span> <span class="p">(</span><span class="n">normL2</span><span class="p">(</span><span class="n">self</span><span class="p">)</span><span class="o">&lt;=</span><span class="kt">real</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">R8P</span><span class="p">))</span>
  <span class="k">return</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">endfunction</span> <span class="n">self_low_eq_I2P</span>

  <span class="k">elemental function </span><span class="n">I1P_low_eq_self</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">self</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">compare</span><span class="p">)</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="c">!&lt; Return .true. if the normL2 of the self1 is &lt;= with respect the  value of scalar scal, .false. otherwise.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="kt">integer</span><span class="p">(</span><span class="n">I1P</span><span class="p">),</span>  <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">scal</span>    <span class="c">! Scalar.</span>
  <span class="k">class</span><span class="p">(</span><span class="n">Vector</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">self</span>    <span class="c">! Vector.</span>
  <span class="kt">logical</span>                   <span class="kd">::</span> <span class="n">compare</span> <span class="c">! The result of the comparison.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>

  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">compare</span> <span class="o">=</span> <span class="p">(</span><span class="kt">real</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">R8P</span><span class="p">)</span><span class="o">&lt;=</span><span class="n">normL2</span><span class="p">(</span><span class="n">self</span><span class="p">))</span>
  <span class="k">return</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">endfunction</span> <span class="n">I1P_low_eq_self</span>

  <span class="k">elemental function </span><span class="n">self_low_eq_I1P</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">scal</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">compare</span><span class="p">)</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="c">!&lt; Return .true. if the normL2 of the self1 is &lt;= with respect the  value of scalar scal, .false. otherwise.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="k">class</span><span class="p">(</span><span class="n">Vector</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">self</span>    <span class="c">! Vector.</span>
  <span class="kt">integer</span><span class="p">(</span><span class="n">I1P</span><span class="p">),</span>  <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">scal</span>    <span class="c">! Scalar.</span>
  <span class="kt">logical</span>                   <span class="kd">::</span> <span class="n">compare</span> <span class="c">! The result of the comparison.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>

  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">compare</span> <span class="o">=</span> <span class="p">(</span><span class="n">normL2</span><span class="p">(</span><span class="n">self</span><span class="p">)</span><span class="o">&lt;=</span><span class="kt">real</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">R8P</span><span class="p">))</span>
  <span class="k">return</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">endfunction</span> <span class="n">self_low_eq_I1P</span>

  <span class="c">! Oprator ==</span>
  <span class="k">elemental function </span><span class="n">self_eq_self</span><span class="p">(</span><span class="n">self1</span><span class="p">,</span> <span class="n">self2</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">compare</span><span class="p">)</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="c">!&gt; Return .true. if the normL2 of the self1 is = with respect the normL2 of self2 and the directions of</span>
  <span class="c">!&gt; self1 and self2 are the same, .false. otherwise.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="k">class</span><span class="p">(</span><span class="n">Vector</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">self1</span>   <span class="c">! First selftor.</span>
  <span class="k">type</span><span class="p">(</span><span class="n">Vector</span><span class="p">),</span>  <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">self2</span>   <span class="c">! Second selftor.</span>
  <span class="kt">logical</span>                   <span class="kd">::</span> <span class="n">compare</span> <span class="c">! The result of the comparison.</span>
  <span class="k">type</span><span class="p">(</span><span class="n">Vector</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">n1</span>      <span class="c">! Normalizations of self1.</span>
  <span class="k">type</span><span class="p">(</span><span class="n">Vector</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">n2</span>      <span class="c">! Normalizations of self2.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>

  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">compare</span> <span class="o">=</span> <span class="p">(</span><span class="n">normL2</span><span class="p">(</span><span class="n">self1</span><span class="p">)</span><span class="o">==</span><span class="n">normL2</span><span class="p">(</span><span class="n">self2</span><span class="p">))</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">compare</span><span class="p">)</span> <span class="k">then</span> <span class="c">! the normL2 are the same, checking the directions</span>
    <span class="n">n1</span> <span class="o">=</span> <span class="n">normalize</span><span class="p">(</span><span class="n">self1</span><span class="p">)</span>
    <span class="n">n2</span> <span class="o">=</span> <span class="n">normalize</span><span class="p">(</span><span class="n">self2</span><span class="p">)</span>
    <span class="n">compare</span> <span class="o">=</span> <span class="p">((</span><span class="n">n1</span><span class="p">%</span><span class="n">x</span><span class="o">==</span><span class="n">n2</span><span class="p">%</span><span class="n">x</span><span class="p">).</span><span class="nb">AND</span><span class="p">.(</span><span class="n">n1</span><span class="p">%</span><span class="n">y</span><span class="o">==</span><span class="n">n2</span><span class="p">%</span><span class="n">y</span><span class="p">).</span><span class="nb">AND</span><span class="p">.(</span><span class="n">n1</span><span class="p">%</span><span class="n">z</span><span class="o">==</span><span class="n">n2</span><span class="p">%</span><span class="n">z</span><span class="p">))</span>
  <span class="n">endif</span>
  <span class="k">return</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">endfunction</span> <span class="n">self_eq_self</span>

  <span class="k">elemental function </span><span class="n">R16P_eq_self</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">self</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">compare</span><span class="p">)</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="c">!&lt; Return .true. if the normL2 of the self is = with respect the value of scalar scal, .false. otherwise.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="kt">real</span><span class="p">(</span><span class="n">R16P</span><span class="p">),</span>    <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">scal</span>    <span class="c">! Scalar.</span>
  <span class="k">class</span><span class="p">(</span><span class="n">Vector</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">self</span>    <span class="c">! Vector.</span>
  <span class="kt">logical</span>                   <span class="kd">::</span> <span class="n">compare</span> <span class="c">! The result of the comparison.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>

  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">compare</span> <span class="o">=</span> <span class="p">(</span><span class="n">normL2</span><span class="p">(</span><span class="n">self</span><span class="p">)</span><span class="o">==</span><span class="kt">real</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">R8P</span><span class="p">))</span>
  <span class="k">return</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">endfunction</span> <span class="n">R16P_eq_self</span>

  <span class="k">elemental function </span><span class="n">self_eq_R16P</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">scal</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">compare</span><span class="p">)</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="c">!&lt; Return .true. if the normL2 of the self is = with respect the value of scalar scal, .false. otherwise.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="k">class</span><span class="p">(</span><span class="n">Vector</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">self</span>    <span class="c">! Vector.</span>
  <span class="kt">real</span><span class="p">(</span><span class="n">R16P</span><span class="p">),</span>    <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">scal</span>    <span class="c">! Scalar.</span>
  <span class="kt">logical</span>                   <span class="kd">::</span> <span class="n">compare</span> <span class="c">! The result of the comparison.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>

  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">compare</span> <span class="o">=</span> <span class="p">(</span><span class="n">normL2</span><span class="p">(</span><span class="n">self</span><span class="p">)</span><span class="o">==</span><span class="kt">real</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">R8P</span><span class="p">))</span>
  <span class="k">return</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">endfunction</span> <span class="n">self_eq_R16P</span>

  <span class="k">elemental function </span><span class="n">R8P_eq_self</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">self</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">compare</span><span class="p">)</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="c">!&lt; Return .true. if the normL2 of the self is = with respect the value of scalar scal, .false. otherwise.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="kt">real</span><span class="p">(</span><span class="n">R8P</span><span class="p">),</span>     <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">scal</span>    <span class="c">! Scalar.</span>
  <span class="k">class</span><span class="p">(</span><span class="n">Vector</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">self</span>    <span class="c">! Vector.</span>
  <span class="kt">logical</span>                   <span class="kd">::</span> <span class="n">compare</span> <span class="c">! The result of the comparison.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>

  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">compare</span> <span class="o">=</span> <span class="p">(</span><span class="n">normL2</span><span class="p">(</span><span class="n">self</span><span class="p">)</span><span class="o">==</span><span class="kt">real</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">R8P</span><span class="p">))</span>
  <span class="k">return</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">endfunction</span> <span class="n">R8P_eq_self</span>

  <span class="k">elemental function </span><span class="n">self_eq_R8P</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">scal</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">compare</span><span class="p">)</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="c">!&lt; Return .true. if the normL2 of the self is = with respect the value of scalar scal, .false. otherwise.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="k">class</span><span class="p">(</span><span class="n">Vector</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">self</span>    <span class="c">! Vector.</span>
  <span class="kt">real</span><span class="p">(</span><span class="n">R8P</span><span class="p">),</span>     <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">scal</span>    <span class="c">! Scalar.</span>
  <span class="kt">logical</span>                   <span class="kd">::</span> <span class="n">compare</span> <span class="c">! The result of the comparison.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>

  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">compare</span> <span class="o">=</span> <span class="p">(</span><span class="n">normL2</span><span class="p">(</span><span class="n">self</span><span class="p">)</span><span class="o">==</span><span class="kt">real</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">R8P</span><span class="p">))</span>
  <span class="k">return</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">endfunction</span> <span class="n">self_eq_R8P</span>

  <span class="k">elemental function </span><span class="n">R4P_eq_self</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">self</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">compare</span><span class="p">)</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="c">!&lt; Return .true. if the normL2 of the self is = with respect the value of scalar scal, .false. otherwise.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="kt">real</span><span class="p">(</span><span class="n">R4P</span><span class="p">),</span>     <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">scal</span>    <span class="c">! Scalar.</span>
  <span class="k">class</span><span class="p">(</span><span class="n">Vector</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">self</span>    <span class="c">! Vector.</span>
  <span class="kt">logical</span>                   <span class="kd">::</span> <span class="n">compare</span> <span class="c">! The result of the comparison.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>

  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">compare</span> <span class="o">=</span> <span class="p">(</span><span class="n">normL2</span><span class="p">(</span><span class="n">self</span><span class="p">)</span><span class="o">==</span><span class="kt">real</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">R8P</span><span class="p">))</span>
  <span class="k">return</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">endfunction</span> <span class="n">R4P_eq_self</span>

  <span class="k">elemental function </span><span class="n">self_eq_R4P</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">scal</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">compare</span><span class="p">)</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="c">!&lt; Return .true. if the normL2 of the self is = with respect the value of scalar scal, .false. otherwise.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="k">class</span><span class="p">(</span><span class="n">Vector</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">self</span>    <span class="c">! Vector.</span>
  <span class="kt">real</span><span class="p">(</span><span class="n">R4P</span><span class="p">),</span>     <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">scal</span>    <span class="c">! Scalar.</span>
  <span class="kt">logical</span>                   <span class="kd">::</span> <span class="n">compare</span> <span class="c">! The result of the comparison.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>

  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">compare</span> <span class="o">=</span> <span class="p">(</span><span class="n">normL2</span><span class="p">(</span><span class="n">self</span><span class="p">)</span><span class="o">==</span><span class="kt">real</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">R8P</span><span class="p">))</span>
  <span class="k">return</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">endfunction</span> <span class="n">self_eq_R4P</span>

  <span class="k">elemental function </span><span class="n">I8P_eq_self</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">self</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">compare</span><span class="p">)</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="c">!&lt; Return .true. if the normL2 of the self is = with respect the value of scalar scal, .false. otherwise.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="kt">integer</span><span class="p">(</span><span class="n">I8P</span><span class="p">),</span>  <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">scal</span>    <span class="c">! Scalar.</span>
  <span class="k">class</span><span class="p">(</span><span class="n">Vector</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">self</span>    <span class="c">! Vector.</span>
  <span class="kt">logical</span>                   <span class="kd">::</span> <span class="n">compare</span> <span class="c">! The result of the comparison.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>

  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">compare</span> <span class="o">=</span> <span class="p">(</span><span class="n">normL2</span><span class="p">(</span><span class="n">self</span><span class="p">)</span><span class="o">==</span><span class="kt">real</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">R8P</span><span class="p">))</span>
  <span class="k">return</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">endfunction</span> <span class="n">I8P_eq_self</span>

  <span class="k">elemental function </span><span class="n">self_eq_I8P</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">scal</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">compare</span><span class="p">)</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="c">!&lt; Return .true. if the normL2 of the self is = with respect the value of scalar scal, .false. otherwise.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="k">class</span><span class="p">(</span><span class="n">Vector</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">self</span>    <span class="c">! Vector.</span>
  <span class="kt">integer</span><span class="p">(</span><span class="n">I8P</span><span class="p">),</span>  <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">scal</span>    <span class="c">! Scalar.</span>
  <span class="kt">logical</span>                   <span class="kd">::</span> <span class="n">compare</span> <span class="c">! The result of the comparison.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>

  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">compare</span> <span class="o">=</span> <span class="p">(</span><span class="n">normL2</span><span class="p">(</span><span class="n">self</span><span class="p">)</span><span class="o">==</span><span class="kt">real</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">R8P</span><span class="p">))</span>
  <span class="k">return</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">endfunction</span> <span class="n">self_eq_I8P</span>

  <span class="k">elemental function </span><span class="n">I4P_eq_self</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">self</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">compare</span><span class="p">)</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="c">!&lt; @brief Procedure returns .true. if the normL2 of the self is = with respect the value of scalar scal, .false. otherwise.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="kt">integer</span><span class="p">(</span><span class="n">I4P</span><span class="p">),</span>  <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">scal</span>    <span class="c">! Scalar.</span>
  <span class="k">class</span><span class="p">(</span><span class="n">Vector</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">self</span>    <span class="c">! Vector.</span>
  <span class="kt">logical</span>                   <span class="kd">::</span> <span class="n">compare</span> <span class="c">! The result of the comparison.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>

  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">compare</span> <span class="o">=</span> <span class="p">(</span><span class="n">normL2</span><span class="p">(</span><span class="n">self</span><span class="p">)</span><span class="o">==</span><span class="kt">real</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">R8P</span><span class="p">))</span>
  <span class="k">return</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">endfunction</span> <span class="n">I4P_eq_self</span>

  <span class="k">elemental function </span><span class="n">self_eq_I4P</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">scal</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">compare</span><span class="p">)</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="c">!&lt; Return .true. if the normL2 of the self is = with respect the value of scalar scal, .false. otherwise.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="k">class</span><span class="p">(</span><span class="n">Vector</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">self</span>    <span class="c">! Vector.</span>
  <span class="kt">integer</span><span class="p">(</span><span class="n">I4P</span><span class="p">),</span>  <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">scal</span>    <span class="c">! Scalar.</span>
  <span class="kt">logical</span>                   <span class="kd">::</span> <span class="n">compare</span> <span class="c">! The result of the comparison.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>

  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">compare</span> <span class="o">=</span> <span class="p">(</span><span class="n">normL2</span><span class="p">(</span><span class="n">self</span><span class="p">)</span><span class="o">==</span><span class="kt">real</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">R8P</span><span class="p">))</span>
  <span class="k">return</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">endfunction</span> <span class="n">self_eq_I4P</span>

  <span class="k">elemental function </span><span class="n">I2P_eq_self</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">self</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">compare</span><span class="p">)</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="c">!&lt; Return .true. if the normL2 of the self is = with respect the value of scalar scal, .false. otherwise.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="kt">integer</span><span class="p">(</span><span class="n">I2P</span><span class="p">),</span>  <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">scal</span>    <span class="c">! Scalar.</span>
  <span class="k">class</span><span class="p">(</span><span class="n">Vector</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">self</span>    <span class="c">! Vector.</span>
  <span class="kt">logical</span>                   <span class="kd">::</span> <span class="n">compare</span> <span class="c">! The result of the comparison.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>

  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">compare</span> <span class="o">=</span> <span class="p">(</span><span class="n">normL2</span><span class="p">(</span><span class="n">self</span><span class="p">)</span><span class="o">==</span><span class="kt">real</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">R8P</span><span class="p">))</span>
  <span class="k">return</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">endfunction</span> <span class="n">I2P_eq_self</span>

  <span class="k">elemental function </span><span class="n">self_eq_I2P</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">scal</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">compare</span><span class="p">)</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="c">!&lt; Return .true. if the normL2 of the self is = with respect the value of scalar scal, .false. otherwise.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="k">class</span><span class="p">(</span><span class="n">Vector</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">self</span>    <span class="c">! Vector.</span>
  <span class="kt">integer</span><span class="p">(</span><span class="n">I2P</span><span class="p">),</span>  <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">scal</span>    <span class="c">! Scalar.</span>
  <span class="kt">logical</span>                   <span class="kd">::</span> <span class="n">compare</span> <span class="c">! The result of the comparison.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>

  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">compare</span> <span class="o">=</span> <span class="p">(</span><span class="n">normL2</span><span class="p">(</span><span class="n">self</span><span class="p">)</span><span class="o">==</span><span class="kt">real</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">R8P</span><span class="p">))</span>
  <span class="k">return</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">endfunction</span> <span class="n">self_eq_I2P</span>

  <span class="k">elemental function </span><span class="n">I1P_eq_self</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">self</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">compare</span><span class="p">)</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="c">!&lt; Return .true. if the normL2 of the self is = with respect the value of scalar scal, .false. otherwise.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="kt">integer</span><span class="p">(</span><span class="n">I1P</span><span class="p">),</span>  <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">scal</span>    <span class="c">! Scalar.</span>
  <span class="k">class</span><span class="p">(</span><span class="n">Vector</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">self</span>    <span class="c">! Vector.</span>
  <span class="kt">logical</span>                   <span class="kd">::</span> <span class="n">compare</span> <span class="c">! The result of the comparison.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>

  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">compare</span> <span class="o">=</span> <span class="p">(</span><span class="n">normL2</span><span class="p">(</span><span class="n">self</span><span class="p">)</span><span class="o">==</span><span class="kt">real</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">R8P</span><span class="p">))</span>
  <span class="k">return</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">endfunction</span> <span class="n">I1P_eq_self</span>

  <span class="k">elemental function </span><span class="n">self_eq_I1P</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">scal</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">compare</span><span class="p">)</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="c">!&lt; Return .true. if the normL2 of the self is = with respect the value of scalar scal, .false. otherwise.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="k">class</span><span class="p">(</span><span class="n">Vector</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">self</span>    <span class="c">! Vector.</span>
  <span class="kt">integer</span><span class="p">(</span><span class="n">I1P</span><span class="p">),</span>  <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">scal</span>    <span class="c">! Scalar.</span>
  <span class="kt">logical</span>                   <span class="kd">::</span> <span class="n">compare</span> <span class="c">! The result of the comparison.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>

  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">compare</span> <span class="o">=</span> <span class="p">(</span><span class="n">normL2</span><span class="p">(</span><span class="n">self</span><span class="p">)</span><span class="o">==</span><span class="kt">real</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">R8P</span><span class="p">))</span>
  <span class="k">return</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">endfunction</span> <span class="n">self_eq_I1P</span>

  <span class="c">! Oprator &gt;=</span>
  <span class="k">elemental function </span><span class="n">self_great_eq_self</span><span class="p">(</span><span class="n">self1</span><span class="p">,</span> <span class="n">self2</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">compare</span><span class="p">)</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="c">!&lt; Return .true. if the normL2 of the self1 is &gt;= with respect the normL2 of self2, .false. otherwise.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="k">class</span><span class="p">(</span><span class="n">Vector</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">self1</span>   <span class="c">! First selftor.</span>
  <span class="k">type</span><span class="p">(</span><span class="n">Vector</span><span class="p">),</span>  <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">self2</span>   <span class="c">! Second selftor.</span>
  <span class="kt">logical</span>                   <span class="kd">::</span> <span class="n">compare</span> <span class="c">! The result of the comparison.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>

  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">compare</span> <span class="o">=</span> <span class="p">(</span><span class="n">normL2</span><span class="p">(</span><span class="n">self1</span><span class="p">)</span><span class="o">&gt;=</span><span class="n">normL2</span><span class="p">(</span><span class="n">self2</span><span class="p">))</span>
  <span class="k">return</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">endfunction</span> <span class="n">self_great_eq_self</span>

  <span class="k">elemental function </span><span class="n">R16P_great_eq_self</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">self</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">compare</span><span class="p">)</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="c">!&lt; Return .true. if the normL2 of the self1 is &gt;= with respect the  value of scalar scal, .false. otherwise.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="kt">real</span><span class="p">(</span><span class="n">R16P</span><span class="p">),</span>    <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">scal</span>    <span class="c">! Scalar.</span>
  <span class="k">class</span><span class="p">(</span><span class="n">Vector</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">self</span>    <span class="c">! Vector.</span>
  <span class="kt">logical</span>                   <span class="kd">::</span> <span class="n">compare</span> <span class="c">! The result of the comparison.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>

  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">compare</span> <span class="o">=</span> <span class="p">(</span><span class="kt">real</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">R8P</span><span class="p">)</span><span class="o">&gt;=</span><span class="n">normL2</span><span class="p">(</span><span class="n">self</span><span class="p">))</span>
  <span class="k">return</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">endfunction</span> <span class="n">R16P_great_eq_self</span>

  <span class="k">elemental function </span><span class="n">self_great_eq_R16P</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">scal</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">compare</span><span class="p">)</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="c">!&lt; Return .true. if the normL2 of the self1 is &gt;= with respect the  value of scalar scal, .false. otherwise.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="k">class</span><span class="p">(</span><span class="n">Vector</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">self</span>    <span class="c">! Vector.</span>
  <span class="kt">real</span><span class="p">(</span><span class="n">R16P</span><span class="p">),</span>    <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">scal</span>    <span class="c">! Scalar.</span>
  <span class="kt">logical</span>                   <span class="kd">::</span> <span class="n">compare</span> <span class="c">! The result of the comparison.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>

  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">compare</span> <span class="o">=</span> <span class="p">(</span><span class="n">normL2</span><span class="p">(</span><span class="n">self</span><span class="p">)</span><span class="o">&gt;=</span><span class="kt">real</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">R8P</span><span class="p">))</span>
  <span class="k">return</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">endfunction</span> <span class="n">self_great_eq_R16P</span>

  <span class="k">elemental function </span><span class="n">R8P_great_eq_self</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">self</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">compare</span><span class="p">)</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="c">!&lt; Return .true. if the normL2 of the self1 is &gt;= with respect the  value of scalar scal, .false. otherwise.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="kt">real</span><span class="p">(</span><span class="n">R8P</span><span class="p">),</span>     <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">scal</span>    <span class="c">! Scalar.</span>
  <span class="k">class</span><span class="p">(</span><span class="n">Vector</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">self</span>    <span class="c">! Vector.</span>
  <span class="kt">logical</span>                   <span class="kd">::</span> <span class="n">compare</span> <span class="c">! The result of the comparison.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>

  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">compare</span> <span class="o">=</span> <span class="p">(</span><span class="kt">real</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">R8P</span><span class="p">)</span><span class="o">&gt;=</span><span class="n">normL2</span><span class="p">(</span><span class="n">self</span><span class="p">))</span>
  <span class="k">return</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">endfunction</span> <span class="n">R8P_great_eq_self</span>

  <span class="k">elemental function </span><span class="n">self_great_eq_R8P</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">scal</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">compare</span><span class="p">)</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="c">!&lt; Return .true. if the normL2 of the self1 is &gt;= with respect the  value of scalar scal, .false. otherwise.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="k">class</span><span class="p">(</span><span class="n">Vector</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">self</span>    <span class="c">! Vector.</span>
  <span class="kt">real</span><span class="p">(</span><span class="n">R8P</span><span class="p">),</span>     <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">scal</span>    <span class="c">! Scalar.</span>
  <span class="kt">logical</span>                   <span class="kd">::</span> <span class="n">compare</span> <span class="c">! The result of the comparison.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>

  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">compare</span> <span class="o">=</span> <span class="p">(</span><span class="n">normL2</span><span class="p">(</span><span class="n">self</span><span class="p">)</span><span class="o">&gt;=</span><span class="kt">real</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">R8P</span><span class="p">))</span>
  <span class="k">return</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">endfunction</span> <span class="n">self_great_eq_R8P</span>

  <span class="k">elemental function </span><span class="n">R4P_great_eq_self</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">self</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">compare</span><span class="p">)</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="c">!&lt; Return .true. if the normL2 of the self1 is &gt;= with respect the  value of scalar scal, .false. otherwise.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="kt">real</span><span class="p">(</span><span class="n">R4P</span><span class="p">),</span>     <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">scal</span>    <span class="c">! Scalar.</span>
  <span class="k">class</span><span class="p">(</span><span class="n">Vector</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">self</span>    <span class="c">! Vector.</span>
  <span class="kt">logical</span>                   <span class="kd">::</span> <span class="n">compare</span> <span class="c">! The result of the comparison.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>

  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">compare</span> <span class="o">=</span> <span class="p">(</span><span class="kt">real</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">R8P</span><span class="p">)</span><span class="o">&gt;=</span><span class="n">normL2</span><span class="p">(</span><span class="n">self</span><span class="p">))</span>
  <span class="k">return</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">endfunction</span> <span class="n">R4P_great_eq_self</span>

  <span class="k">elemental function </span><span class="n">self_great_eq_R4P</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">scal</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">compare</span><span class="p">)</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="c">!&lt; Return .true. if the normL2 of the self1 is &gt;= with respect the  value of scalar scal, .false. otherwise.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="k">class</span><span class="p">(</span><span class="n">Vector</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">self</span>    <span class="c">! Vector.</span>
  <span class="kt">real</span><span class="p">(</span><span class="n">R4P</span><span class="p">),</span>     <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">scal</span>    <span class="c">! Scalar.</span>
  <span class="kt">logical</span>                   <span class="kd">::</span> <span class="n">compare</span> <span class="c">! The result of the comparison.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>

  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">compare</span> <span class="o">=</span> <span class="p">(</span><span class="n">normL2</span><span class="p">(</span><span class="n">self</span><span class="p">)</span><span class="o">&gt;=</span><span class="kt">real</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">R8P</span><span class="p">))</span>
  <span class="k">return</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">endfunction</span> <span class="n">self_great_eq_R4P</span>

  <span class="k">elemental function </span><span class="n">I8P_great_eq_self</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">self</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">compare</span><span class="p">)</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="c">!&lt; Return .true. if the normL2 of the self1 is &gt;= with respect the  value of scalar scal, .false. otherwise.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="kt">integer</span><span class="p">(</span><span class="n">I8P</span><span class="p">),</span>  <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">scal</span>    <span class="c">! Scalar.</span>
  <span class="k">class</span><span class="p">(</span><span class="n">Vector</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">self</span>    <span class="c">! Vector.</span>
  <span class="kt">logical</span>                   <span class="kd">::</span> <span class="n">compare</span> <span class="c">! The result of the comparison.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>

  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">compare</span> <span class="o">=</span> <span class="p">(</span><span class="kt">real</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">R8P</span><span class="p">)</span><span class="o">&gt;=</span><span class="n">normL2</span><span class="p">(</span><span class="n">self</span><span class="p">))</span>
  <span class="k">return</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">endfunction</span> <span class="n">I8P_great_eq_self</span>

  <span class="k">elemental function </span><span class="n">self_great_eq_I8P</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">scal</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">compare</span><span class="p">)</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="c">!&lt; Return .true. if the normL2 of the self1 is &gt;= with respect the  value of scalar scal, .false. otherwise.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="k">class</span><span class="p">(</span><span class="n">Vector</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">self</span>    <span class="c">! Vector.</span>
  <span class="kt">integer</span><span class="p">(</span><span class="n">I8P</span><span class="p">),</span>  <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">scal</span>    <span class="c">! Scalar.</span>
  <span class="kt">logical</span>                   <span class="kd">::</span> <span class="n">compare</span> <span class="c">! The result of the comparison.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>

  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">compare</span> <span class="o">=</span> <span class="p">(</span><span class="n">normL2</span><span class="p">(</span><span class="n">self</span><span class="p">)</span><span class="o">&gt;=</span><span class="kt">real</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">R8P</span><span class="p">))</span>
  <span class="k">return</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">endfunction</span> <span class="n">self_great_eq_I8P</span>

  <span class="k">elemental function </span><span class="n">I4P_great_eq_self</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">self</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">compare</span><span class="p">)</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="c">!&lt; Return .true. if the normL2 of the self1 is &gt;= with respect the  value of scalar scal, .false. otherwise.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="kt">integer</span><span class="p">(</span><span class="n">I4P</span><span class="p">),</span>  <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">scal</span>    <span class="c">! Scalar.</span>
  <span class="k">class</span><span class="p">(</span><span class="n">Vector</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">self</span>    <span class="c">! Vector.</span>
  <span class="kt">logical</span>                   <span class="kd">::</span> <span class="n">compare</span> <span class="c">! The result of the comparison.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>

  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">compare</span> <span class="o">=</span> <span class="p">(</span><span class="kt">real</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">R8P</span><span class="p">)</span><span class="o">&gt;=</span><span class="n">normL2</span><span class="p">(</span><span class="n">self</span><span class="p">))</span>
  <span class="k">return</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">endfunction</span> <span class="n">I4P_great_eq_self</span>

  <span class="k">elemental function </span><span class="n">self_great_eq_I4P</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">scal</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">compare</span><span class="p">)</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="c">!&lt; Return .true. if the normL2 of the self1 is &gt;= with respect the  value of scalar scal, .false. otherwise.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="k">class</span><span class="p">(</span><span class="n">Vector</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">self</span>    <span class="c">! Vector.</span>
  <span class="kt">integer</span><span class="p">(</span><span class="n">I4P</span><span class="p">),</span>  <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">scal</span>    <span class="c">! Scalar.</span>
  <span class="kt">logical</span>                   <span class="kd">::</span> <span class="n">compare</span> <span class="c">! The result of the comparison.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>

  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">compare</span> <span class="o">=</span> <span class="p">(</span><span class="n">normL2</span><span class="p">(</span><span class="n">self</span><span class="p">)</span><span class="o">&gt;=</span><span class="kt">real</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">R8P</span><span class="p">))</span>
  <span class="k">return</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">endfunction</span> <span class="n">self_great_eq_I4P</span>

  <span class="k">elemental function </span><span class="n">I2P_great_eq_self</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">self</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">compare</span><span class="p">)</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="c">!&lt; Return .true. if the normL2 of the self1 is &gt;= with respect the  value of scalar scal, .false. otherwise.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="kt">integer</span><span class="p">(</span><span class="n">I2P</span><span class="p">),</span>  <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">scal</span>    <span class="c">! Scalar.</span>
  <span class="k">class</span><span class="p">(</span><span class="n">Vector</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">self</span>    <span class="c">! Vector.</span>
  <span class="kt">logical</span>                   <span class="kd">::</span> <span class="n">compare</span> <span class="c">! The result of the comparison.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>

  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">compare</span> <span class="o">=</span> <span class="p">(</span><span class="kt">real</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">R8P</span><span class="p">)</span><span class="o">&gt;=</span><span class="n">normL2</span><span class="p">(</span><span class="n">self</span><span class="p">))</span>
  <span class="k">return</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">endfunction</span> <span class="n">I2P_great_eq_self</span>

  <span class="k">elemental function </span><span class="n">self_great_eq_I2P</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">scal</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">compare</span><span class="p">)</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="c">!&lt; Return .true. if the normL2 of the self1 is &gt;= with respect the  value of scalar scal, .false. otherwise.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="k">class</span><span class="p">(</span><span class="n">Vector</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">self</span>    <span class="c">! Vector.</span>
  <span class="kt">integer</span><span class="p">(</span><span class="n">I2P</span><span class="p">),</span>  <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">scal</span>    <span class="c">! Scalar.</span>
  <span class="kt">logical</span>                   <span class="kd">::</span> <span class="n">compare</span> <span class="c">! The result of the comparison.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>

  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">compare</span> <span class="o">=</span> <span class="p">(</span><span class="n">normL2</span><span class="p">(</span><span class="n">self</span><span class="p">)</span><span class="o">&gt;=</span><span class="kt">real</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">R8P</span><span class="p">))</span>
  <span class="k">return</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">endfunction</span> <span class="n">self_great_eq_I2P</span>

  <span class="k">elemental function </span><span class="n">I1P_great_eq_self</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">self</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">compare</span><span class="p">)</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="c">!&lt; Return .true. if the normL2 of the self1 is &gt;= with respect the  value of scalar scal, .false. otherwise.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="kt">integer</span><span class="p">(</span><span class="n">I1P</span><span class="p">),</span>  <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">scal</span>    <span class="c">! Scalar.</span>
  <span class="k">class</span><span class="p">(</span><span class="n">Vector</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">self</span>    <span class="c">! Vector.</span>
  <span class="kt">logical</span>                   <span class="kd">::</span> <span class="n">compare</span> <span class="c">! The result of the comparison.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>

  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">compare</span> <span class="o">=</span> <span class="p">(</span><span class="kt">real</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">R8P</span><span class="p">)</span><span class="o">&gt;=</span><span class="n">normL2</span><span class="p">(</span><span class="n">self</span><span class="p">))</span>
  <span class="k">return</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">endfunction</span> <span class="n">I1P_great_eq_self</span>

  <span class="k">elemental function </span><span class="n">self_great_eq_I1P</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">scal</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">compare</span><span class="p">)</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="c">!&lt; Return .true. if the normL2 of the self1 is &gt;= with respect the  value of scalar scal, .false. otherwise.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="k">class</span><span class="p">(</span><span class="n">Vector</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">self</span>    <span class="c">! Vector.</span>
  <span class="kt">integer</span><span class="p">(</span><span class="n">I1P</span><span class="p">),</span>  <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">scal</span>    <span class="c">! Scalar.</span>
  <span class="kt">logical</span>                   <span class="kd">::</span> <span class="n">compare</span> <span class="c">! The result of the comparison.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>

  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">compare</span> <span class="o">=</span> <span class="p">(</span><span class="n">normL2</span><span class="p">(</span><span class="n">self</span><span class="p">)</span><span class="o">&gt;=</span><span class="kt">real</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">R8P</span><span class="p">))</span>
  <span class="k">return</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">endfunction</span> <span class="n">self_great_eq_I1P</span>

  <span class="c">! Oprator &gt;</span>
  <span class="k">elemental function </span><span class="n">self_great_self</span><span class="p">(</span><span class="n">self1</span><span class="p">,</span> <span class="n">self2</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">compare</span><span class="p">)</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="c">!&lt; Return .true. if the normL2 of the self1 is &gt; with respect the normL2 of self2, .false. otherwise.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="k">class</span><span class="p">(</span><span class="n">Vector</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">self1</span>   <span class="c">! First selftor.</span>
  <span class="k">type</span><span class="p">(</span><span class="n">Vector</span><span class="p">),</span>  <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">self2</span>   <span class="c">! Second selftor.</span>
  <span class="kt">logical</span>                   <span class="kd">::</span> <span class="n">compare</span> <span class="c">! The result of the comparison.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>

  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">compare</span> <span class="o">=</span> <span class="p">(</span><span class="n">normL2</span><span class="p">(</span><span class="n">self1</span><span class="p">)</span><span class="o">&gt;</span><span class="n">normL2</span><span class="p">(</span><span class="n">self2</span><span class="p">))</span>
  <span class="k">return</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">endfunction</span> <span class="n">self_great_self</span>

  <span class="k">elemental function </span><span class="n">R16P_great_self</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">self</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">compare</span><span class="p">)</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="c">!&lt; Return .true. if the normL2 of the self1 is &gt; with respect the  value of scalar scal, .false. otherwise.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="kt">real</span><span class="p">(</span><span class="n">R16P</span><span class="p">),</span>    <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">scal</span>    <span class="c">! Scalar.</span>
  <span class="k">class</span><span class="p">(</span><span class="n">Vector</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">self</span>    <span class="c">! Vector.</span>
  <span class="kt">logical</span>                   <span class="kd">::</span> <span class="n">compare</span> <span class="c">! The result of the comparison.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>

  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">compare</span> <span class="o">=</span> <span class="p">(</span><span class="kt">real</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">R8P</span><span class="p">)</span><span class="o">&gt;</span><span class="n">normL2</span><span class="p">(</span><span class="n">self</span><span class="p">))</span>
  <span class="k">return</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">endfunction</span> <span class="n">R16P_great_self</span>

  <span class="k">elemental function </span><span class="n">self_great_R16P</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">scal</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">compare</span><span class="p">)</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="c">!&lt; Return .true. if the normL2 of the self1 is &gt; with respect the  value of scalar scal, .false. otherwise.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="k">class</span><span class="p">(</span><span class="n">Vector</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">self</span>    <span class="c">! Vector.</span>
  <span class="kt">real</span><span class="p">(</span><span class="n">R16P</span><span class="p">),</span>    <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">scal</span>    <span class="c">! Scalar.</span>
  <span class="kt">logical</span>                   <span class="kd">::</span> <span class="n">compare</span> <span class="c">! The result of the comparison.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>

  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">compare</span> <span class="o">=</span> <span class="p">(</span><span class="n">normL2</span><span class="p">(</span><span class="n">self</span><span class="p">)</span><span class="o">&gt;</span><span class="kt">real</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">R8P</span><span class="p">))</span>
  <span class="k">return</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">endfunction</span> <span class="n">self_great_R16P</span>

  <span class="k">elemental function </span><span class="n">R8P_great_self</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">self</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">compare</span><span class="p">)</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="c">!&lt; Return .true. if the normL2 of the self1 is &gt; with respect the  value of scalar scal, .false. otherwise.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="kt">real</span><span class="p">(</span><span class="n">R8P</span><span class="p">),</span>     <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">scal</span>    <span class="c">! Scalar.</span>
  <span class="k">class</span><span class="p">(</span><span class="n">Vector</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">self</span>    <span class="c">! Vector.</span>
  <span class="kt">logical</span>                   <span class="kd">::</span> <span class="n">compare</span> <span class="c">! The result of the comparison.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>

  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">compare</span> <span class="o">=</span> <span class="p">(</span><span class="kt">real</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">R8P</span><span class="p">)</span><span class="o">&gt;</span><span class="n">normL2</span><span class="p">(</span><span class="n">self</span><span class="p">))</span>
  <span class="k">return</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">endfunction</span> <span class="n">R8P_great_self</span>

  <span class="k">elemental function </span><span class="n">self_great_R8P</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">scal</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">compare</span><span class="p">)</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="c">!&lt; Return .true. if the normL2 of the self1 is &gt; with respect the  value of scalar scal, .false. otherwise.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="k">class</span><span class="p">(</span><span class="n">Vector</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">self</span>    <span class="c">! Vector.</span>
  <span class="kt">real</span><span class="p">(</span><span class="n">R8P</span><span class="p">),</span>     <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">scal</span>    <span class="c">! Scalar.</span>
  <span class="kt">logical</span>                   <span class="kd">::</span> <span class="n">compare</span> <span class="c">! The result of the comparison.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>

  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">compare</span> <span class="o">=</span> <span class="p">(</span><span class="n">normL2</span><span class="p">(</span><span class="n">self</span><span class="p">)</span><span class="o">&gt;</span><span class="kt">real</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">R8P</span><span class="p">))</span>
  <span class="k">return</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">endfunction</span> <span class="n">self_great_R8P</span>

  <span class="k">elemental function </span><span class="n">R4P_great_self</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">self</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">compare</span><span class="p">)</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="c">!&lt; Return .true. if the normL2 of the self1 is &gt; with respect the  value of scalar scal, .false. otherwise.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="kt">real</span><span class="p">(</span><span class="n">R4P</span><span class="p">),</span>     <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">scal</span>    <span class="c">! Scalar.</span>
  <span class="k">class</span><span class="p">(</span><span class="n">Vector</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">self</span>    <span class="c">! Vector.</span>
  <span class="kt">logical</span>                   <span class="kd">::</span> <span class="n">compare</span> <span class="c">! The result of the comparison.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>

  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">compare</span> <span class="o">=</span> <span class="p">(</span><span class="kt">real</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">R8P</span><span class="p">)</span><span class="o">&gt;</span><span class="n">normL2</span><span class="p">(</span><span class="n">self</span><span class="p">))</span>
  <span class="k">return</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">endfunction</span> <span class="n">R4P_great_self</span>

  <span class="k">elemental function </span><span class="n">self_great_R4P</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">scal</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">compare</span><span class="p">)</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="c">!&lt; Return .true. if the normL2 of the self1 is &gt; with respect the  value of scalar scal, .false. otherwise.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="k">class</span><span class="p">(</span><span class="n">Vector</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">self</span>    <span class="c">! Vector.</span>
  <span class="kt">real</span><span class="p">(</span><span class="n">R4P</span><span class="p">),</span>     <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">scal</span>    <span class="c">! Scalar.</span>
  <span class="kt">logical</span>                   <span class="kd">::</span> <span class="n">compare</span> <span class="c">! The result of the comparison.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>

  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">compare</span> <span class="o">=</span> <span class="p">(</span><span class="n">normL2</span><span class="p">(</span><span class="n">self</span><span class="p">)</span><span class="o">&gt;</span><span class="kt">real</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">R8P</span><span class="p">))</span>
  <span class="k">return</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">endfunction</span> <span class="n">self_great_R4P</span>

  <span class="k">elemental function </span><span class="n">I8P_great_self</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">self</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">compare</span><span class="p">)</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="c">!&lt; Return .true. if the normL2 of the self1 is &gt; with respect the  value of scalar scal, .false. otherwise.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="kt">integer</span><span class="p">(</span><span class="n">I8P</span><span class="p">),</span>  <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">scal</span>    <span class="c">! Scalar.</span>
  <span class="k">class</span><span class="p">(</span><span class="n">Vector</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">self</span>    <span class="c">! Vector.</span>
  <span class="kt">logical</span>                   <span class="kd">::</span> <span class="n">compare</span> <span class="c">! The result of the comparison.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>

  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">compare</span> <span class="o">=</span> <span class="p">(</span><span class="kt">real</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">R8P</span><span class="p">)</span><span class="o">&gt;</span><span class="n">normL2</span><span class="p">(</span><span class="n">self</span><span class="p">))</span>
  <span class="k">return</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">endfunction</span> <span class="n">I8P_great_self</span>

  <span class="k">elemental function </span><span class="n">self_great_I8P</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">scal</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">compare</span><span class="p">)</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="c">!&lt; Return .true. if the normL2 of the self1 is &gt; with respect the  value of scalar scal, .false. otherwise.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="k">class</span><span class="p">(</span><span class="n">Vector</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">self</span>    <span class="c">! Vector.</span>
  <span class="kt">integer</span><span class="p">(</span><span class="n">I8P</span><span class="p">),</span>  <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">scal</span>    <span class="c">! Scalar.</span>
  <span class="kt">logical</span>                   <span class="kd">::</span> <span class="n">compare</span> <span class="c">! The result of the comparison.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>

  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">compare</span> <span class="o">=</span> <span class="p">(</span><span class="n">normL2</span><span class="p">(</span><span class="n">self</span><span class="p">)</span><span class="o">&gt;</span><span class="kt">real</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">R8P</span><span class="p">))</span>
  <span class="k">return</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">endfunction</span> <span class="n">self_great_I8P</span>

  <span class="k">elemental function </span><span class="n">I4P_great_self</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">self</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">compare</span><span class="p">)</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="c">!&lt; Return .true. if the normL2 of the self1 is &gt; with respect the  value of scalar scal, .false. otherwise.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="kt">integer</span><span class="p">(</span><span class="n">I4P</span><span class="p">),</span>  <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">scal</span>    <span class="c">! Scalar.</span>
  <span class="k">class</span><span class="p">(</span><span class="n">Vector</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">self</span>    <span class="c">! Vector.</span>
  <span class="kt">logical</span>                   <span class="kd">::</span> <span class="n">compare</span> <span class="c">! The result of the comparison.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>

  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">compare</span> <span class="o">=</span> <span class="p">(</span><span class="kt">real</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">R8P</span><span class="p">)</span><span class="o">&gt;</span><span class="n">normL2</span><span class="p">(</span><span class="n">self</span><span class="p">))</span>
  <span class="k">return</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">endfunction</span> <span class="n">I4P_great_self</span>

  <span class="k">elemental function </span><span class="n">self_great_I4P</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">scal</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">compare</span><span class="p">)</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="c">!&lt; Return .true. if the normL2 of the self1 is &gt; with respect the  value of scalar scal, .false. otherwise.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="k">class</span><span class="p">(</span><span class="n">Vector</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">self</span>    <span class="c">! Vector.</span>
  <span class="kt">integer</span><span class="p">(</span><span class="n">I4P</span><span class="p">),</span>  <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">scal</span>    <span class="c">! Scalar.</span>
  <span class="kt">logical</span>                   <span class="kd">::</span> <span class="n">compare</span> <span class="c">! The result of the comparison.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>

  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">compare</span> <span class="o">=</span> <span class="p">(</span><span class="n">normL2</span><span class="p">(</span><span class="n">self</span><span class="p">)</span><span class="o">&gt;</span><span class="kt">real</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">R8P</span><span class="p">))</span>
  <span class="k">return</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">endfunction</span> <span class="n">self_great_I4P</span>

  <span class="k">elemental function </span><span class="n">I2P_great_self</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">self</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">compare</span><span class="p">)</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="c">!&lt; Return .true. if the normL2 of the self1 is &gt; with respect the  value of scalar scal, .false. otherwise.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="kt">integer</span><span class="p">(</span><span class="n">I2P</span><span class="p">),</span>  <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">scal</span>    <span class="c">! Scalar.</span>
  <span class="k">class</span><span class="p">(</span><span class="n">Vector</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">self</span>    <span class="c">! Vector.</span>
  <span class="kt">logical</span>                   <span class="kd">::</span> <span class="n">compare</span> <span class="c">! The result of the comparison.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>

  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">compare</span> <span class="o">=</span> <span class="p">(</span><span class="kt">real</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">R8P</span><span class="p">)</span><span class="o">&gt;</span><span class="n">normL2</span><span class="p">(</span><span class="n">self</span><span class="p">))</span>
  <span class="k">return</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">endfunction</span> <span class="n">I2P_great_self</span>

  <span class="k">elemental function </span><span class="n">self_great_I2P</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">scal</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">compare</span><span class="p">)</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="c">!&lt; Return .true. if the normL2 of the self1 is &gt; with respect the  value of scalar scal, .false. otherwise.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="k">class</span><span class="p">(</span><span class="n">Vector</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">self</span>    <span class="c">! Vector.</span>
  <span class="kt">integer</span><span class="p">(</span><span class="n">I2P</span><span class="p">),</span>  <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">scal</span>    <span class="c">! Scalar.</span>
  <span class="kt">logical</span>                   <span class="kd">::</span> <span class="n">compare</span> <span class="c">! The result of the comparison.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>

  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">compare</span> <span class="o">=</span> <span class="p">(</span><span class="n">normL2</span><span class="p">(</span><span class="n">self</span><span class="p">)</span><span class="o">&gt;</span><span class="kt">real</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">R8P</span><span class="p">))</span>
  <span class="k">return</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">endfunction</span> <span class="n">self_great_I2P</span>

  <span class="k">elemental function </span><span class="n">I1P_great_self</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">self</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">compare</span><span class="p">)</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="c">!&lt; Return .true. if the normL2 of the self1 is &gt; with respect the  value of scalar scal, .false. otherwise.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="kt">integer</span><span class="p">(</span><span class="n">I1P</span><span class="p">),</span>  <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">scal</span>    <span class="c">! Scalar.</span>
  <span class="k">class</span><span class="p">(</span><span class="n">Vector</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">self</span>    <span class="c">! Vector.</span>
  <span class="kt">logical</span>                   <span class="kd">::</span> <span class="n">compare</span> <span class="c">! The result of the comparison.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>

  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">compare</span> <span class="o">=</span> <span class="p">(</span><span class="kt">real</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">R8P</span><span class="p">)</span><span class="o">&gt;</span><span class="n">normL2</span><span class="p">(</span><span class="n">self</span><span class="p">))</span>
  <span class="k">return</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">endfunction</span> <span class="n">I1P_great_self</span>

  <span class="k">elemental function </span><span class="n">self_great_I1P</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">scal</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">compare</span><span class="p">)</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="c">!&lt; Return .true. if the normL2 of the self1 is &gt; with respect the  value of scalar scal, .false. otherwise.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="k">class</span><span class="p">(</span><span class="n">Vector</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">self</span>    <span class="c">! Vector.</span>
  <span class="kt">integer</span><span class="p">(</span><span class="n">I1P</span><span class="p">),</span>  <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">scal</span>    <span class="c">! Scalar.</span>
  <span class="kt">logical</span>                   <span class="kd">::</span> <span class="n">compare</span> <span class="c">! The result of the comparison.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>

  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">compare</span> <span class="o">=</span> <span class="p">(</span><span class="n">normL2</span><span class="p">(</span><span class="n">self</span><span class="p">)</span><span class="o">&gt;</span><span class="kt">real</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span> <span class="n">R8P</span><span class="p">))</span>
  <span class="k">return</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">endfunction</span> <span class="n">self_great_I1P</span>
<span class="n">endmodule</span> <span class="n">VecFor</span>
</pre></div>

    </section>
    </div>
  </div>

    <hr>
    <footer>
        <div class="row">
        <div class="col-md-6">&copy; 2015 VecFor was written by Stefano Zaghi. </div>
        <div class="col-md-6"><span class="pull-right">Documentation generated by <a href="https://github.com/cmacmackin/ford">FORD</a>.</span></div>
        </div>
        <br>
    </footer>
    </div> <!-- /container -->


    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
<!--
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
-->
    <script src="../js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../js/ie10-viewport-bug-workaround.js"></script>

    <!-- MathJax JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
        jax: ['input/TeX','input/MathML','output/HTML-CSS'],
        extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js'],
        'HTML-CSS': { 
           styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: '#000000 ! important'} }
        }
      });
    </script>
    <script src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
  </body>
</html>